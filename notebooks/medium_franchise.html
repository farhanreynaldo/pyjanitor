
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; pyjanitor  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="&lt;no title&gt;" href="normalize.html" />
    <link rel="prev" title="&lt;no title&gt;" href="inflating_converting_currency.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“# Tidy Up Web-Scraped Media Franchise Datan”,
“n”,
“## Backgroundn”,
“This example combines functionalities of [pyjanitor](<a class="reference external" href="https://anaconda.org/conda-forge/pyjanitor">https://anaconda.org/conda-forge/pyjanitor</a>) and [pandas-flavor](<a class="reference external" href="https://anaconda.org/conda-forge/pandas-flavor">https://anaconda.org/conda-forge/pandas-flavor</a>) to showcase an explicit–and thus reproducible–workflow enabled by dataframe __method <a href="#id1"><span class="problematic" id="id2">chaining__</span></a>.n”,
“n”,
“The data cleaning workflow largely follows the [R example](<a class="reference external" href="https://github.com/rfordatascience/tidytuesday/blob/master/data/2019/2019-07-02/revenue.R">https://github.com/rfordatascience/tidytuesday/blob/master/data/2019/2019-07-02/revenue.R</a>) from [the tidytuesday project](<a class="reference external" href="https://github.com/rfordatascience/tidytuesday">https://github.com/rfordatascience/tidytuesday</a>). The raw data is scraped from [Wikipedia page](<a class="reference external" href="https://en.wikipedia.org/wiki/List_of_highest-grossing_media_franchises">https://en.wikipedia.org/wiki/List_of_highest-grossing_media_franchises</a>) titled &quot;<em>List of highest-grossing media franchises</em>&quot;. The workflow is presented both in multi-step (section1) and in one-shot (section 2) fashions.n”,
“n”,
“More specifically, you will find several data-cleaning techniques that one may encounter frequently in web-scraping tasks; This includes:n”,
“n”,
“* String operations with regular expressions (with <cite>pandas-favor</cite>)n”,
“* Data type changes (with <cite>pyjanitor</cite>)n”,
“* Split strings in cells into seperate rows (with <cite>pandas-flavor</cite>)n”,
“* Split strings in cells into separate columns (with <cite>pyjanitor</cite> + <cite>pandas-flavor</cite>)n”,
“* Filter dataframe values based on substring pattern (with <cite>pyjanitor</cite>)n”,
“* Column value remapping with fuzzy substring matching (with <cite>pyjanitor</cite> + <cite>pandas-flavor</cite>)n”,
“n”,
“Data visualization is not included in this example. But if you are looking for inspirations, [here](<a class="reference external" href="https://www.reddit.com/r/dataisbeautiful/comments/c53540/highest_grossing_media_franchises_oc/">https://www.reddit.com/r/dataisbeautiful/comments/c53540/highest_grossing_media_franchises_oc/</a>) is a good example. n”,
“n”,
“—n”,
“n”,
“## Structural conventionn”,
“### 1. Annotation system in code commentsn”,
“This example includes both <cite>pyjanitor</cite> and <cite>pandas-flavors</cite> methods. As you step through this example, you will see the following annotation system in code comments that explains various methods’ categories:n”,
“n”,
“* <cite>[pyjanitor]</cite> denotes <cite>pyjanitor</cite> methodsn”,
“* <cite>[pandas-flavor]</cite> denotes custom <cite>pandas-flavor</cite> methodsn”,
“* <cite>[pyjanitor + pandas-flavor]</cite> denotes <cite>pandas-flavor</cite> methods built on top of <cite>pyjanitor</cite> functionsn”,
“n”,
“### 2. R counterpart snippets and python code in tandemn”,
“The multi-step workflow is presented by alternating the original R snippets (from tidytuesday) and the corresponding python implementations.”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“—n”,
“n”,
“## Python implementationn”,
“n”,
“### Preparation”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 1,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# Import pyjanitor and pandasn”,
“import janitorn”,
“import pandas as pdn”,
“import pandas_flavor as pfn”,
“from typing import List”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 2,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# Supress user warnings when we try overwriting our custom pandas flavor functionsn”,
“import warningsn”,
“warnings.filterwarnings(‘ignore’)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“—n”,
“n”,
“### Section 1 Multi-Stepn”,
“#### Load datan”,
“n”,
“##### Note: The table from the url has been saved as a csv file for use in this example notebook.n”,
“n”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;url</span> <span class="pre">&lt;-</span> <span class="pre">\&quot;https://en.wikipedia.org/wiki/List_of_highest-grossing_media_franchises\&quot;\n&quot;,</span>
<span class="pre">&quot;df</span> <span class="pre">&lt;-</span> <span class="pre">url</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">read_html()</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">html_table(fill</span> <span class="pre">=</span> <span class="pre">TRUE)</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">.[[2]]\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 3,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Franchise&lt;/th&gt;n”,
”      &lt;th&gt;Year of inception&lt;/th&gt;n”,
”      &lt;th&gt;Total revenue (USD)&lt;/th&gt;n”,
”      &lt;th&gt;Revenue breakdown (est.)&lt;/th&gt;n”,
”      &lt;th&gt;Original media&lt;/th&gt;n”,
”      &lt;th&gt;Creator(s)&lt;/th&gt;n”,
”      &lt;th&gt;Owner(s)&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;$19.9 billion[da]&lt;/td&gt;n”,
”      &lt;td&gt;Book sales – $9.125 billion[245] Box office – …&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;James Bond&lt;/td&gt;n”,
”      &lt;td&gt;1953&lt;/td&gt;n”,
”      &lt;td&gt;est. $19.9 billion[db]&lt;/td&gt;n”,
”      &lt;td&gt;Box office – $7.078 billion[249] Home video sa…&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;Ian Fleming&lt;/td&gt;n”,
”      &lt;td&gt;Metro-Goldwyn-Mayer&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Peanuts&lt;/td&gt;n”,
”      &lt;td&gt;1950&lt;/td&gt;n”,
”      &lt;td&gt;est. $19.1 billion&lt;/td&gt;n”,
”      &lt;td&gt;Retail sales – $18.805 billion[dc] Box office …&lt;/td&gt;n”,
”      &lt;td&gt;Comic strip&lt;/td&gt;n”,
”      &lt;td&gt;Charles M. Schulz&lt;/td&gt;n”,
”      &lt;td&gt;Sony Music Entertainment Japan (Sony) WildBrai…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              Franchise  Year of inception  \n”,
“0  Middle-earth (The Lord of the Rings)               1937   n”,
“1                            James Bond               1953   n”,
“2                               Peanuts               1950   n”,
“n”,
”      Total revenue (USD)                           Revenue breakdown (est.)  \n”,
“0       $19.9 billion[da]  Book sales – $9.125 billion[245] Box office – …   n”,
“1  est. $19.9 billion[db]  Box office – $7.078 billion[249] Home video sa…   n”,
“2      est. $19.1 billion  Retail sales – $18.805 billion[dc] Box office …   n”,
“n”,
”  Original media         Creator(s)  \n”,
“0          Novel   J. R. R. Tolkien   n”,
“1          Novel        Ian Fleming   n”,
“2    Comic strip  Charles M. Schulz   n”,
“n”,
”                                            Owner(s)  n”,
“0  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“1                                Metro-Goldwyn-Mayer  n”,
“2  Sony Music Entertainment Japan (Sony) WildBrai…  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 3,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“fileurl = ‘../data/medium_franchise_raw_table.csv’ # originally from <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_highest-grossing_media_franchisesn">https://en.wikipedia.org/wiki/List_of_highest-grossing_media_franchisesn</a>”,
“df_raw = pd.read_csv(fileurl)n”,
“df_raw.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### Rename columnsn”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;clean_money</span> <span class="pre">&lt;-</span> <span class="pre">df</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">set_names(nm</span> <span class="pre">=</span> <span class="pre">c(\&quot;franchise\&quot;,</span> <span class="pre">\&quot;year_created\&quot;,</span> <span class="pre">\&quot;total_revenue\&quot;,</span> <span class="pre">\&quot;revenue_items\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">\&quot;original_media\&quot;,</span> <span class="pre">\&quot;creators\&quot;,</span> <span class="pre">\&quot;owners\&quot;))\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 4,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# pandas-flavor helper functionsn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def str_remove(df, column_name: str, pattern: str = ‘’):n”,
”    &quot;&quot;&quot;Remove string patten from a columnn”,
“n”,
”    Wrapper around df.str.replace()n”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
”    pattern: str, default to ‘’n”,
”        String pattern to be removedn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    df[column_name] = df[column_name].str.replace(pattern, ‘’)n”,
”    return dfn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def str_trim(df, column_name: str):n”,
”    &quot;&quot;&quot;Remove leading and trailing white space from a column of stringsn”,
“n”,
”    Wrapper around df.str.strip()n”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    df[column_name] = df[column_name].str.strip()n”,
”    return dfn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def str_slice(n”,
”    df, column_name: str, start: int = 0, stop: int = -1n”,
“):n”,
”    &quot;&quot;&quot;Slice a column of strings by indexesn”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
”    start: int, optional, default to 0n”,
”        Staring index for string slicingn”,
”    stop: int, optional, default to -1n”,
”        Ending index for string slicingn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    df[column_name] = df[column_name].str[start:stop]n”,
”    return df”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 5,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue_items&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”      &lt;th&gt;owners&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;$19.9 billion[da]&lt;/td&gt;n”,
”      &lt;td&gt;Book sales – $9.125 billion[245] Box office – …&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;James Bond&lt;/td&gt;n”,
”      &lt;td&gt;1953&lt;/td&gt;n”,
”      &lt;td&gt;est. $19.9 billion[db]&lt;/td&gt;n”,
”      &lt;td&gt;Box office – $7.078 billion[249] Home video sa…&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;Ian Fleming&lt;/td&gt;n”,
”      &lt;td&gt;Metro-Goldwyn-Mayer&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Peanuts&lt;/td&gt;n”,
”      &lt;td&gt;1950&lt;/td&gt;n”,
”      &lt;td&gt;est. $19.1 billion&lt;/td&gt;n”,
”      &lt;td&gt;Retail sales – $18.805 billion[dc] Box office …&lt;/td&gt;n”,
”      &lt;td&gt;Comic strip&lt;/td&gt;n”,
”      &lt;td&gt;Charles M. Schulz&lt;/td&gt;n”,
”      &lt;td&gt;Sony Music Entertainment Japan (Sony) WildBrai…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              franchise  year_created           total_revenue  \n”,
“0  Middle-earth (The Lord of the Rings)          1937       $19.9 billion[da]   n”,
“1                            James Bond          1953  est. $19.9 billion[db]   n”,
“2                               Peanuts          1950      est. $19.1 billion   n”,
“n”,
”                                       revenue_items original_media  \n”,
“0  Book sales – $9.125 billion[245] Box office – …          Novel   n”,
“1  Box office – $7.078 billion[249] Home video sa…          Novel   n”,
“2  Retail sales – $18.805 billion[dc] Box office …    Comic strip   n”,
“n”,
”            creators                                             owners  n”,
“0   J. R. R. Tolkien  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“1        Ian Fleming                                Metro-Goldwyn-Mayer  n”,
“2  Charles M. Schulz  Sony Music Entertainment Japan (Sony) WildBrai…  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 5,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“colnames = (n”,
”    ‘franchise’,n”,
”    ‘year_created’,n”,
”    ‘total_revenue’,n”,
”    ‘revenue_items’,n”,
”    ‘original_media’,n”,
”    ‘creators’,n”,
”    ‘owners’n”,
“)n”,
“df_dirty = df_raw.rename(n”,
”    columns={col_old: col_new for col_old, col_new in zip(df_raw.columns, colnames)}n”,
“)n”,
“df_dirty.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### Clean up <cite>total_revenue</cite> columnn”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;clean_money</span> <span class="pre">&lt;-</span> <span class="pre">df</span> <span class="pre">%&gt;%</span> <span class="pre">...</span> <span class="pre">%&gt;%\n&quot;,</span>
<span class="pre">&quot;mutate(total_revenue</span> <span class="pre">=</span> <span class="pre">str_remove(total_revenue,</span> <span class="pre">\&quot;est.\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">total_revenue</span> <span class="pre">=</span> <span class="pre">str_trim(total_revenue),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">total_revenue</span> <span class="pre">=</span> <span class="pre">str_remove(total_revenue,</span> <span class="pre">\&quot;[$]\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">total_revenue</span> <span class="pre">=</span> <span class="pre">word(total_revenue,</span> <span class="pre">1,</span> <span class="pre">1),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">total_revenue</span> <span class="pre">=</span> <span class="pre">as.double(total_revenue))\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 6,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue_items&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”      &lt;th&gt;owners&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Book sales – $9.125 billion[245] Box office – …&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;James Bond&lt;/td&gt;n”,
”      &lt;td&gt;1953&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Box office – $7.078 billion[249] Home video sa…&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;Ian Fleming&lt;/td&gt;n”,
”      &lt;td&gt;Metro-Goldwyn-Mayer&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Peanuts&lt;/td&gt;n”,
”      &lt;td&gt;1950&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Retail sales – $18.805 billion[dc] Box office …&lt;/td&gt;n”,
”      &lt;td&gt;Comic strip&lt;/td&gt;n”,
”      &lt;td&gt;Charles M. Schulz&lt;/td&gt;n”,
”      &lt;td&gt;Sony Music Entertainment Japan (Sony) WildBrai…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              franchise  year_created  total_revenue  \n”,
“0  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“1                            James Bond          1953           19.0   n”,
“2                               Peanuts          1950           19.0   n”,
“n”,
”                                       revenue_items original_media  \n”,
“0  Book sales – $9.125 billion[245] Box office – …          Novel   n”,
“1  Box office – $7.078 billion[249] Home video sa…          Novel   n”,
“2  Retail sales – $18.805 billion[dc] Box office …    Comic strip   n”,
“n”,
”            creators                                             owners  n”,
“0   J. R. R. Tolkien  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“1        Ian Fleming                                Metro-Goldwyn-Mayer  n”,
“2  Charles M. Schulz  Sony Music Entertainment Japan (Sony) WildBrai…  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 6,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“column_name = ‘total_revenue’n”,
“df_clean_money = (n”,
”    df_dirty.str_remove(column_name, pattern=’est.’)  # [pandas-flavor]n”,
”    .str_trim(column_name)  # [pandas-flavor]n”,
”    .str_remove(column_name, pattern=’\$’)   # [pandas-flavor]n”,
”    .str_slice(column_name, start=0, stop=2)  # [pandas-flavor]n”,
”    .change_type(column_name, float)  # [pyjanitor]n”,
“)n”,
“df_clean_money.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### Split column <cite>revenue_items</cite> into <cite>revenue_category</cite> and <cite>revenue</cite>n”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;clean_category</span> <span class="pre">&lt;-</span> <span class="pre">clean_money</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">separate_rows(revenue_items,</span> <span class="pre">sep</span> <span class="pre">=</span> <span class="pre">\&quot;\\\\[\&quot;)</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">filter(str_detect(revenue_items,</span> <span class="pre">\&quot;illion\&quot;))</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">separate(revenue_items,</span> <span class="pre">into</span> <span class="pre">=</span> <span class="pre">c(\&quot;revenue_category\&quot;,</span> <span class="pre">\&quot;revenue\&quot;),</span> <span class="pre">sep</span> <span class="pre">=</span> <span class="pre">\&quot;[$]\&quot;)</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">mutate(revenue_category</span> <span class="pre">=</span> <span class="pre">str_remove(revenue_category,</span> <span class="pre">\&quot;</span> <span class="pre">–</span> <span class="pre">\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">revenue_category</span> <span class="pre">=</span> <span class="pre">str_remove(revenue_category,</span> <span class="pre">regex(\&quot;.*\\\\]\&quot;)),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">revenue_category</span> <span class="pre">=</span> <span class="pre">str_remove(revenue_category,</span> <span class="pre">\&quot;\\n\&quot;))</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 7,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# pandas-flavor helper functionsn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def separate_rows(df, column_name: str, sep: str = ‘’):n”,
”    &quot;&quot;&quot;Split each cell of a column that contains a list of itemsn”,
”    (separated by <cite>sep</cite>) into separate rowsn”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
”    sep: str, default to ‘’n”,
”        Substring used as separators for cell splittingn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    # Preserve an id field for later mergen”,
”    columns_original = list(df.columns)n”,
”    df[‘id’] = df.indexn”,
”    wdf = (n”,
”        pd.DataFrame(n”,
”            df[column_name].str.split(sep).tolist()n”,
”        ).stack().reset_index()n”,
”    )n”,
”    # Preserve the same id field for mergen”,
”    wdf.rename(columns={‘level_0’: ‘id’, 0: ‘revenue_items’}, inplace=True)n”,
”    wdf.drop(columns=[‘level_1’], inplace=True)n”,
”    # Merge and preserve original ordern”,
”    return pd.merge(df, wdf, on=&quot;id&quot;, suffixes=(&quot;_drop&quot;, &quot;&quot;)).drop(n”,
”        columns=[&quot;id&quot;, column_name + &quot;_drop&quot;]n”,
”    )[columns_original]n”,
“n”,
“n”,
“# [pyjanitor + pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def separate(df, column_name: str, into: List[str] = None, sep: str = ‘’):n”,
”    &quot;&quot;&quot;Split a column into separate columns at separator specified by <cite>sep</cite>n”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
”    into: List[str], default to Nonen”,
”        New column names for the splitted columnsn”,
”    sep: str, default to ‘’n”,
”        Separator at which to split the columnn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    index_original = list(df.columns).index(column_name)n”,
”    cols = list(df.columns)n”,
”    cols.remove(column_name)n”,
”    for i, col in enumerate(into):n”,
”        cols.insert(index_original + i, col)n”,
”    return (n”,
”        df.deconcatenate_column(column_name, new_column_names=into, sep=sep)n”,
”        .drop(columns=column_name)[cols]n”,
”    )”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 8,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue_category&lt;/th&gt;n”,
”      &lt;th&gt;revenue&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”      &lt;th&gt;owners&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Book sales&lt;/td&gt;n”,
”      &lt;td&gt;9.125 billion&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Box office&lt;/td&gt;n”,
”      &lt;td&gt;5.896 billion&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Home video sales&lt;/td&gt;n”,
”      &lt;td&gt;4.194 billion&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              franchise  year_created  total_revenue  \n”,
“0  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“1  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“2  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“n”,
”    revenue_category        revenue original_media          creators  \n”,
“0         Book sales  9.125 billion          Novel  J. R. R. Tolkien   n”,
“1         Box office  5.896 billion          Novel  J. R. R. Tolkien   n”,
“2   Home video sales  4.194 billion          Novel  J. R. R. Tolkien   n”,
“n”,
”                                              owners  n”,
“0  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“1  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“2  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 8,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“# Generate <cite>df_clean_category</cite> on top of <cite>df_clean_money</cite>n”,
“column_name = ‘revenue_items’n”,
“df_clean_category = (n”,
”    df_clean_money.separate_rows(column_name, sep=’\[’)  # [pandas-flavor]n”,
”    .filter_string(column_name, ‘illion’)  # [pyjanitor]n”,
”    .separate(n”,
”        column_name, into=[‘revenue_category’, ‘revenue’], sep=’\$’n”,
”    )  # [pyjanitor + pandas-flavor]n”,
”    .str_remove(‘revenue_category’, pattern=’ – ‘)  # [pandas-flavor]n”,
”    .str_remove(‘revenue_category’, pattern=’.*\]’)  # [pandas-flavor]n”,
”    .str_remove(‘revenue_category’, pattern=’\n’)  # [pandas-flavor]n”,
“)n”,
“df_clean_category.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### Clean up <cite>revenue_category</cite> columnn”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;clean_df</span> <span class="pre">&lt;-</span> <span class="pre">clean_category</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">mutate(revenue_category</span> <span class="pre">=</span> <span class="pre">case_when(\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;box</span> <span class="pre">office\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;Box</span> <span class="pre">Office\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;dvd|blu|vhs|home</span> <span class="pre">video|video</span> <span class="pre">rentals|video</span> <span class="pre">sales|streaming|home</span> <span class="pre">entertainment\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;Home</span> <span class="pre">Video/Entertainment\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;video</span> <span class="pre">game|computer</span> <span class="pre">game|mobile</span> <span class="pre">game|console|game|pachinko|pet|card\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;Video</span> <span class="pre">Games/Games\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;comic|manga\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;Comic</span> <span class="pre">or</span> <span class="pre">Manga\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;music|soundtrack\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;Music\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;tv\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;TV\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">str_detect(str_to_lower(revenue_category),</span> <span class="pre">\&quot;merchandise|licens|mall|stage|retail\&quot;)</span> <span class="pre">~</span> <span class="pre">\&quot;Merchandise,</span> <span class="pre">Licensing</span> <span class="pre">&amp;</span> <span class="pre">Retail\&quot;,\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160; <span class="pre">TRUE</span> <span class="pre">~</span> <span class="pre">revenue_category))\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 9,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# pandas-flavor helper functionsn”,
“n”,
“n”,
“# [pyjanitor + pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def fuzzy_match_replace(df, column_name: str, mapper: dict = None):n”,
”    &quot;&quot;&quot;Value remapping for specific column with fuzzy matching and replacementn”,
”    of stringsn”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
”    mapper: dict, default to Nonen”,
”        {oldstr_0: newstr_0, oldstr_1: newstr_1, …, oldstr_n: newstr_n}n”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    for k, v in mapper.items():n”,
”        condition = df[column_name].str.contains(k)n”,
”        # [pyjanitor] update_where: update value when condition is Truen”,
”        df = df.update_where(condition, column_name, v)n”,
”    return df”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 10,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue_category&lt;/th&gt;n”,
”      &lt;th&gt;revenue&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”      &lt;th&gt;owners&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;book sales&lt;/td&gt;n”,
”      &lt;td&gt;9.125 billion&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Box Office&lt;/td&gt;n”,
”      &lt;td&gt;5.896 billion&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Home Video/Entertainment&lt;/td&gt;n”,
”      &lt;td&gt;4.194 billion&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              franchise  year_created  total_revenue  \n”,
“0  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“1  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“2  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“n”,
”           revenue_category        revenue original_media          creators  \n”,
“0                book sales  9.125 billion          Novel  J. R. R. Tolkien   n”,
“1                Box Office  5.896 billion          Novel  J. R. R. Tolkien   n”,
“2  Home Video/Entertainment  4.194 billion          Novel  J. R. R. Tolkien   n”,
“n”,
”                                              owners  n”,
“0  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“1  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“2  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 10,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“# Value mapper <cite>revenue_category</cite>n”,
“value_mapper = {n”,
”    ‘box office’: ‘Box Office’,n”,
”    ‘dvd|blu|vhs|home video|video rentals|video sales|streaming|home entertainment’: ‘Home Video/Entertainment’,n”,
”    ‘video game|computer game|mobile game|console|game|pachinko|pet|card’: ‘Video Games/Games’,n”,
”    ‘comic|manga’: ‘Comic or Manga’,n”,
”    ‘music|soundtrac’: ‘Music’,n”,
”    ‘tv’: ‘TV’,n”,
”    ‘merchandise|licens|mall|stage|retail’: ‘Merchandise, Licensing &amp; Retail’,n”,
“}n”,
“n”,
“column_name = ‘revenue_category’n”,
“df_clean_category = (n”,
”    df_clean_category.transform_column(column_name, str.lower)  # [pyjanitor] convert to lower casen”,
”    .transform_column(column_name, str.strip)  # [pyjanitor] strip leading/trailing white spacen”,
”    .fuzzy_match_replace(column_name, mapper=value_mapper)  # [pyjanitor + pandas_flavor]n”,
“)n”,
“df_clean_category.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“#### Clean up <cite>revenue</cite> columnn”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;mutate(revenue</span> <span class="pre">=</span> <span class="pre">str_remove(revenue,</span> <span class="pre">\&quot;illion\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">revenue</span> <span class="pre">=</span> <span class="pre">str_trim(revenue),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">revenue</span> <span class="pre">=</span> <span class="pre">str_remove(revenue,</span> <span class="pre">\&quot;</span> <span class="pre">\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">revenue</span> <span class="pre">=</span> <span class="pre">case_when(str_detect(revenue,</span> <span class="pre">\&quot;m\&quot;)</span> <span class="pre">~</span> <span class="pre">paste0(str_extract(revenue,</span> <span class="pre">\&quot;[:digit:]+\&quot;),</span> <span class="pre">\&quot;e-3\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">str_detect(revenue,</span> <span class="pre">\&quot;b\&quot;)</span> <span class="pre">~</span> <span class="pre">str_extract(revenue,</span> <span class="pre">\&quot;[:digit:]+\&quot;),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">TRUE</span> <span class="pre">~</span> <span class="pre">NA_character_),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">revenue</span> <span class="pre">=</span> <span class="pre">format(revenue,</span> <span class="pre">scientific</span> <span class="pre">=</span> <span class="pre">FALSE),\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160; <span class="pre">revenue</span> <span class="pre">=</span> <span class="pre">parse_number(revenue))</span> <span class="pre">%&gt;%\n&quot;,</span>
<span class="pre">&quot;mutate(original_media</span> <span class="pre">=</span> <span class="pre">str_remove(original_media,</span> <span class="pre">\&quot;\\\\[.+\&quot;))\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 11,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“# pandas-flavor helper functionsn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def str_replace(df, column_name: str, old: str = ‘’, new: str = ‘’):n”,
”    &quot;&quot;&quot;Match and replace strings from a dataframe column.n”,
”    Wrapper around df.str.replacen”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
”    column_name: strn”,
”        Name of the column to be operated onn”,
”    old: str, default to ‘’n”,
”        Old string to be matched and replacedn”,
”    new: str, default to ‘’n”,
”        New string to replace oldn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    df[column_name] = df[column_name].str.replace(old, new)n”,
”    return dfn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def parse_number(df):n”,
”    &quot;&quot;&quot;Check all columns of dataframe and properly parse numeric typesn”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    for col in df.columns:n”,
”        try:n”,
”            df[col] = pd.to_numeric(df[col])n”,
”        except ValueError as e:n”,
”            continuen”,
”    return dfn”,
“n”,
“n”,
“# [pandas-flavor]n”,
“&#64;pf.register_dataframe_methodn”,
“def flatten_multiindex(df):n”,
”    &quot;&quot;&quot;Flatten dataframe with multilevel indexn”,
”    A wrapper around pd.DataFrame(df.to_records())n”,
“n”,
”    Parametersn”,
”    ———–n”,
”    df: pd.Dataframen”,
”        Input dataframe to be modifiedn”,
“n”,
”    Returnsn”,
”    ——–n”,
”    df: pd.Dataframen”,
“n”,
”    &quot;&quot;&quot;n”,
”    return pd.DataFrame(df.to_records())”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 12,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue_category&lt;/th&gt;n”,
”      &lt;th&gt;revenue&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”      &lt;th&gt;owners&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;book sales&lt;/td&gt;n”,
”      &lt;td&gt;9.125&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Box Office&lt;/td&gt;n”,
”      &lt;td&gt;5.896&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;1937&lt;/td&gt;n”,
”      &lt;td&gt;19.0&lt;/td&gt;n”,
”      &lt;td&gt;Home Video/Entertainment&lt;/td&gt;n”,
”      &lt;td&gt;4.194&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”      &lt;td&gt;Tolkien Estate (books) Warner Bros. (AT&amp;amp;T) (fi…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              franchise  year_created  total_revenue  \n”,
“0  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“1  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“2  Middle-earth (The Lord of the Rings)          1937           19.0   n”,
“n”,
”           revenue_category  revenue original_media          creators  \n”,
“0                book sales    9.125          Novel  J. R. R. Tolkien   n”,
“1                Box Office    5.896          Novel  J. R. R. Tolkien   n”,
“2  Home Video/Entertainment    4.194          Novel  J. R. R. Tolkien   n”,
“n”,
”                                              owners  n”,
“0  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“1  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  n”,
“2  Tolkien Estate (books) Warner Bros. (AT&amp;T) (fi…  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 12,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“# clean up revenue valuesn”,
“column_name = ‘revenue’n”,
“df_clean = (n”,
”    df_clean_category.str_remove(column_name, ‘illion’)  # [pandas-flavor]n”,
”    .str_trim(column_name)  # [pandas-flavor]n”,
”    .str_remove(column_name, ‘ ‘)  # [pandas-flavor]n”,
”    .str_replace(column_name, ‘\s*b’, ‘’)  # [pandas-flavor]n”,
”    .str_replace(column_name, ‘\s*m’, ‘e-3’)  # [pandas-flavor]n”,
”    .parse_number()  # [pandas-flavor]n”,
”    .str_remove(‘original_media’, ‘\[.+’)  # [pandas-flavor]n”,
“)n”,
“df_clean.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“—n”,
“n”,
“### Section 2 One-Shot”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 13,
“metadata”: {},
“outputs”: [],
“source”: [</p>
<blockquote>
<div><p>“df_clean = (n”,
”    pd.read_csv(fileurl)n”,
”    .rename(n”,
”        columns={col_old: col_new for col_old, col_new in zip(df_raw.columns, colnames)}n”,
”    )n”,
”    .str_remove(‘total_revenue’, pattern=’est.’)  # [pandas-flavor]n”,
”    .str_trim(‘total_revenue’)  # [pandas-flavor]n”,
”    .str_remove(‘total_revenue’, pattern=’\$’)   # [pandas-flavor]n”,
”    .str_slice(‘total_revenue’, start=0, stop=2)  # [pandas-flavor]n”,
”    .change_type(‘total_revenue’, float)  # [pyjanitor]n”,
”    .separate_rows(‘revenue_items’, sep=’\[’)  # [pandas-flavor]n”,
”    .filter_string(‘revenue_items’, ‘illion’)  # [pyjanitor]n”,
”    .separate(n”,
”        ‘revenue_items’, into=[‘revenue_category’, ‘revenue’], sep=’\$’n”,
”    )  # [pyjanitor + pandas-flavor]n”,
”    .str_remove(‘revenue_category’, pattern=’ – ‘)  # [pandas-flavor]n”,
”    .str_remove(‘revenue_category’, pattern=’.*\]’)  # [pandas-flavor]n”,
”    .str_remove(‘revenue_category’, pattern=’\n’)  # [pandas-flavor]n”,
”    .transform_column(‘revenue_category’, str.lower)  # [pyjanitor] convert to lower casen”,
”    .transform_column(‘revenue_category’, str.strip)  # [pyjanitor] strip leading/trailing white spacen”,
”    .fuzzy_match_replace(‘revenue_category’, mapper=value_mapper)  # [pyjanitor + pandas_flavor]n”,
”    .str_remove(‘revenue’, ‘illion’)  # [pandas-flavor]n”,
”    .str_trim(‘revenue’)  # [pandas-flavor]n”,
”    .str_remove(‘revenue’, ‘ ‘)  # [pandas-flavor]n”,
”    .str_replace(‘revenue’, ‘\s*b’, ‘’)  # [pandas-flavor]n”,
”    .str_replace(‘revenue’, ‘\s*m’, ‘e-3’)  # [pandas-flavor]n”,
”    .parse_number()  # [pandas-flavor]n”,
”    .str_remove(‘original_media’, ‘\[.+’)  # [pandas-flavor]n”,
“)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“—n”,
“n”,
“### Final aggregation and joinn”,
“R snippet:n”,
“<code class="docutils literal notranslate"><span class="pre">`R\n&quot;,</span>
<span class="pre">&quot;</span> <span class="pre">sum_df</span> <span class="pre">&lt;-</span> <span class="pre">clean_df</span> <span class="pre">%&gt;%\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">group_by(franchise,</span> <span class="pre">revenue_category)</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">summarize(revenue</span> <span class="pre">=</span> <span class="pre">sum(revenue))\n&quot;,</span>
<span class="pre">&quot;\n&quot;,</span>
<span class="pre">&quot;metadata_df</span> <span class="pre">&lt;-</span> <span class="pre">clean_df</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">select(franchise:revenue_category,</span> <span class="pre">original_media:owners,</span> <span class="pre">-total_revenue)\n&quot;,</span>
<span class="pre">&quot;\n&quot;,</span>
<span class="pre">&quot;final_df</span> <span class="pre">&lt;-</span> <span class="pre">left_join(sum_df,</span> <span class="pre">metadata_df,</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; <span class="pre">by</span> <span class="pre">=</span> <span class="pre">c(\&quot;franchise\&quot;,</span> <span class="pre">\&quot;revenue_category\&quot;))</span> <span class="pre">%&gt;%</span> <span class="pre">\n&quot;,</span>
<span class="pre">&quot;</span>&#160; <span class="pre">distinct(.keep_all</span> <span class="pre">=</span> <span class="pre">TRUE)\n&quot;,</span>
<span class="pre">&quot;\n&quot;,</span>
<span class="pre">&quot;final_df\n&quot;,</span>
<span class="pre">&quot;`</span></code>”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 14,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;revenue_category&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Avengers&lt;/td&gt;n”,
”      &lt;td&gt;Box Office&lt;/td&gt;n”,
”      &lt;td&gt;1963&lt;/td&gt;n”,
”      &lt;td&gt;15.0&lt;/td&gt;n”,
”      &lt;td&gt;7.765&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Avengers&lt;/td&gt;n”,
”      &lt;td&gt;Comic or Manga&lt;/td&gt;n”,
”      &lt;td&gt;1963&lt;/td&gt;n”,
”      &lt;td&gt;15.0&lt;/td&gt;n”,
”      &lt;td&gt;0.131&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Avengers&lt;/td&gt;n”,
”      &lt;td&gt;Home Video/Entertainment&lt;/td&gt;n”,
”      &lt;td&gt;1963&lt;/td&gt;n”,
”      &lt;td&gt;15.0&lt;/td&gt;n”,
”      &lt;td&gt;0.459&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”  franchise          revenue_category  year_created  total_revenue  revenuen”,
“0  Avengers                Box Office          1963           15.0    7.765n”,
“1  Avengers            Comic or Manga          1963           15.0    0.131n”,
“2  Avengers  Home Video/Entertainment          1963           15.0    0.459”</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 14,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“df_sum = (n”,
”    df_clean.groupby([‘franchise’, ‘revenue_category’])n”,
”    .sum()n”,
”    .flatten_multiindex()n”,
“)n”,
“df_sum.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 15,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;revenue_category&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;book sales&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;Box Office&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Middle-earth (The Lord of the Rings)&lt;/td&gt;n”,
”      &lt;td&gt;Home Video/Entertainment&lt;/td&gt;n”,
”      &lt;td&gt;Novel&lt;/td&gt;n”,
”      &lt;td&gt;J. R. R. Tolkien&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”                              franchise          revenue_category  \n”,
“0  Middle-earth (The Lord of the Rings)                book sales   n”,
“1  Middle-earth (The Lord of the Rings)                Box Office   n”,
“2  Middle-earth (The Lord of the Rings)  Home Video/Entertainment   n”,
“n”,
”  original_media          creators  n”,
“0          Novel  J. R. R. Tolkien  n”,
“1          Novel  J. R. R. Tolkien  n”,
“2          Novel  J. R. R. Tolkien  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 15,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“df_metadata = df_clean[n”,
”    [‘franchise’, ‘revenue_category’, ‘original_media’, ‘creators’]n”,
“]n”,
“df_metadata.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“metadata”: {},
“source”: [</p>
<blockquote>
<div><p>“—n”,
“### Final Dataframe”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 16,
“metadata”: {},
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>“data”: {</dt><dd><dl class="simple">
<dt>“text/html”: [</dt><dd><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;franchise&lt;/th&gt;n”,
”      &lt;th&gt;revenue_category&lt;/th&gt;n”,
”      &lt;th&gt;year_created&lt;/th&gt;n”,
”      &lt;th&gt;total_revenue&lt;/th&gt;n”,
”      &lt;th&gt;revenue&lt;/th&gt;n”,
”      &lt;th&gt;original_media&lt;/th&gt;n”,
”      &lt;th&gt;creators&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Avengers&lt;/td&gt;n”,
”      &lt;td&gt;Box Office&lt;/td&gt;n”,
”      &lt;td&gt;1963&lt;/td&gt;n”,
”      &lt;td&gt;15.0&lt;/td&gt;n”,
”      &lt;td&gt;7.765&lt;/td&gt;n”,
”      &lt;td&gt;Comic book&lt;/td&gt;n”,
”      &lt;td&gt;Stan Lee Jack Kirby&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Avengers&lt;/td&gt;n”,
”      &lt;td&gt;Comic or Manga&lt;/td&gt;n”,
”      &lt;td&gt;1963&lt;/td&gt;n”,
”      &lt;td&gt;15.0&lt;/td&gt;n”,
”      &lt;td&gt;0.131&lt;/td&gt;n”,
”      &lt;td&gt;Comic book&lt;/td&gt;n”,
”      &lt;td&gt;Stan Lee Jack Kirby&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Avengers&lt;/td&gt;n”,
”      &lt;td&gt;Home Video/Entertainment&lt;/td&gt;n”,
”      &lt;td&gt;1963&lt;/td&gt;n”,
”      &lt;td&gt;15.0&lt;/td&gt;n”,
”      &lt;td&gt;0.459&lt;/td&gt;n”,
”      &lt;td&gt;Comic book&lt;/td&gt;n”,
”      &lt;td&gt;Stan Lee Jack Kirby&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</dd>
</dl>
<p>],
“text/plain”: [</p>
<blockquote>
<div><p>”  franchise          revenue_category  year_created  total_revenue  revenue  \n”,
“0  Avengers                Box Office          1963           15.0    7.765   n”,
“1  Avengers            Comic or Manga          1963           15.0    0.131   n”,
“2  Avengers  Home Video/Entertainment          1963           15.0    0.459   n”,
“n”,
”  original_media             creators  n”,
“0     Comic book  Stan Lee Jack Kirby  n”,
“1     Comic book  Stan Lee Jack Kirby  n”,
“2     Comic book  Stan Lee Jack Kirby  “</p>
</div></blockquote>
<p>]</p>
</dd>
</dl>
<p>},
“execution_count”: 16,
“metadata”: {},
“output_type”: “execute_result”</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“source”: [</p>
<blockquote>
<div><p>“# Generate final dataframen”,
“df_final = (n”,
”    pd.merge(n”,
”        df_sum, df_metadata, how=’left’, on=[‘franchise’, ‘revenue_category’]n”,
”    )n”,
”    .drop_duplicates(keep=’first’)n”,
”    .reset_index(drop=True)n”,
“)n”,
“df_final.head(3)”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: null,
“metadata”: {},
“outputs”: [],
“source”: []</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“kernelspec”: {</dt><dd><p>“display_name”: “PyJanitor development”,
“language”: “python”,
“name”: “pyjanitor-dev”</p>
</dd>
</dl>
<p>},
“language_info”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“codemirror_mode”: {</dt><dd><p>“name”: “ipython”,
“version”: 3</p>
</dd>
</dl>
<p>},
“file_extension”: “.py”,
“mimetype”: “text/x-python”,
“name”: “python”,
“nbconvert_exporter”: “python”,
“pygments_lexer”: “ipython3”,
“version”: “3.7.8”</p>
</div></blockquote>
<p>},
“toc”: {</p>
<blockquote>
<div><p>“base_numbering”: 1,
“nav_menu”: {},
“number_sections”: true,
“sideBar”: true,
“skip_h1_title”: false,
“title_cell”: “Table of Contents”,
“title_sidebar”: “Contents”,
“toc_cell”: false,
“toc_position”: {},
“toc_section_display”: true,
“toc_window_display”: false</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 4</p>
</dd>
</dl>
<p>}</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_title.svg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../notebooks.html">Examples</a><ul>
      <li>Previous: <a href="inflating_converting_currency.html" title="previous chapter">&lt;no title&gt;</a></li>
      <li>Next: <a href="normalize.html" title="next chapter">&lt;no title&gt;</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, PyJanitor devs.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/notebooks/medium_franchise.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>