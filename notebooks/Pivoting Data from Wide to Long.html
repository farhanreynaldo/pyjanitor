
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>&lt;no title&gt; &#8212; pyjanitor  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Examples" href="README.html" />
    <link rel="prev" title="&lt;no title&gt;" href="pyjanitor_intro.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <dl>
<dt>{</dt><dd><dl>
<dt>“cells”: [</dt><dd><dl>
<dt>{</dt><dd><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“# Pivot_Longer : One function to cover transformations from wide to long form.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</dd>
</dl>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 141,
“source”: [</p>
<blockquote>
<div><p>“import janitorn”,
“import pandas as pdn”,
“import numpy as np”</p>
</div></blockquote>
<p>],
“outputs”: [],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Unpivoting(reshaping data from wide to long form) in Pandas is executed either through [pd.melt](<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html">https://pandas.pydata.org/docs/reference/api/pandas.melt.html</a>), [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>), or [pd.DataFrame.stack](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html</a>). However, there are scenarios where a few more steps are required to massage the data into the long form that we desire. Take the dataframe below, copied from [Stack Overflow](<a class="reference external" href="https://stackoverflow.com/questions/64061588/pandas-melt-multiple-columns-to-tabulate-a-dataset#64062002">https://stackoverflow.com/questions/64061588/pandas-melt-multiple-columns-to-tabulate-a-dataset#64062002</a>): “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 142,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame(n”,
”        {n”,
”            &quot;id&quot;: [1, 2, 3],n”,
”            &quot;M_start_date_1&quot;: [201709, 201709, 201709],n”,
”            &quot;M_end_date_1&quot;: [201905, 201905, 201905],n”,
”            &quot;M_start_date_2&quot;: [202004, 202004, 202004],n”,
”            &quot;M_end_date_2&quot;: [202005, 202005, 202005],n”,
”            &quot;F_start_date_1&quot;: [201803, 201803, 201803],n”,
”            &quot;F_end_date_1&quot;: [201904, 201904, 201904],n”,
”            &quot;F_start_date_2&quot;: [201912, 201912, 201912],n”,
”            &quot;F_end_date_2&quot;: [202007, 202007, 202007],n”,
”        }n”,
”    )n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id  M_start_date_1  M_end_date_1  M_start_date_2  M_end_date_2  \n”,
“0   1          201709        201905          202004        202005   n”,
“1   2          201709        201905          202004        202005   n”,
“2   3          201709        201905          202004        202005   n”,
“n”,
”   F_start_date_1  F_end_date_1  F_start_date_2  F_end_date_2  n”,
“0          201803        201904          201912        202007  n”,
“1          201803        201904          201912        202007  n”,
“2          201803        201904          201912        202007  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;M_start_date_1&lt;/th&gt;n”,
”      &lt;th&gt;M_end_date_1&lt;/th&gt;n”,
”      &lt;th&gt;M_start_date_2&lt;/th&gt;n”,
”      &lt;th&gt;M_end_date_2&lt;/th&gt;n”,
”      &lt;th&gt;F_start_date_1&lt;/th&gt;n”,
”      &lt;th&gt;F_end_date_1&lt;/th&gt;n”,
”      &lt;th&gt;F_start_date_2&lt;/th&gt;n”,
”      &lt;th&gt;F_end_date_2&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 142</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {</p>
<blockquote>
<div><p>“tags”: []</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Below is a [beautiful solution](<a class="reference external" href="https://stackoverflow.com/a/64062027/7175713">https://stackoverflow.com/a/64062027/7175713</a>), from Stack Overflow : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 143,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.set_index(‘id’)n”,
“df1.columns = df1.columns.str.split(‘_’, expand=True)n”,
“df1 = (df1.stack(level=[0,2,3])n”,
”          .sort_index(level=[0,1], ascending=[True, False])n”,
”          .reset_index(level=[2,3], drop=True)n”,
”          .sort_index(axis=1, ascending=False)n”,
”          .rename_axis([‘id’,’cod’])n”,
”          .reset_index())n”,
“n”,
“df1”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    id cod   start     endn”,
“0    1   M  201709  201905n”,
“1    1   M  202004  202005n”,
“2    1   F  201803  201904n”,
“3    1   F  201912  202007n”,
“4    2   M  201709  201905n”,
“5    2   M  202004  202005n”,
“6    2   F  201803  201904n”,
“7    2   F  201912  202007n”,
“8    3   M  201709  201905n”,
“9    3   M  202004  202005n”,
“10   3   F  201803  201904n”,
“11   3   F  201912  202007”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;cod&lt;/th&gt;n”,
”      &lt;th&gt;start&lt;/th&gt;n”,
”      &lt;th&gt;end&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 143</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We propose an alternative, based on [pandas melt](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html</a>) and [concat](<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html">https://pandas.pydata.org/docs/reference/api/pandas.concat.html</a>), that abstracts the reshaping mechanism, allows the user to focus on the task, can be applied to other scenarios,  and is chainable : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 144,
“source”: [</p>
<blockquote>
<div><p>“result = (df.pivot_longer(index=&quot;id&quot;, n”,
”                          names_to=(&quot;cod&quot;, &quot;.value&quot;, ‘dates’), n”,
”                          names_pattern=&quot;(M|F)_(start|end)_(.+)&quot;, n”,
”                          sort_by_appearance=True)n”,
”            .drop(columns=’dates’)n”,
”        )n”,
“n”,
“result”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    id cod   start     endn”,
“0    1   M  201709  201905n”,
“1    1   M  202004  202005n”,
“2    1   F  201803  201904n”,
“3    1   F  201912  202007n”,
“4    2   M  201709  201905n”,
“5    2   M  202004  202005n”,
“6    2   F  201803  201904n”,
“7    2   F  201912  202007n”,
“8    3   M  201709  201905n”,
“9    3   M  202004  202005n”,
“10   3   F  201803  201904n”,
“11   3   F  201912  202007”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;cod&lt;/th&gt;n”,
”      &lt;th&gt;start&lt;/th&gt;n”,
”      &lt;th&gt;end&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;201709&lt;/td&gt;n”,
”      &lt;td&gt;201905&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;M&lt;/td&gt;n”,
”      &lt;td&gt;202004&lt;/td&gt;n”,
”      &lt;td&gt;202005&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201803&lt;/td&gt;n”,
”      &lt;td&gt;201904&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;201912&lt;/td&gt;n”,
”      &lt;td&gt;202007&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 144</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 145,
“source”: [</p>
<blockquote>
<div><p>“df1.equals(result)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>“True”</p>
</dd>
</dl>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 145</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“[pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html#janitor.pivot_longer">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html#janitor.pivot_longer</a>) is not a new idea; it is a combination of ideas from R’s [tidyr](<a class="reference external" href="https://tidyr.tidyverse.org/reference/pivot_longer.html">https://tidyr.tidyverse.org/reference/pivot_longer.html</a>) and [data.table](<a class="reference external" href="https://rdatatable.gitlab.io/data.table/">https://rdatatable.gitlab.io/data.table/</a>) and is built on the powerful pandas’ [melt](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html</a>) and [concat](<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.concat.html">https://pandas.pydata.org/docs/reference/api/pandas.concat.html</a>) functions.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“[pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html#janitor.pivot_longer">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html#janitor.pivot_longer</a>) can melt dataframes easily; It is just a wrapper around pandas’ [melt](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html).n">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html).n</a>”,
“n”,
“[Source Data](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#reshaping-by-melt">https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html#reshaping-by-melt</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 146,
“source”: [</p>
<blockquote>
<div><p>“index = pd.MultiIndex.from_tuples([(‘person’, ‘A’), (‘person’, ‘B’)])n”,
“n”,
“df = pd.DataFrame({‘first’: [‘John’, ‘Mary’],n”,
”                   ‘last’: [‘Doe’, ‘Bo’],n”,
”                   ‘height’: [5.5, 6.0],n”,
”                   ‘weight’: [130, 150]},n”,
”                   index=index)n”,
”                   n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”         first last  height  weightn”,
“person A  John  Doe     5.5     130n”,
”       B  Mary   Bo     6.0     150”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;first&lt;/th&gt;n”,
”      &lt;th&gt;last&lt;/th&gt;n”,
”      &lt;th&gt;height&lt;/th&gt;n”,
”      &lt;th&gt;weight&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;person&lt;/th&gt;n”,
”      &lt;th&gt;A&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;5.5&lt;/td&gt;n”,
”      &lt;td&gt;130&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;B&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;6.0&lt;/td&gt;n”,
”      &lt;td&gt;150&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 146</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 147,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(index=[‘first’,’last’])”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  first last variable  valuen”,
“0  John  Doe   height    5.5n”,
“1  Mary   Bo   height    6.0n”,
“2  John  Doe   weight  130.0n”,
“3  Mary   Bo   weight  150.0”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;first&lt;/th&gt;n”,
”      &lt;th&gt;last&lt;/th&gt;n”,
”      &lt;th&gt;variable&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;height&lt;/td&gt;n”,
”      &lt;td&gt;5.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;height&lt;/td&gt;n”,
”      &lt;td&gt;6.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;weight&lt;/td&gt;n”,
”      &lt;td&gt;130.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;weight&lt;/td&gt;n”,
”      &lt;td&gt;150.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 147</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“If you want the data unpivoted in order of appearance, you can set <cite>sort_by_appearance</cite> to <code class="docutils literal notranslate"><span class="pre">True</span></code>:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 148,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index=[‘first’,’last’],n”,
”    sort_by_appearance = Truen”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  first last variable  valuen”,
“0  John  Doe   height    5.5n”,
“1  John  Doe   weight  130.0n”,
“2  Mary   Bo   height    6.0n”,
“3  Mary   Bo   weight  150.0”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;first&lt;/th&gt;n”,
”      &lt;th&gt;last&lt;/th&gt;n”,
”      &lt;th&gt;variable&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;height&lt;/td&gt;n”,
”      &lt;td&gt;5.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;weight&lt;/td&gt;n”,
”      &lt;td&gt;130.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;height&lt;/td&gt;n”,
”      &lt;td&gt;6.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;weight&lt;/td&gt;n”,
”      &lt;td&gt;150.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 148</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“If you wish to reuse the original index, you can set <cite>ignore_index</cite> to <code class="docutils literal notranslate"><span class="pre">False</span></code>; note that the index labels will be repeated as necessary:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 149,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index=[‘first’,’last’],n”,
”    ignore_index = Falsen”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”         first last variable  valuen”,
“person A  John  Doe   height    5.5n”,
”       B  Mary   Bo   height    6.0n”,
”       A  John  Doe   weight  130.0n”,
”       B  Mary   Bo   weight  150.0”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;first&lt;/th&gt;n”,
”      &lt;th&gt;last&lt;/th&gt;n”,
”      &lt;th&gt;variable&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;4&quot; valign=&quot;top&quot;&gt;person&lt;/th&gt;n”,
”      &lt;th&gt;A&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;height&lt;/td&gt;n”,
”      &lt;td&gt;5.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;B&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;height&lt;/td&gt;n”,
”      &lt;td&gt;6.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;A&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Doe&lt;/td&gt;n”,
”      &lt;td&gt;weight&lt;/td&gt;n”,
”      &lt;td&gt;130.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;B&lt;/th&gt;n”,
”      &lt;td&gt;Mary&lt;/td&gt;n”,
”      &lt;td&gt;Bo&lt;/td&gt;n”,
”      &lt;td&gt;weight&lt;/td&gt;n”,
”      &lt;td&gt;150.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 149</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“You can also unpivot MultiIndex columns, the same way you would with pandas’ [melt](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html#pandas.melt):n">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html#pandas.melt):n</a>”,
“n”,
“[Source Data](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html#pandas.melt">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html#pandas.melt</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 150,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘A’: {0: ‘a’, 1: ‘b’, 2: ‘c’},n”,
”                   ‘B’: {0: 1, 1: 3, 2: 5},n”,
”                   ‘C’: {0: 2, 1: 4, 2: 6}})n”,
“df.columns = [list(‘ABC’), list(‘DEF’)]n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   A  B  Cn”,
”   D  E  Fn”,
“0  a  1  2n”,
“1  b  3  4n”,
“2  c  5  6”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead tr th {n”,
”        text-align: left;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;A&lt;/th&gt;n”,
”      &lt;th&gt;B&lt;/th&gt;n”,
”      &lt;th&gt;C&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;D&lt;/th&gt;n”,
”      &lt;th&gt;E&lt;/th&gt;n”,
”      &lt;th&gt;F&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;c&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 150</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 151,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = [(&quot;A&quot;, &quot;D&quot;)],n”,
”    values_to = &quot;num&quot;n”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  (A, D) variable_0 variable_1  numn”,
“0      a          B          E    1n”,
“1      b          B          E    3n”,
“2      c          B          E    5n”,
“3      a          C          F    2n”,
“4      b          C          F    4n”,
“5      c          C          F    6”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;(A, D)&lt;/th&gt;n”,
”      &lt;th&gt;variable_0&lt;/th&gt;n”,
”      &lt;th&gt;variable_1&lt;/th&gt;n”,
”      &lt;th&gt;num&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;c&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;c&lt;/td&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 151</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 152,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = [(&quot;A&quot;, &quot;D&quot;)],n”,
”    column_names = [(&quot;B&quot;, &quot;E&quot;)]n”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  (A, D) variable_0 variable_1  valuen”,
“0      a          B          E      1n”,
“1      b          B          E      3n”,
“2      c          B          E      5”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;(A, D)&lt;/th&gt;n”,
”      &lt;th&gt;variable_0&lt;/th&gt;n”,
”      &lt;th&gt;variable_1&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;c&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 152</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“And just like [melt](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html#pandas.melt">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html#pandas.melt</a>), you can unpivot on a specific level, with <cite>column_level</cite>:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 153,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = &quot;A&quot;,n”,
”    column_names = &quot;B&quot;,n”,
”    column_level = 0n”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   A variable  valuen”,
“0  a        B      1n”,
“1  b        B      3n”,
“2  c        B      5”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;A&lt;/th&gt;n”,
”      &lt;th&gt;variable&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;c&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 153</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Note that when unpivoting MultiIndex columns, you need to pass a list of tuples to the <code class="docutils literal notranslate"><span class="pre">index</span></code> or <code class="docutils literal notranslate"><span class="pre">column_names</span></code> parameters.n”,
“n”,
“n”,
“Also, if <code class="docutils literal notranslate"><span class="pre">names_sep</span></code> or <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code> is not None, then unpivoting on MultiIndex columns is not supported.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“You can dynamically select columns, using regular expressions with the <cite>janitor.patterns</cite> function (inspired by R’s data.table’s [patterns](<a class="reference external" href="https://rdatatable.gitlab.io/data.table/reference/patterns.html">https://rdatatable.gitlab.io/data.table/reference/patterns.html</a>) function, and is really just a wrapper around <cite>re.compile</cite>), especially if it is a lot of column names, and you are <em>lazy</em> like me  😄”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 154,
“source”: [</p>
<blockquote>
<div><p>“url = ‘<a class="reference external" href="https://github.com/tidyverse/tidyr/raw/master/data-raw/billboard.csv'n">https://github.com/tidyverse/tidyr/raw/master/data-raw/billboard.csv’n</a>”,
“df = pd.read_csv(url)n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”     year            artist                    track  time date.entered  wk1  \n”,
“0    2000             2 Pac  Baby Don’t Cry (Keep…  4:22   2000-02-26   87   n”,
“1    2000           2Ge+her  The Hardest Part Of …  3:15   2000-09-02   91   n”,
“2    2000      3 Doors Down               Kryptonite  3:53   2000-04-08   81   n”,
“3    2000      3 Doors Down                    Loser  4:24   2000-10-21   76   n”,
“4    2000          504 Boyz            Wobble Wobble  3:35   2000-04-15   57   n”,
“..    …               …                      …   …          …  …   n”,
“312  2000       Yankee Grey     Another Nine Minutes  3:10   2000-04-29   86   n”,
“313  2000  Yearwood, Trisha          Real Live Woman  3:55   2000-04-01   85   n”,
“314  2000   Ying Yang Twins  Whistle While You Tw…  4:19   2000-03-18   95   n”,
“315  2000     Zombie Nation            Kernkraft 400  3:30   2000-09-02   99   n”,
“316  2000   matchbox twenty                     Bent  4:12   2000-04-29   60   n”,
“n”,
”      wk2   wk3   wk4   wk5  …  wk67  wk68  wk69  wk70  wk71  wk72  wk73  \n”,
“0    82.0  72.0  77.0  87.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“1    87.0  92.0   NaN   NaN  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“2    70.0  68.0  67.0  66.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“3    76.0  72.0  69.0  67.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“4    34.0  25.0  17.0  17.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“..    …   …   …   …  …   …   …   …   …   …   …   …   n”,
“312  83.0  77.0  74.0  83.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“313  83.0  83.0  82.0  81.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“314  94.0  91.0  85.0  84.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“315  99.0   NaN   NaN   NaN  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“316  37.0  29.0  24.0  22.0  …   NaN   NaN   NaN   NaN   NaN   NaN   NaN   n”,
“n”,
”     wk74  wk75  wk76  n”,
“0     NaN   NaN   NaN  n”,
“1     NaN   NaN   NaN  n”,
“2     NaN   NaN   NaN  n”,
“3     NaN   NaN   NaN  n”,
“4     NaN   NaN   NaN  n”,
“..    …   …   …  n”,
“312   NaN   NaN   NaN  n”,
“313   NaN   NaN   NaN  n”,
“314   NaN   NaN   NaN  n”,
“315   NaN   NaN   NaN  n”,
“316   NaN   NaN   NaN  n”,
“n”,
“[317 rows x 81 columns]”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;year&lt;/th&gt;n”,
”      &lt;th&gt;artist&lt;/th&gt;n”,
”      &lt;th&gt;track&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;date.entered&lt;/th&gt;n”,
”      &lt;th&gt;wk1&lt;/th&gt;n”,
”      &lt;th&gt;wk2&lt;/th&gt;n”,
”      &lt;th&gt;wk3&lt;/th&gt;n”,
”      &lt;th&gt;wk4&lt;/th&gt;n”,
”      &lt;th&gt;wk5&lt;/th&gt;n”,
”      &lt;th&gt;…&lt;/th&gt;n”,
”      &lt;th&gt;wk67&lt;/th&gt;n”,
”      &lt;th&gt;wk68&lt;/th&gt;n”,
”      &lt;th&gt;wk69&lt;/th&gt;n”,
”      &lt;th&gt;wk70&lt;/th&gt;n”,
”      &lt;th&gt;wk71&lt;/th&gt;n”,
”      &lt;th&gt;wk72&lt;/th&gt;n”,
”      &lt;th&gt;wk73&lt;/th&gt;n”,
”      &lt;th&gt;wk74&lt;/th&gt;n”,
”      &lt;th&gt;wk75&lt;/th&gt;n”,
”      &lt;th&gt;wk76&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;2 Pac&lt;/td&gt;n”,
”      &lt;td&gt;Baby Don’t Cry (Keep…&lt;/td&gt;n”,
”      &lt;td&gt;4:22&lt;/td&gt;n”,
”      &lt;td&gt;2000-02-26&lt;/td&gt;n”,
”      &lt;td&gt;87&lt;/td&gt;n”,
”      &lt;td&gt;82.0&lt;/td&gt;n”,
”      &lt;td&gt;72.0&lt;/td&gt;n”,
”      &lt;td&gt;77.0&lt;/td&gt;n”,
”      &lt;td&gt;87.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;2Ge+her&lt;/td&gt;n”,
”      &lt;td&gt;The Hardest Part Of …&lt;/td&gt;n”,
”      &lt;td&gt;3:15&lt;/td&gt;n”,
”      &lt;td&gt;2000-09-02&lt;/td&gt;n”,
”      &lt;td&gt;91&lt;/td&gt;n”,
”      &lt;td&gt;87.0&lt;/td&gt;n”,
”      &lt;td&gt;92.0&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;3 Doors Down&lt;/td&gt;n”,
”      &lt;td&gt;Kryptonite&lt;/td&gt;n”,
”      &lt;td&gt;3:53&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-08&lt;/td&gt;n”,
”      &lt;td&gt;81&lt;/td&gt;n”,
”      &lt;td&gt;70.0&lt;/td&gt;n”,
”      &lt;td&gt;68.0&lt;/td&gt;n”,
”      &lt;td&gt;67.0&lt;/td&gt;n”,
”      &lt;td&gt;66.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;3 Doors Down&lt;/td&gt;n”,
”      &lt;td&gt;Loser&lt;/td&gt;n”,
”      &lt;td&gt;4:24&lt;/td&gt;n”,
”      &lt;td&gt;2000-10-21&lt;/td&gt;n”,
”      &lt;td&gt;76&lt;/td&gt;n”,
”      &lt;td&gt;76.0&lt;/td&gt;n”,
”      &lt;td&gt;72.0&lt;/td&gt;n”,
”      &lt;td&gt;69.0&lt;/td&gt;n”,
”      &lt;td&gt;67.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;504 Boyz&lt;/td&gt;n”,
”      &lt;td&gt;Wobble Wobble&lt;/td&gt;n”,
”      &lt;td&gt;3:35&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-15&lt;/td&gt;n”,
”      &lt;td&gt;57&lt;/td&gt;n”,
”      &lt;td&gt;34.0&lt;/td&gt;n”,
”      &lt;td&gt;25.0&lt;/td&gt;n”,
”      &lt;td&gt;17.0&lt;/td&gt;n”,
”      &lt;td&gt;17.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;…&lt;/th&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;312&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Yankee Grey&lt;/td&gt;n”,
”      &lt;td&gt;Another Nine Minutes&lt;/td&gt;n”,
”      &lt;td&gt;3:10&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-29&lt;/td&gt;n”,
”      &lt;td&gt;86&lt;/td&gt;n”,
”      &lt;td&gt;83.0&lt;/td&gt;n”,
”      &lt;td&gt;77.0&lt;/td&gt;n”,
”      &lt;td&gt;74.0&lt;/td&gt;n”,
”      &lt;td&gt;83.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;313&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Yearwood, Trisha&lt;/td&gt;n”,
”      &lt;td&gt;Real Live Woman&lt;/td&gt;n”,
”      &lt;td&gt;3:55&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-01&lt;/td&gt;n”,
”      &lt;td&gt;85&lt;/td&gt;n”,
”      &lt;td&gt;83.0&lt;/td&gt;n”,
”      &lt;td&gt;83.0&lt;/td&gt;n”,
”      &lt;td&gt;82.0&lt;/td&gt;n”,
”      &lt;td&gt;81.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;314&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Ying Yang Twins&lt;/td&gt;n”,
”      &lt;td&gt;Whistle While You Tw…&lt;/td&gt;n”,
”      &lt;td&gt;4:19&lt;/td&gt;n”,
”      &lt;td&gt;2000-03-18&lt;/td&gt;n”,
”      &lt;td&gt;95&lt;/td&gt;n”,
”      &lt;td&gt;94.0&lt;/td&gt;n”,
”      &lt;td&gt;91.0&lt;/td&gt;n”,
”      &lt;td&gt;85.0&lt;/td&gt;n”,
”      &lt;td&gt;84.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;315&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Zombie Nation&lt;/td&gt;n”,
”      &lt;td&gt;Kernkraft 400&lt;/td&gt;n”,
”      &lt;td&gt;3:30&lt;/td&gt;n”,
”      &lt;td&gt;2000-09-02&lt;/td&gt;n”,
”      &lt;td&gt;99&lt;/td&gt;n”,
”      &lt;td&gt;99.0&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;316&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;matchbox twenty&lt;/td&gt;n”,
”      &lt;td&gt;Bent&lt;/td&gt;n”,
”      &lt;td&gt;4:12&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-29&lt;/td&gt;n”,
”      &lt;td&gt;60&lt;/td&gt;n”,
”      &lt;td&gt;37.0&lt;/td&gt;n”,
”      &lt;td&gt;29.0&lt;/td&gt;n”,
”      &lt;td&gt;24.0&lt;/td&gt;n”,
”      &lt;td&gt;22.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;p&gt;317 rows × 81 columns&lt;/p&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 154</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 155,
“source”: [</p>
<blockquote>
<div><p>“# unpivot all columns that start with ‘wk’n”,
“df.pivot_longer(column_names = janitor.patterns(&quot;^(wk)&quot;), n”,
”                names_to=’week’)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”       year            artist                    track  time date.entered  \n”,
“0      2000             2 Pac  Baby Don’t Cry (Keep…  4:22   2000-02-26   n”,
“1      2000           2Ge+her  The Hardest Part Of …  3:15   2000-09-02   n”,
“2      2000      3 Doors Down               Kryptonite  3:53   2000-04-08   n”,
“3      2000      3 Doors Down                    Loser  4:24   2000-10-21   n”,
“4      2000          504 Boyz            Wobble Wobble  3:35   2000-04-15   n”,
“…     …               …                      …   …          …   n”,
“24087  2000       Yankee Grey     Another Nine Minutes  3:10   2000-04-29   n”,
“24088  2000  Yearwood, Trisha          Real Live Woman  3:55   2000-04-01   n”,
“24089  2000   Ying Yang Twins  Whistle While You Tw…  4:19   2000-03-18   n”,
“24090  2000     Zombie Nation            Kernkraft 400  3:30   2000-09-02   n”,
“24091  2000   matchbox twenty                     Bent  4:12   2000-04-29   n”,
“n”,
”       week  value  n”,
“0       wk1   87.0  n”,
“1       wk1   91.0  n”,
“2       wk1   81.0  n”,
“3       wk1   76.0  n”,
“4       wk1   57.0  n”,
“…     …    …  n”,
“24087  wk76    NaN  n”,
“24088  wk76    NaN  n”,
“24089  wk76    NaN  n”,
“24090  wk76    NaN  n”,
“24091  wk76    NaN  n”,
“n”,
“[24092 rows x 7 columns]”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;year&lt;/th&gt;n”,
”      &lt;th&gt;artist&lt;/th&gt;n”,
”      &lt;th&gt;track&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;date.entered&lt;/th&gt;n”,
”      &lt;th&gt;week&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;2 Pac&lt;/td&gt;n”,
”      &lt;td&gt;Baby Don’t Cry (Keep…&lt;/td&gt;n”,
”      &lt;td&gt;4:22&lt;/td&gt;n”,
”      &lt;td&gt;2000-02-26&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;87.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;2Ge+her&lt;/td&gt;n”,
”      &lt;td&gt;The Hardest Part Of …&lt;/td&gt;n”,
”      &lt;td&gt;3:15&lt;/td&gt;n”,
”      &lt;td&gt;2000-09-02&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;91.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;3 Doors Down&lt;/td&gt;n”,
”      &lt;td&gt;Kryptonite&lt;/td&gt;n”,
”      &lt;td&gt;3:53&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-08&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;81.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;3 Doors Down&lt;/td&gt;n”,
”      &lt;td&gt;Loser&lt;/td&gt;n”,
”      &lt;td&gt;4:24&lt;/td&gt;n”,
”      &lt;td&gt;2000-10-21&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;76.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;504 Boyz&lt;/td&gt;n”,
”      &lt;td&gt;Wobble Wobble&lt;/td&gt;n”,
”      &lt;td&gt;3:35&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-15&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;57.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;…&lt;/th&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24087&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Yankee Grey&lt;/td&gt;n”,
”      &lt;td&gt;Another Nine Minutes&lt;/td&gt;n”,
”      &lt;td&gt;3:10&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-29&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24088&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Yearwood, Trisha&lt;/td&gt;n”,
”      &lt;td&gt;Real Live Woman&lt;/td&gt;n”,
”      &lt;td&gt;3:55&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-01&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24089&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Ying Yang Twins&lt;/td&gt;n”,
”      &lt;td&gt;Whistle While You Tw…&lt;/td&gt;n”,
”      &lt;td&gt;4:19&lt;/td&gt;n”,
”      &lt;td&gt;2000-03-18&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24090&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Zombie Nation&lt;/td&gt;n”,
”      &lt;td&gt;Kernkraft 400&lt;/td&gt;n”,
”      &lt;td&gt;3:30&lt;/td&gt;n”,
”      &lt;td&gt;2000-09-02&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24091&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;matchbox twenty&lt;/td&gt;n”,
”      &lt;td&gt;Bent&lt;/td&gt;n”,
”      &lt;td&gt;4:12&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-29&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;p&gt;24092 rows × 7 columns&lt;/p&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 155</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“You can also use [pyjanitor’s](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/">https://pyjanitor-devs.github.io/pyjanitor/</a>) [select_columns](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.select_columns.html#janitor.select_columns">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.select_columns.html#janitor.select_columns</a>) syntax:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 156,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(column_names = &quot;wk*&quot;, n”,
”                names_to = ‘week’)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”       year            artist                    track  time date.entered  \n”,
“0      2000             2 Pac  Baby Don’t Cry (Keep…  4:22   2000-02-26   n”,
“1      2000           2Ge+her  The Hardest Part Of …  3:15   2000-09-02   n”,
“2      2000      3 Doors Down               Kryptonite  3:53   2000-04-08   n”,
“3      2000      3 Doors Down                    Loser  4:24   2000-10-21   n”,
“4      2000          504 Boyz            Wobble Wobble  3:35   2000-04-15   n”,
“…     …               …                      …   …          …   n”,
“24087  2000       Yankee Grey     Another Nine Minutes  3:10   2000-04-29   n”,
“24088  2000  Yearwood, Trisha          Real Live Woman  3:55   2000-04-01   n”,
“24089  2000   Ying Yang Twins  Whistle While You Tw…  4:19   2000-03-18   n”,
“24090  2000     Zombie Nation            Kernkraft 400  3:30   2000-09-02   n”,
“24091  2000   matchbox twenty                     Bent  4:12   2000-04-29   n”,
“n”,
”       week  value  n”,
“0       wk1   87.0  n”,
“1       wk1   91.0  n”,
“2       wk1   81.0  n”,
“3       wk1   76.0  n”,
“4       wk1   57.0  n”,
“…     …    …  n”,
“24087  wk76    NaN  n”,
“24088  wk76    NaN  n”,
“24089  wk76    NaN  n”,
“24090  wk76    NaN  n”,
“24091  wk76    NaN  n”,
“n”,
“[24092 rows x 7 columns]”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;year&lt;/th&gt;n”,
”      &lt;th&gt;artist&lt;/th&gt;n”,
”      &lt;th&gt;track&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;date.entered&lt;/th&gt;n”,
”      &lt;th&gt;week&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;2 Pac&lt;/td&gt;n”,
”      &lt;td&gt;Baby Don’t Cry (Keep…&lt;/td&gt;n”,
”      &lt;td&gt;4:22&lt;/td&gt;n”,
”      &lt;td&gt;2000-02-26&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;87.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;2Ge+her&lt;/td&gt;n”,
”      &lt;td&gt;The Hardest Part Of …&lt;/td&gt;n”,
”      &lt;td&gt;3:15&lt;/td&gt;n”,
”      &lt;td&gt;2000-09-02&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;91.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;3 Doors Down&lt;/td&gt;n”,
”      &lt;td&gt;Kryptonite&lt;/td&gt;n”,
”      &lt;td&gt;3:53&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-08&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;81.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;3 Doors Down&lt;/td&gt;n”,
”      &lt;td&gt;Loser&lt;/td&gt;n”,
”      &lt;td&gt;4:24&lt;/td&gt;n”,
”      &lt;td&gt;2000-10-21&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;76.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;504 Boyz&lt;/td&gt;n”,
”      &lt;td&gt;Wobble Wobble&lt;/td&gt;n”,
”      &lt;td&gt;3:35&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-15&lt;/td&gt;n”,
”      &lt;td&gt;wk1&lt;/td&gt;n”,
”      &lt;td&gt;57.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;…&lt;/th&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24087&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Yankee Grey&lt;/td&gt;n”,
”      &lt;td&gt;Another Nine Minutes&lt;/td&gt;n”,
”      &lt;td&gt;3:10&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-29&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24088&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Yearwood, Trisha&lt;/td&gt;n”,
”      &lt;td&gt;Real Live Woman&lt;/td&gt;n”,
”      &lt;td&gt;3:55&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-01&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24089&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Ying Yang Twins&lt;/td&gt;n”,
”      &lt;td&gt;Whistle While You Tw…&lt;/td&gt;n”,
”      &lt;td&gt;4:19&lt;/td&gt;n”,
”      &lt;td&gt;2000-03-18&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24090&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;Zombie Nation&lt;/td&gt;n”,
”      &lt;td&gt;Kernkraft 400&lt;/td&gt;n”,
”      &lt;td&gt;3:30&lt;/td&gt;n”,
”      &lt;td&gt;2000-09-02&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;24091&lt;/th&gt;n”,
”      &lt;td&gt;2000&lt;/td&gt;n”,
”      &lt;td&gt;matchbox twenty&lt;/td&gt;n”,
”      &lt;td&gt;Bent&lt;/td&gt;n”,
”      &lt;td&gt;4:12&lt;/td&gt;n”,
”      &lt;td&gt;2000-04-29&lt;/td&gt;n”,
”      &lt;td&gt;wk76&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;p&gt;24092 rows × 7 columns&lt;/p&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 156</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“[pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html#janitor.pivot_longer">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html#janitor.pivot_longer</a>) can also unpivot paired columns.  In this regard, it is like pandas’ [wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>), but with more flexibility and power. Let’s look at an example from pandas’ [wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) docs : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 157,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({n”,
”    ‘famid’: [1, 1, 1, 2, 2, 2, 3, 3, 3],n”,
”    ‘birth’: [1, 2, 3, 1, 2, 3, 1, 2, 3],n”,
”    ‘ht1’: [2.8, 2.9, 2.2, 2, 1.8, 1.9, 2.2, 2.3, 2.1],n”,
”    ‘ht2’: [3.4, 3.8, 2.9, 3.2, 2.8, 2.4, 3.3, 3.4, 2.9]n”,
“})n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   famid  birth  ht1  ht2n”,
“0      1      1  2.8  3.4n”,
“1      1      2  2.9  3.8n”,
“2      1      3  2.2  2.9n”,
“3      2      1  2.0  3.2n”,
“4      2      2  1.8  2.8n”,
“5      2      3  1.9  2.4n”,
“6      3      1  2.2  3.3n”,
“7      3      2  2.3  3.4n”,
“8      3      3  2.1  2.9”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;famid&lt;/th&gt;n”,
”      &lt;th&gt;birth&lt;/th&gt;n”,
”      &lt;th&gt;ht1&lt;/th&gt;n”,
”      &lt;th&gt;ht2&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”      &lt;td&gt;3.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.0&lt;/td&gt;n”,
”      &lt;td&gt;3.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1.8&lt;/td&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1.9&lt;/td&gt;n”,
”      &lt;td&gt;2.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.3&lt;/td&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2.1&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 157</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“In the data above, the <a href="#id1"><span class="problematic" id="id2">`</span></a>height`(ht) is paired with <a href="#id3"><span class="problematic" id="id4">`</span></a>age`(numbers). [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) can handle this easily:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 158,
“source”: [</p>
<blockquote>
<div><p>“pd.wide_to_long(df, stubnames=’ht’, i=[‘famid’, ‘birth’], j=’age’)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”                  htn”,
“famid birth age     n”,
“1     1     1    2.8n”,
”            2    3.4n”,
”      2     1    2.9n”,
”            2    3.8n”,
”      3     1    2.2n”,
”            2    2.9n”,
“2     1     1    2.0n”,
”            2    3.2n”,
”      2     1    1.8n”,
”            2    2.8n”,
”      3     1    1.9n”,
”            2    2.4n”,
“3     1     1    2.2n”,
”            2    3.3n”,
”      2     1    2.3n”,
”            2    3.4n”,
”      3     1    2.1n”,
”            2    2.9”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;ht&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;famid&lt;/th&gt;n”,
”      &lt;th&gt;birth&lt;/th&gt;n”,
”      &lt;th&gt;age&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;6&quot; valign=&quot;top&quot;&gt;1&lt;/th&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;1&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;2&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;3&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;6&quot; valign=&quot;top&quot;&gt;2&lt;/th&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;1&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;2&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;3&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;6&quot; valign=&quot;top&quot;&gt;3&lt;/th&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;1&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;2&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;3&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2.1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 158</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Now let’s see how [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) handles this:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 159,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(index=[‘famid’,’birth’],n”,
”                names_to=(‘.value’, ‘age’),n”,
”                names_pattern=r&quot;(ht)(\d)&quot;)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    famid  birth age   htn”,
“0       1      1   1  2.8n”,
“1       1      2   1  2.9n”,
“2       1      3   1  2.2n”,
“3       2      1   1  2.0n”,
“4       2      2   1  1.8n”,
“5       2      3   1  1.9n”,
“6       3      1   1  2.2n”,
“7       3      2   1  2.3n”,
“8       3      3   1  2.1n”,
“9       1      1   2  3.4n”,
“10      1      2   2  3.8n”,
“11      1      3   2  2.9n”,
“12      2      1   2  3.2n”,
“13      2      2   2  2.8n”,
“14      2      3   2  2.4n”,
“15      3      1   2  3.3n”,
“16      3      2   2  3.4n”,
“17      3      3   2  2.9”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;famid&lt;/th&gt;n”,
”      &lt;th&gt;birth&lt;/th&gt;n”,
”      &lt;th&gt;age&lt;/th&gt;n”,
”      &lt;th&gt;ht&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;12&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;13&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;14&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;15&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;16&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;17&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 159</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The first observable difference is that [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) is method chainable, while [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) is not. Now, let’s learn more about the <cite>.value</cite> variable.n”,
“n”,
“n”,
“When <cite>.value</cite> is used in <cite>names_to</cite>, a pairing is created between <code class="docutils literal notranslate"><span class="pre">names_to</span></code> and <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>. For the example above, we get this pairing :n”,
“n”,
”                                          {&quot;.value&quot;: (&quot;ht&quot;), &quot;age&quot;: (\d)} n”,
“n”,
“This tells the [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) function to keep values associated with <cite>.value`(`ht</cite>) as the column name, while values not associated with <cite>.value</cite>, in this case, the numbers, will be collated under a new column <code class="docutils literal notranslate"><span class="pre">age</span></code>. Internally, pandas <cite>str.extract</cite> is used to get the capturing groups before reshaping. This level of abstraction, we believe, allows the user to focus on the task, and get things done faster.n”,
“n”,
“Note that if you want the data returned in order of appearance you can set <cite>sort_by_appearance</cite> to <cite>True</cite>:n”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 160,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = [‘famid’,’birth’],n”,
”    names_to = (‘.value’, ‘age’),n”,
”    names_pattern = r&quot;(ht)(\d)&quot;,                 n”,
”    sort_by_appearance = True,n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    famid  birth age   htn”,
“0       1      1   1  2.8n”,
“1       1      1   2  3.4n”,
“2       1      2   1  2.9n”,
“3       1      2   2  3.8n”,
“4       1      3   1  2.2n”,
“5       1      3   2  2.9n”,
“6       2      1   1  2.0n”,
“7       2      1   2  3.2n”,
“8       2      2   1  1.8n”,
“9       2      2   2  2.8n”,
“10      2      3   1  1.9n”,
“11      2      3   2  2.4n”,
“12      3      1   1  2.2n”,
“13      3      1   2  3.3n”,
“14      3      2   1  2.3n”,
“15      3      2   2  3.4n”,
“16      3      3   1  2.1n”,
“17      3      3   2  2.9”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;famid&lt;/th&gt;n”,
”      &lt;th&gt;birth&lt;/th&gt;n”,
”      &lt;th&gt;age&lt;/th&gt;n”,
”      &lt;th&gt;ht&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;12&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;13&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;14&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;15&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;16&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2.1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;17&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;2.9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 160</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Note that you are likely to get more speed when <cite>sort_by_appearance</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.n”,
“n”,
“Note also that the values in the <cite>age</cite> column are of <cite>object</cite> dtype. You can change the dtype, using pandas’ [astype](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.astype.html</a>) method.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We’ve seen already that [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) handles this already and very well, so why bother? Let’s look at another scenario where [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) would need a few more steps. [Source Data](<a class="reference external" href="https://community.rstudio.com/t/pivot-longer-on-multiple-column-sets-pairs/43958">https://community.rstudio.com/t/pivot-longer-on-multiple-column-sets-pairs/43958</a>):”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 161,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame(n”,
”    {n”,
”        &quot;off_loc&quot;: [&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;],n”,
”        &quot;pt_loc&quot;: [&quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;, &quot;K&quot;, &quot;L&quot;],n”,
”        &quot;pt_lat&quot;: [n”,
”            100.07548220000001,n”,
”            75.191326,n”,
”            122.65134479999999,n”,
”            124.13553329999999,n”,
”            124.13553329999999,n”,
”            124.01028909999998,n”,
”        ],n”,
”        &quot;off_lat&quot;: [n”,
”            121.271083,n”,
”            75.93845266,n”,
”            135.043791,n”,
”            134.51128400000002,n”,
”            134.484374,n”,
”            137.962195,n”,
”        ],n”,
”        &quot;pt_long&quot;: [n”,
”            4.472089953,n”,
”            -144.387785,n”,
”            -40.45611048,n”,
”            -46.07156181,n”,
”            -46.07156181,n”,
”            -46.01594293,n”,
”        ],n”,
”        &quot;off_long&quot;: [n”,
”            -7.188632000000001,n”,
”            -143.2288569,n”,
”            21.242563,n”,
”            40.937416999999996,n”,
”            40.78472,n”,
”            22.905889000000002,n”,
”        ],n”,
”    }n”,
“)n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  off_loc pt_loc      pt_lat     off_lat     pt_long    off_longn”,
“0       A      G  100.075482  121.271083    4.472090   -7.188632n”,
“1       B      H   75.191326   75.938453 -144.387785 -143.228857n”,
“2       C      I  122.651345  135.043791  -40.456110   21.242563n”,
“3       D      J  124.135533  134.511284  -46.071562   40.937417n”,
“4       E      K  124.135533  134.484374  -46.071562   40.784720n”,
“5       F      L  124.010289  137.962195  -46.015943   22.905889”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;off_loc&lt;/th&gt;n”,
”      &lt;th&gt;pt_loc&lt;/th&gt;n”,
”      &lt;th&gt;pt_lat&lt;/th&gt;n”,
”      &lt;th&gt;off_lat&lt;/th&gt;n”,
”      &lt;th&gt;pt_long&lt;/th&gt;n”,
”      &lt;th&gt;off_long&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;G&lt;/td&gt;n”,
”      &lt;td&gt;100.075482&lt;/td&gt;n”,
”      &lt;td&gt;121.271083&lt;/td&gt;n”,
”      &lt;td&gt;4.472090&lt;/td&gt;n”,
”      &lt;td&gt;-7.188632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;H&lt;/td&gt;n”,
”      &lt;td&gt;75.191326&lt;/td&gt;n”,
”      &lt;td&gt;75.938453&lt;/td&gt;n”,
”      &lt;td&gt;-144.387785&lt;/td&gt;n”,
”      &lt;td&gt;-143.228857&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;I&lt;/td&gt;n”,
”      &lt;td&gt;122.651345&lt;/td&gt;n”,
”      &lt;td&gt;135.043791&lt;/td&gt;n”,
”      &lt;td&gt;-40.456110&lt;/td&gt;n”,
”      &lt;td&gt;21.242563&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;J&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;134.511284&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”      &lt;td&gt;40.937417&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;K&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;134.484374&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”      &lt;td&gt;40.784720&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;L&lt;/td&gt;n”,
”      &lt;td&gt;124.010289&lt;/td&gt;n”,
”      &lt;td&gt;137.962195&lt;/td&gt;n”,
”      &lt;td&gt;-46.015943&lt;/td&gt;n”,
”      &lt;td&gt;22.905889&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 161</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We can unpivot with [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) by first reorganising the columns : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 162,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.copy()n”,
“df1.columns = [&quot;_&quot;.join(col.split(&quot;_&quot;)[::-1])n”,
”               for col in df1.columns]n”,
“df1”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  loc_off loc_pt      lat_pt     lat_off     long_pt    long_offn”,
“0       A      G  100.075482  121.271083    4.472090   -7.188632n”,
“1       B      H   75.191326   75.938453 -144.387785 -143.228857n”,
“2       C      I  122.651345  135.043791  -40.456110   21.242563n”,
“3       D      J  124.135533  134.511284  -46.071562   40.937417n”,
“4       E      K  124.135533  134.484374  -46.071562   40.784720n”,
“5       F      L  124.010289  137.962195  -46.015943   22.905889”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;loc_off&lt;/th&gt;n”,
”      &lt;th&gt;loc_pt&lt;/th&gt;n”,
”      &lt;th&gt;lat_pt&lt;/th&gt;n”,
”      &lt;th&gt;lat_off&lt;/th&gt;n”,
”      &lt;th&gt;long_pt&lt;/th&gt;n”,
”      &lt;th&gt;long_off&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;G&lt;/td&gt;n”,
”      &lt;td&gt;100.075482&lt;/td&gt;n”,
”      &lt;td&gt;121.271083&lt;/td&gt;n”,
”      &lt;td&gt;4.472090&lt;/td&gt;n”,
”      &lt;td&gt;-7.188632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;H&lt;/td&gt;n”,
”      &lt;td&gt;75.191326&lt;/td&gt;n”,
”      &lt;td&gt;75.938453&lt;/td&gt;n”,
”      &lt;td&gt;-144.387785&lt;/td&gt;n”,
”      &lt;td&gt;-143.228857&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;I&lt;/td&gt;n”,
”      &lt;td&gt;122.651345&lt;/td&gt;n”,
”      &lt;td&gt;135.043791&lt;/td&gt;n”,
”      &lt;td&gt;-40.456110&lt;/td&gt;n”,
”      &lt;td&gt;21.242563&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;J&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;134.511284&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”      &lt;td&gt;40.937417&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;K&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;134.484374&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”      &lt;td&gt;40.784720&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;L&lt;/td&gt;n”,
”      &lt;td&gt;124.010289&lt;/td&gt;n”,
”      &lt;td&gt;137.962195&lt;/td&gt;n”,
”      &lt;td&gt;-46.015943&lt;/td&gt;n”,
”      &lt;td&gt;22.905889&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 162</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Now, we can unpivot : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 163,
“source”: [</p>
<blockquote>
<div><p>“pd.wide_to_long(n”,
”    df1.reset_index(),n”,
”    stubnames=[&quot;loc&quot;, &quot;lat&quot;, &quot;long&quot;],n”,
”    sep=&quot;_&quot;,n”,
”    i=&quot;index&quot;,n”,
”    j=&quot;set&quot;,n”,
”    suffix=&quot;.+&quot;,n”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”          loc         lat        longn”,
“index set                            n”,
“0     off   A  121.271083   -7.188632n”,
”      pt    G  100.075482    4.472090n”,
“1     off   B   75.938453 -143.228857n”,
”      pt    H   75.191326 -144.387785n”,
“2     off   C  135.043791   21.242563n”,
”      pt    I  122.651345  -40.456110n”,
“3     off   D  134.511284   40.937417n”,
”      pt    J  124.135533  -46.071562n”,
“4     off   E  134.484374   40.784720n”,
”      pt    K  124.135533  -46.071562n”,
“5     off   F  137.962195   22.905889n”,
”      pt    L  124.010289  -46.015943”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;loc&lt;/th&gt;n”,
”      &lt;th&gt;lat&lt;/th&gt;n”,
”      &lt;th&gt;long&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;index&lt;/th&gt;n”,
”      &lt;th&gt;set&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;0&lt;/th&gt;n”,
”      &lt;th&gt;off&lt;/th&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;121.271083&lt;/td&gt;n”,
”      &lt;td&gt;-7.188632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;pt&lt;/th&gt;n”,
”      &lt;td&gt;G&lt;/td&gt;n”,
”      &lt;td&gt;100.075482&lt;/td&gt;n”,
”      &lt;td&gt;4.472090&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;1&lt;/th&gt;n”,
”      &lt;th&gt;off&lt;/th&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;75.938453&lt;/td&gt;n”,
”      &lt;td&gt;-143.228857&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;pt&lt;/th&gt;n”,
”      &lt;td&gt;H&lt;/td&gt;n”,
”      &lt;td&gt;75.191326&lt;/td&gt;n”,
”      &lt;td&gt;-144.387785&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;2&lt;/th&gt;n”,
”      &lt;th&gt;off&lt;/th&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;135.043791&lt;/td&gt;n”,
”      &lt;td&gt;21.242563&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;pt&lt;/th&gt;n”,
”      &lt;td&gt;I&lt;/td&gt;n”,
”      &lt;td&gt;122.651345&lt;/td&gt;n”,
”      &lt;td&gt;-40.456110&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;3&lt;/th&gt;n”,
”      &lt;th&gt;off&lt;/th&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;134.511284&lt;/td&gt;n”,
”      &lt;td&gt;40.937417&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;pt&lt;/th&gt;n”,
”      &lt;td&gt;J&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;4&lt;/th&gt;n”,
”      &lt;th&gt;off&lt;/th&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;134.484374&lt;/td&gt;n”,
”      &lt;td&gt;40.784720&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;pt&lt;/th&gt;n”,
”      &lt;td&gt;K&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;5&lt;/th&gt;n”,
”      &lt;th&gt;off&lt;/th&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;137.962195&lt;/td&gt;n”,
”      &lt;td&gt;22.905889&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;pt&lt;/th&gt;n”,
”      &lt;td&gt;L&lt;/td&gt;n”,
”      &lt;td&gt;124.010289&lt;/td&gt;n”,
”      &lt;td&gt;-46.015943&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 163</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {</p>
<blockquote>
<div><p>“tags”: []</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We can get the same transformed dataframe, with less lines, using [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>):”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 164,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    names_to = [&quot;set&quot;, &quot;.value&quot;], n”,
”    names_pattern = &quot;(.+)_(.+)&quot;n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    set loc         lat        longn”,
“0   off   A  121.271083   -7.188632n”,
“1   off   B   75.938453 -143.228857n”,
“2   off   C  135.043791   21.242563n”,
“3   off   D  134.511284   40.937417n”,
“4   off   E  134.484374   40.784720n”,
“5   off   F  137.962195   22.905889n”,
“6    pt   G  100.075482    4.472090n”,
“7    pt   H   75.191326 -144.387785n”,
“8    pt   I  122.651345  -40.456110n”,
“9    pt   J  124.135533  -46.071562n”,
“10   pt   K  124.135533  -46.071562n”,
“11   pt   L  124.010289  -46.015943”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;set&lt;/th&gt;n”,
”      &lt;th&gt;loc&lt;/th&gt;n”,
”      &lt;th&gt;lat&lt;/th&gt;n”,
”      &lt;th&gt;long&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;121.271083&lt;/td&gt;n”,
”      &lt;td&gt;-7.188632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;75.938453&lt;/td&gt;n”,
”      &lt;td&gt;-143.228857&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;135.043791&lt;/td&gt;n”,
”      &lt;td&gt;21.242563&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;134.511284&lt;/td&gt;n”,
”      &lt;td&gt;40.937417&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;134.484374&lt;/td&gt;n”,
”      &lt;td&gt;40.784720&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;137.962195&lt;/td&gt;n”,
”      &lt;td&gt;22.905889&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;G&lt;/td&gt;n”,
”      &lt;td&gt;100.075482&lt;/td&gt;n”,
”      &lt;td&gt;4.472090&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;H&lt;/td&gt;n”,
”      &lt;td&gt;75.191326&lt;/td&gt;n”,
”      &lt;td&gt;-144.387785&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;I&lt;/td&gt;n”,
”      &lt;td&gt;122.651345&lt;/td&gt;n”,
”      &lt;td&gt;-40.456110&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;J&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;K&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;L&lt;/td&gt;n”,
”      &lt;td&gt;124.010289&lt;/td&gt;n”,
”      &lt;td&gt;-46.015943&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 164</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {</p>
<blockquote>
<div><p>“tags”: []</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 165,
“source”: [</p>
<blockquote>
<div><p>“# Another way to see the pairings, n”,
“# to see what is linked to <cite>.value</cite>, n”,
“n”,
“# names_to =     [&quot;set&quot;, &quot;.value&quot;]n”,
“# names_pattern = &quot;(.+)_(.+)&quot;n”,
“# column _names =   off_locn”,
“#                   off_latn”,
“#                   off_long”</p>
</div></blockquote>
<p>],
“outputs”: [],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Again, the key here is the <cite>.value</cite> symbol. Pairing <cite>names_to</cite> with <cite>names_pattern</cite> and its results from [pd.str.extract](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.extract.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.extract.html</a>), we get : n”,
“n”,
”                            set–&gt; (.+) –&gt; [off, pt] and n”,
”                            .value–&gt; (.+) –&gt; [loc, lat, long] n”,
”                                           n”,
“All values associated with <cite>.value`(loc, lat, long) remain as column names, while values not associated with `.value`(off, pt) are lumped into a new column ``set`</cite>. n”,
“n”,
“Notice that we did not have to reset the index - [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) takes care of that internally;  [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) allows you to focus on what you want, so you can get it and move on.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Note that the unpivoting could also have been executed with <cite>names_sep</cite>:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 166,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    names_to = [&quot;set&quot;, &quot;.value&quot;], n”,
”    names_sep = &quot;_&quot;,n”,
”    ignore_index = False,n”,
”    sort_by_appearance = Truen”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   set loc         lat        longn”,
“0  off   A  121.271083   -7.188632n”,
“0   pt   G  100.075482    4.472090n”,
“1  off   B   75.938453 -143.228857n”,
“1   pt   H   75.191326 -144.387785n”,
“2  off   C  135.043791   21.242563n”,
“2   pt   I  122.651345  -40.456110n”,
“3  off   D  134.511284   40.937417n”,
“3   pt   J  124.135533  -46.071562n”,
“4  off   E  134.484374   40.784720n”,
“4   pt   K  124.135533  -46.071562n”,
“5  off   F  137.962195   22.905889n”,
“5   pt   L  124.010289  -46.015943”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;set&lt;/th&gt;n”,
”      &lt;th&gt;loc&lt;/th&gt;n”,
”      &lt;th&gt;lat&lt;/th&gt;n”,
”      &lt;th&gt;long&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;121.271083&lt;/td&gt;n”,
”      &lt;td&gt;-7.188632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;G&lt;/td&gt;n”,
”      &lt;td&gt;100.075482&lt;/td&gt;n”,
”      &lt;td&gt;4.472090&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;75.938453&lt;/td&gt;n”,
”      &lt;td&gt;-143.228857&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;H&lt;/td&gt;n”,
”      &lt;td&gt;75.191326&lt;/td&gt;n”,
”      &lt;td&gt;-144.387785&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;C&lt;/td&gt;n”,
”      &lt;td&gt;135.043791&lt;/td&gt;n”,
”      &lt;td&gt;21.242563&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;I&lt;/td&gt;n”,
”      &lt;td&gt;122.651345&lt;/td&gt;n”,
”      &lt;td&gt;-40.456110&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;134.511284&lt;/td&gt;n”,
”      &lt;td&gt;40.937417&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;J&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;134.484374&lt;/td&gt;n”,
”      &lt;td&gt;40.784720&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;K&lt;/td&gt;n”,
”      &lt;td&gt;124.135533&lt;/td&gt;n”,
”      &lt;td&gt;-46.071562&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;off&lt;/td&gt;n”,
”      &lt;td&gt;F&lt;/td&gt;n”,
”      &lt;td&gt;137.962195&lt;/td&gt;n”,
”      &lt;td&gt;22.905889&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;pt&lt;/td&gt;n”,
”      &lt;td&gt;L&lt;/td&gt;n”,
”      &lt;td&gt;124.010289&lt;/td&gt;n”,
”      &lt;td&gt;-46.015943&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 166</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Let’s look at another example, from [Stack Overflow](<a class="reference external" href="https://stackoverflow.com/questions/45123924/convert-pandas-dataframe-from-wide-to-long/45124130">https://stackoverflow.com/questions/45123924/convert-pandas-dataframe-from-wide-to-long/45124130</a>) : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 167,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame([{‘a_1’: 2, ‘ab_1’: 3, n”,
”                    ‘ac_1’: 4, ‘a_2’: 5, n”,
”                    ‘ab_2’: 6, ‘ac_2’: 7}])n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   a_1  ab_1  ac_1  a_2  ab_2  ac_2n”,
“0    2     3     4    5     6     7”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;a_1&lt;/th&gt;n”,
”      &lt;th&gt;ab_1&lt;/th&gt;n”,
”      &lt;th&gt;ac_1&lt;/th&gt;n”,
”      &lt;th&gt;a_2&lt;/th&gt;n”,
”      &lt;th&gt;ab_2&lt;/th&gt;n”,
”      &lt;th&gt;ac_2&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”      &lt;td&gt;7&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 167</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The data above requires extracting <cite>a</cite>, <cite>ab</cite> and <cite>ac</cite> from <cite>1</cite> and <cite>2</cite>. This is another example of a paired column. We could solve this using [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>); infact there is a very good solution from [Stack Overflow](<a class="reference external" href="https://stackoverflow.com/a/45124775/7175713">https://stackoverflow.com/a/45124775/7175713</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 168,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.copy()n”,
“df1[‘id’] = df1.indexn”,
“pd.wide_to_long(df1, [‘a’,’ab’,’ac’],i=’id’,j=’num’,sep=’_’)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”        a  ab  acn”,
“id num           n”,
“0  1    2   3   4n”,
”   2    5   6   7”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;a&lt;/th&gt;n”,
”      &lt;th&gt;ab&lt;/th&gt;n”,
”      &lt;th&gt;ac&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;num&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;2&quot; valign=&quot;top&quot;&gt;0&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”      &lt;td&gt;7&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 168</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {</p>
<blockquote>
<div><p>“tags”: []</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Or you could simply pass the buck to [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>): “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 169,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    names_to = (‘.value’, ‘num’), n”,
”    names_sep = ‘_’n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  num  a  ab  acn”,
“0   1  2   3   4n”,
“1   2  5   6   7”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;num&lt;/th&gt;n”,
”      &lt;th&gt;a&lt;/th&gt;n”,
”      &lt;th&gt;ab&lt;/th&gt;n”,
”      &lt;th&gt;ac&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”      &lt;td&gt;7&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 169</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {</p>
<blockquote>
<div><p>“tags”: []</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“In the solution above, we used the <cite>names_sep</cite> argument, as it is more convenient. A few more examples to get you familiar with the <cite>.value</cite> symbol.n”,
“n”,
“[Source Data](<a class="reference external" href="https://stackoverflow.com/questions/55403008/pandas-partial-melt-or-group-melt">https://stackoverflow.com/questions/55403008/pandas-partial-melt-or-group-melt</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 170,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame([[1,1,2,3,4,5,6],n”,
”                   [2,7,8,9,10,11,12]], n”,
”                  columns=[‘id’, ‘ax’,’ay’,’az’,’bx’,’by’,’bz’])n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id  ax  ay  az  bx  by  bzn”,
“0   1   1   2   3   4   5   6n”,
“1   2   7   8   9  10  11  12”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;ax&lt;/th&gt;n”,
”      &lt;th&gt;ay&lt;/th&gt;n”,
”      &lt;th&gt;az&lt;/th&gt;n”,
”      &lt;th&gt;bx&lt;/th&gt;n”,
”      &lt;th&gt;by&lt;/th&gt;n”,
”      &lt;th&gt;bz&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;7&lt;/td&gt;n”,
”      &lt;td&gt;8&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 170</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 171,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = ‘id’, n”,
”    names_to = (‘name’, ‘.value’), n”,
”    names_pattern = ‘(.)(.)’n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id name   x   y   zn”,
“0   1    a   1   2   3n”,
“1   2    a   7   8   9n”,
“2   1    b   4   5   6n”,
“3   2    b  10  11  12”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;name&lt;/th&gt;n”,
”      &lt;th&gt;x&lt;/th&gt;n”,
”      &lt;th&gt;y&lt;/th&gt;n”,
”      &lt;th&gt;z&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;7&lt;/td&gt;n”,
”      &lt;td&gt;8&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 171</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“For the code above <cite>.value</cite> is paired with <cite>x</cite>, <cite>y</cite>, <cite>z`(which become the new column names), while `a</cite>, <cite>b</cite> are unpivoted into the <cite>name</cite> column. “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“In the dataframe below, we need to unpivot the data, keeping only the suffix <cite>hi</cite>, and pulling out the number between <cite>A</cite> and <cite>g</cite>. [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/35929985/melt-a-data-table-with-a-column-pattern">https://stackoverflow.com/questions/35929985/melt-a-data-table-with-a-column-pattern</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 172,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame([{‘id’: 1, ‘A1g_hi’: 2, n”,
”                    ‘A2g_hi’: 3, ‘A3g_hi’: 4, n”,
”                    ‘A4g_hi’: 5}])n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id  A1g_hi  A2g_hi  A3g_hi  A4g_hin”,
“0   1       2       3       4       5”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;A1g_hi&lt;/th&gt;n”,
”      &lt;th&gt;A2g_hi&lt;/th&gt;n”,
”      &lt;th&gt;A3g_hi&lt;/th&gt;n”,
”      &lt;th&gt;A4g_hi&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 172</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 173,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = ‘id’, n”,
”    names_to = [‘time’,’.value’], n”,
”    names_pattern = &quot;A(\d)g_(hi)&quot;)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id time  hin”,
“0   1    1   2n”,
“1   1    2   3n”,
“2   1    3   4n”,
“3   1    4   5”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;hi&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 173</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Let’s see an example where we have multiple values in a paired column, and we wish to split them into separate columns. [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/64107566/how-to-pivot-longer-and-populate-with-fields-from-column-names-at-the-same-tim?noredirect=1#comment113369419_64107566">https://stackoverflow.com/questions/64107566/how-to-pivot-longer-and-populate-with-fields-from-column-names-at-the-same-tim?noredirect=1#comment113369419_64107566</a>) : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 174,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame(n”,
”    {n”,
”        &quot;Sony | TV | Model | value&quot;: {0: &quot;A222&quot;, 1: &quot;A234&quot;, 2: &quot;A4345&quot;},n”,
”        &quot;Sony | TV | Quantity | value&quot;: {0: 5, 1: 5, 2: 4},n”,
”        &quot;Sony | TV | Max-quant | value&quot;: {0: 10, 1: 9, 2: 9},n”,
”        &quot;Panasonic | TV | Model | value&quot;: {0: &quot;T232&quot;, 1: &quot;S3424&quot;, 2: &quot;X3421&quot;},n”,
”        &quot;Panasonic | TV | Quantity | value&quot;: {0: 1, 1: 5, 2: 1},n”,
”        &quot;Panasonic | TV | Max-quant | value&quot;: {0: 10, 1: 12, 2: 11},n”,
”        &quot;Sanyo | Radio | Model | value&quot;: {0: &quot;S111&quot;, 1: &quot;S1s1&quot;, 2: &quot;S1s2&quot;},n”,
”        &quot;Sanyo | Radio | Quantity | value&quot;: {0: 4, 1: 2, 2: 4},n”,
”        &quot;Sanyo | Radio | Max-quant | value&quot;: {0: 9, 1: 9, 2: 10},n”,
”    }n”,
“)n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Sony | TV | Model | value  Sony | TV | Quantity | value  \n”,
“0                      A222                             5   n”,
“1                      A234                             5   n”,
“2                     A4345                             4   n”,
“n”,
”   Sony | TV | Max-quant | value Panasonic | TV | Model | value  \n”,
“0                             10                           T232   n”,
“1                              9                          S3424   n”,
“2                              9                          X3421   n”,
“n”,
”   Panasonic | TV | Quantity | value  Panasonic | TV | Max-quant | value  \n”,
“0                                  1                                  10   n”,
“1                                  5                                  12   n”,
“2                                  1                                  11   n”,
“n”,
”  Sanyo | Radio | Model | value  Sanyo | Radio | Quantity | value  \n”,
“0                          S111                                 4   n”,
“1                          S1s1                                 2   n”,
“2                          S1s2                                 4   n”,
“n”,
”   Sanyo | Radio | Max-quant | value  n”,
“0                                  9  n”,
“1                                  9  n”,
“2                                 10  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Sony | TV | Model | value&lt;/th&gt;n”,
”      &lt;th&gt;Sony | TV | Quantity | value&lt;/th&gt;n”,
”      &lt;th&gt;Sony | TV | Max-quant | value&lt;/th&gt;n”,
”      &lt;th&gt;Panasonic | TV | Model | value&lt;/th&gt;n”,
”      &lt;th&gt;Panasonic | TV | Quantity | value&lt;/th&gt;n”,
”      &lt;th&gt;Panasonic | TV | Max-quant | value&lt;/th&gt;n”,
”      &lt;th&gt;Sanyo | Radio | Model | value&lt;/th&gt;n”,
”      &lt;th&gt;Sanyo | Radio | Quantity | value&lt;/th&gt;n”,
”      &lt;th&gt;Sanyo | Radio | Max-quant | value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;A222&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”      &lt;td&gt;T232&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”      &lt;td&gt;S111&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;A234&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”      &lt;td&gt;S3424&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”      &lt;td&gt;S1s1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;A4345&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”      &lt;td&gt;X3421&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”      &lt;td&gt;S1s2&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 174</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The goal is to reshape the data into long format, with separate columns for <cite>Manufacturer`(Sony,…), `Device`(TV, Radio), `Model`(S3424, …), ``maximum quantity`</cite> and <code class="docutils literal notranslate"><span class="pre">quantity</span></code>. n”,
“n”,
“Below is the [accepted solution](<a class="reference external" href="https://stackoverflow.com/a/64107688/7175713">https://stackoverflow.com/a/64107688/7175713</a>) on Stack Overflow :”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 175,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.copy()n”,
“# Create a multiIndex column headern”,
“df1.columns = pd.MultiIndex.from_arrays(n”,
”    zip(<a href="#id5"><span class="problematic" id="id6">*</span></a>df1.columns.str.split(&quot;\s?\|\s?&quot;))n”,
“)n”,
“n”,
“# Reshape the dataframe using n”,
“# <cite>set_index</cite>, <cite>droplevel</cite>, and <cite>stack</cite>n”,
“(df1.stack([0, 1])n”,
” .droplevel(1, axis=1)n”,
” .set_index(&quot;Model&quot;, append=True)n”,
” .rename_axis([None, &quot;Manufacturer&quot;, &quot;Device&quot;, &quot;Model&quot;])n”,
” .sort_index(level=[1, 2, 3])n”,
” .reset_index()n”,
” .drop(&quot;level_0&quot;, axis=1)n”,
” )n”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Manufacturer Device  Model  Max-quant  Quantityn”,
“0    Panasonic     TV  S3424       12.0       5.0n”,
“1    Panasonic     TV   T232       10.0       1.0n”,
“2    Panasonic     TV  X3421       11.0       1.0n”,
“3        Sanyo  Radio   S111        9.0       4.0n”,
“4        Sanyo  Radio   S1s1        9.0       2.0n”,
“5        Sanyo  Radio   S1s2       10.0       4.0n”,
“6         Sony     TV   A222       10.0       5.0n”,
“7         Sony     TV   A234        9.0       5.0n”,
“8         Sony     TV  A4345        9.0       4.0”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Manufacturer&lt;/th&gt;n”,
”      &lt;th&gt;Device&lt;/th&gt;n”,
”      &lt;th&gt;Model&lt;/th&gt;n”,
”      &lt;th&gt;Max-quant&lt;/th&gt;n”,
”      &lt;th&gt;Quantity&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Panasonic&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;S3424&lt;/td&gt;n”,
”      &lt;td&gt;12.0&lt;/td&gt;n”,
”      &lt;td&gt;5.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Panasonic&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;T232&lt;/td&gt;n”,
”      &lt;td&gt;10.0&lt;/td&gt;n”,
”      &lt;td&gt;1.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Panasonic&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;X3421&lt;/td&gt;n”,
”      &lt;td&gt;11.0&lt;/td&gt;n”,
”      &lt;td&gt;1.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Sanyo&lt;/td&gt;n”,
”      &lt;td&gt;Radio&lt;/td&gt;n”,
”      &lt;td&gt;S111&lt;/td&gt;n”,
”      &lt;td&gt;9.0&lt;/td&gt;n”,
”      &lt;td&gt;4.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Sanyo&lt;/td&gt;n”,
”      &lt;td&gt;Radio&lt;/td&gt;n”,
”      &lt;td&gt;S1s1&lt;/td&gt;n”,
”      &lt;td&gt;9.0&lt;/td&gt;n”,
”      &lt;td&gt;2.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Sanyo&lt;/td&gt;n”,
”      &lt;td&gt;Radio&lt;/td&gt;n”,
”      &lt;td&gt;S1s2&lt;/td&gt;n”,
”      &lt;td&gt;10.0&lt;/td&gt;n”,
”      &lt;td&gt;4.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;Sony&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;A222&lt;/td&gt;n”,
”      &lt;td&gt;10.0&lt;/td&gt;n”,
”      &lt;td&gt;5.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;Sony&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;A234&lt;/td&gt;n”,
”      &lt;td&gt;9.0&lt;/td&gt;n”,
”      &lt;td&gt;5.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;Sony&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;A4345&lt;/td&gt;n”,
”      &lt;td&gt;9.0&lt;/td&gt;n”,
”      &lt;td&gt;4.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 175</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Or, we could use [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>), along with <cite>.value</cite> in <cite>names_to</cite> and a regular expression in <cite>names_pattern</cite> : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 176,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    names_to = (&quot;Manufacturer&quot;, &quot;Device&quot;, &quot;.value&quot;),n”,
”    names_pattern = r&quot;(.+)\|(.+)\|(.+)\|.*&quot;,n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Manufacturer   Device  Model    Quantity    Max-quant n”,
“0        Sony       TV     A222           5           10n”,
“1        Sony       TV     A234           5            9n”,
“2        Sony       TV    A4345           4            9n”,
“3   Panasonic       TV     T232           1           10n”,
“4   Panasonic       TV    S3424           5           12n”,
“5   Panasonic       TV    X3421           1           11n”,
“6       Sanyo    Radio     S111           4            9n”,
“7       Sanyo    Radio     S1s1           2            9n”,
“8       Sanyo    Radio     S1s2           4           10”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Manufacturer&lt;/th&gt;n”,
”      &lt;th&gt;Device&lt;/th&gt;n”,
”      &lt;th&gt;Model&lt;/th&gt;n”,
”      &lt;th&gt;Quantity&lt;/th&gt;n”,
”      &lt;th&gt;Max-quant&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Sony&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;A222&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Sony&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;A234&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Sony&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;A4345&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Panasonic&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;T232&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Panasonic&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;S3424&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Panasonic&lt;/td&gt;n”,
”      &lt;td&gt;TV&lt;/td&gt;n”,
”      &lt;td&gt;X3421&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;Sanyo&lt;/td&gt;n”,
”      &lt;td&gt;Radio&lt;/td&gt;n”,
”      &lt;td&gt;S111&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;Sanyo&lt;/td&gt;n”,
”      &lt;td&gt;Radio&lt;/td&gt;n”,
”      &lt;td&gt;S1s1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;9&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;Sanyo&lt;/td&gt;n”,
”      &lt;td&gt;Radio&lt;/td&gt;n”,
”      &lt;td&gt;S1s2&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 176</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The cleanup (removal of whitespace in the column names) is left as an exercise for the reader.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“What if we are interested in unpivoting only a part of the entire dataframe? [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/63044119/converting-wide-format-data-into-long-format-with-multiple-indices-and-grouped-d">https://stackoverflow.com/questions/63044119/converting-wide-format-data-into-long-format-with-multiple-indices-and-grouped-d</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 177,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘time’: [1, 2, 3], n”,
”                   ‘factor’: [‘a’,’a’,’b’],n”,
”                   ‘variable1’: [0,0,0],n”,
”                   ‘variable2’: [0,0,1],n”,
”                   ‘variable3’: [0,2,0],n”,
”                   ‘variable4’: [2,0,1],n”,
”                   ‘variable5’: [1,0,1],n”,
”                   ‘variable6’: [0,1,1],                   n”,
”                   ‘O1V1’: [0,0.2,-0.3],n”,
”                   ‘O1V2’: [0,0.4,-0.9],n”,
”                   ‘O1V3’: [0.5,0.2,-0.6],n”,
”                   ‘O1V4’: [0.5,0.2,-0.6],n”,
”                   ‘O1V5’: [0,0.2,-0.3],n”,
”                   ‘O1V6’: [0,0.4,-0.9],n”,
”                   ‘O1V7’: [0.5,0.2,-0.6],n”,
”                   ‘O1V8’: [0.5,0.2,-0.6],                   n”,
”                   ‘O2V1’: [0,0.5,0.3],n”,
”                   ‘O2V2’: [0,0.2,0.9],n”,
”                   ‘O2V3’: [0.6,0.1,-0.3],n”,
”                   ‘O2V4’: [0.5,0.2,-0.6],n”,
”                   ‘O2V5’: [0,0.5,0.3],n”,
”                   ‘O2V6’: [0,0.2,0.9],n”,
”                   ‘O2V7’: [0.6,0.1,-0.3],n”,
”                   ‘O2V8’: [0.5,0.2,-0.6],                   n”,
”                   ‘O3V1’: [0,0.7,0.4],n”,
”                   ‘O3V2’: [0.9,0.2,-0.3],n”,
”                   ‘O3V3’: [0.5,0.2,-0.7],n”,
”                   ‘O3V4’: [0.5,0.2,-0.6],n”,
”                   ‘O3V5’: [0,0.7,0.4],n”,
”                   ‘O3V6’: [0.9,0.2,-0.3],n”,
”                   ‘O3V7’: [0.5,0.2,-0.7],n”,
”                   ‘O3V8’: [0.5,0.2,-0.6]})n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   time factor  variable1  variable2  variable3  variable4  variable5  \n”,
“0     1      a          0          0          0          2          1   n”,
“1     2      a          0          0          2          0          0   n”,
“2     3      b          0          1          0          1          1   n”,
“n”,
”   variable6  O1V1  O1V2  …  O2V7  O2V8  O3V1  O3V2  O3V3  O3V4  O3V5  O3V6  \n”,
“0          0   0.0   0.0  …   0.6   0.5   0.0   0.9   0.5   0.5   0.0   0.9   n”,
“1          1   0.2   0.4  …   0.1   0.2   0.7   0.2   0.2   0.2   0.7   0.2   n”,
“2          1  -0.3  -0.9  …  -0.3  -0.6   0.4  -0.3  -0.7  -0.6   0.4  -0.3   n”,
“n”,
”   O3V7  O3V8  n”,
“0   0.5   0.5  n”,
“1   0.2   0.2  n”,
“2  -0.7  -0.6  n”,
“n”,
“[3 rows x 32 columns]”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;factor&lt;/th&gt;n”,
”      &lt;th&gt;variable1&lt;/th&gt;n”,
”      &lt;th&gt;variable2&lt;/th&gt;n”,
”      &lt;th&gt;variable3&lt;/th&gt;n”,
”      &lt;th&gt;variable4&lt;/th&gt;n”,
”      &lt;th&gt;variable5&lt;/th&gt;n”,
”      &lt;th&gt;variable6&lt;/th&gt;n”,
”      &lt;th&gt;O1V1&lt;/th&gt;n”,
”      &lt;th&gt;O1V2&lt;/th&gt;n”,
”      &lt;th&gt;…&lt;/th&gt;n”,
”      &lt;th&gt;O2V7&lt;/th&gt;n”,
”      &lt;th&gt;O2V8&lt;/th&gt;n”,
”      &lt;th&gt;O3V1&lt;/th&gt;n”,
”      &lt;th&gt;O3V2&lt;/th&gt;n”,
”      &lt;th&gt;O3V3&lt;/th&gt;n”,
”      &lt;th&gt;O3V4&lt;/th&gt;n”,
”      &lt;th&gt;O3V5&lt;/th&gt;n”,
”      &lt;th&gt;O3V6&lt;/th&gt;n”,
”      &lt;th&gt;O3V7&lt;/th&gt;n”,
”      &lt;th&gt;O3V8&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;0.6&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.9&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.9&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;0.1&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.7&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.7&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.9&lt;/td&gt;n”,
”      &lt;td&gt;…&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.7&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.7&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;p&gt;3 rows × 32 columns&lt;/p&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 177</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“What is the task? This is copied verbatim from the source:n”,
“n”,
“&lt;blockquote&gt;Each row of the data frame represents a time period. There are multiple ‘subjects’ being monitored, namely O1, O2, and O3. Each subject has 8 variables being measured. I need to convert this data into long format where each row contains the information for one subject at a given time period, but with only the first 4 subject variables, as well as the extra information about this time period in columns 2-4, but not columns 5-8.&lt;/blockquote&gt;”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Below is the accepted solution, using [wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>):”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 178,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.rename(columns={x: x[2:]+x[1:2] for x in df.columns[df.columns.str.startswith(‘O’)]})n”,
“n”,
“df1 = pd.wide_to_long(df1, i=[‘time’, ‘factor’]+[f’variable{i}’ for i in range(1,7)], n”,
”                      j=’id’, stubnames=[f’V{i}’ for i in range(1,9)], suffix=’.*’)n”,
“n”,
“df1 = (df1.reset_index()n”,
”          .drop(columns=[f’V{i}’ for i in range(5,9)]n”,
”                        +[f’variable{i}’ for i in range(3,7)]))n”,
“n”,
“df1”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   time factor  variable1  variable2  id   V1   V2   V3   V4n”,
“0     1      a          0          0   1  0.0  0.0  0.5  0.5n”,
“1     1      a          0          0   2  0.0  0.0  0.6  0.5n”,
“2     1      a          0          0   3  0.0  0.9  0.5  0.5n”,
“3     2      a          0          0   1  0.2  0.4  0.2  0.2n”,
“4     2      a          0          0   2  0.5  0.2  0.1  0.2n”,
“5     2      a          0          0   3  0.7  0.2  0.2  0.2n”,
“6     3      b          0          1   1 -0.3 -0.9 -0.6 -0.6n”,
“7     3      b          0          1   2  0.3  0.9 -0.3 -0.6n”,
“8     3      b          0          1   3  0.4 -0.3 -0.7 -0.6”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;factor&lt;/th&gt;n”,
”      &lt;th&gt;variable1&lt;/th&gt;n”,
”      &lt;th&gt;variable2&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;V1&lt;/th&gt;n”,
”      &lt;th&gt;V2&lt;/th&gt;n”,
”      &lt;th&gt;V3&lt;/th&gt;n”,
”      &lt;th&gt;V4&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.6&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.9&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.1&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;0.7&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.9&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0.3&lt;/td&gt;n”,
”      &lt;td&gt;0.9&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.7&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 178</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We can abstract the details and focus on the task with [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>):”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 179,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = slice(&quot;time&quot;, &quot;variable2&quot;),n”,
”    column_names = janitor.patterns(&quot;.+V[1-4]$&quot;),n”,
”    names_to = (&quot;id&quot;, &quot;.value&quot;),n”,
”    names_pattern = &quot;.(.)(.+)$&quot;,n”,
”    sort_by_appearance = Truen”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   time factor  variable1  variable2 id   V1   V2   V3   V4n”,
“0     1      a          0          0  1  0.0  0.0  0.5  0.5n”,
“1     1      a          0          0  2  0.0  0.0  0.6  0.5n”,
“2     1      a          0          0  3  0.0  0.9  0.5  0.5n”,
“3     2      a          0          0  1  0.2  0.4  0.2  0.2n”,
“4     2      a          0          0  2  0.5  0.2  0.1  0.2n”,
“5     2      a          0          0  3  0.7  0.2  0.2  0.2n”,
“6     3      b          0          1  1 -0.3 -0.9 -0.6 -0.6n”,
“7     3      b          0          1  2  0.3  0.9 -0.3 -0.6n”,
“8     3      b          0          1  3  0.4 -0.3 -0.7 -0.6”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;time&lt;/th&gt;n”,
”      &lt;th&gt;factor&lt;/th&gt;n”,
”      &lt;th&gt;variable1&lt;/th&gt;n”,
”      &lt;th&gt;variable2&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;V1&lt;/th&gt;n”,
”      &lt;th&gt;V2&lt;/th&gt;n”,
”      &lt;th&gt;V3&lt;/th&gt;n”,
”      &lt;th&gt;V4&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.6&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;0.0&lt;/td&gt;n”,
”      &lt;td&gt;0.9&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0.5&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.1&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;a&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;0.7&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”      &lt;td&gt;0.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.9&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;0.3&lt;/td&gt;n”,
”      &lt;td&gt;0.9&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;b&lt;/td&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;0.4&lt;/td&gt;n”,
”      &lt;td&gt;-0.3&lt;/td&gt;n”,
”      &lt;td&gt;-0.7&lt;/td&gt;n”,
”      &lt;td&gt;-0.6&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 179</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“One more example on the <cite>.value</cite> symbol for paired columns [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/59477686/python-pandas-melt-single-column-into-two-seperate">https://stackoverflow.com/questions/59477686/python-pandas-melt-single-column-into-two-seperate</a>) : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 180,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘id’: [1, 2], n”,
”                   ‘A_value’: [50, 33], n”,
”                   ‘D_value’: [60, 45]})n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id  A_value  D_valuen”,
“0   1       50       60n”,
“1   2       33       45”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;A_value&lt;/th&gt;n”,
”      &lt;th&gt;D_value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;50&lt;/td&gt;n”,
”      &lt;td&gt;60&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;33&lt;/td&gt;n”,
”      &lt;td&gt;45&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 180</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 181,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = ‘id’, n”,
”    names_to = (‘value_type’, ‘.value’), n”,
”    names_sep = ‘_’n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id value_type  valuen”,
“0   1          A     50n”,
“1   2          A     33n”,
“2   1          D     60n”,
“3   2          D     45”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;value_type&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;50&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;33&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;60&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;D&lt;/td&gt;n”,
”      &lt;td&gt;45&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 181</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“There are scenarios where we need to unpivot the data, and group values within the column names under new columns. The values in the columns will not become new column names, so we do not need the <cite>.value</cite> symbol. Let’s see an example below: [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/59550804/melt-column-by-substring-of-the-columns-name-in-pandas-python">https://stackoverflow.com/questions/59550804/melt-column-by-substring-of-the-columns-name-in-pandas-python</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 182,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘subject’: [1, 2],n”,
”                   ‘A_target_word_gd’: [1, 11],n”,
”                   ‘A_target_word_fd’: [2, 12],n”,
”                   ‘B_target_word_gd’: [3, 13],n”,
”                   ‘B_target_word_fd’: [4, 14],n”,
”                   ‘subject_type’: [‘mild’, ‘moderate’]})n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   subject  A_target_word_gd  A_target_word_fd  B_target_word_gd  \n”,
“0        1                 1                 2                 3   n”,
“1        2                11                12                13   n”,
“n”,
”   B_target_word_fd subject_type  n”,
“0                 4         mild  n”,
“1                14     moderate  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;subject&lt;/th&gt;n”,
”      &lt;th&gt;A_target_word_gd&lt;/th&gt;n”,
”      &lt;th&gt;A_target_word_fd&lt;/th&gt;n”,
”      &lt;th&gt;B_target_word_gd&lt;/th&gt;n”,
”      &lt;th&gt;B_target_word_fd&lt;/th&gt;n”,
”      &lt;th&gt;subject_type&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”      &lt;td&gt;13&lt;/td&gt;n”,
”      &lt;td&gt;14&lt;/td&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 182</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“In the dataframe above, <cite>A</cite> and <cite>B</cite> represent conditions, while the suffixes <cite>gd</cite> and <cite>fd</cite> represent value types. We are not interested in the words in the middle (<cite>_target_word</cite>). We could solve it this way (this is the chosen solution, copied from [Stack Overflow](<a class="reference external" href="https://stackoverflow.com/a/59550967/7175713">https://stackoverflow.com/a/59550967/7175713</a>)) : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 183,
“source”: [</p>
<blockquote>
<div><p>“new_df =(pd.melt(df,n”,
”                id_vars=[‘subject_type’,’subject’], n”,
”                var_name=’abc’)n”,
”           .sort_values(by=[‘subject’, ‘subject_type’])n”,
”         )n”,
“new_df[‘cond’]=(new_df[‘abc’]n”,
”                .apply(lambda x: (x.split(‘_’))[0])n”,
”                )n”,
“new_df[‘value_type’]=(new_dfn”,
”                      .pop(‘abc’)n”,
”                      .apply(lambda x: (x.split(‘_’))[-1])n”,
”                      )n”,
“new_dfn”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  subject_type  subject  value cond value_typen”,
“0         mild        1      1    A         gdn”,
“2         mild        1      2    A         fdn”,
“4         mild        1      3    B         gdn”,
“6         mild        1      4    B         fdn”,
“1     moderate        2     11    A         gdn”,
“3     moderate        2     12    A         fdn”,
“5     moderate        2     13    B         gdn”,
“7     moderate        2     14    B         fd”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;subject_type&lt;/th&gt;n”,
”      &lt;th&gt;subject&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”      &lt;th&gt;cond&lt;/th&gt;n”,
”      &lt;th&gt;value_type&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;13&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;14&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 183</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Or, we could just pass the buck to [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>): “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 184,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = [&quot;subject&quot;, &quot;subject_type&quot;],n”,
”    names_to = (&quot;cond&quot;, &quot;value_type&quot;),n”,
”    names_pattern = &quot;([A-Z]).*(gd|fd)&quot;,n”,
“)n”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   subject subject_type cond value_type  valuen”,
“0        1         mild    A         gd      1n”,
“1        2     moderate    A         gd     11n”,
“2        1         mild    A         fd      2n”,
“3        2     moderate    A         fd     12n”,
“4        1         mild    B         gd      3n”,
“5        2     moderate    B         gd     13n”,
“6        1         mild    B         fd      4n”,
“7        2     moderate    B         fd     14”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;subject&lt;/th&gt;n”,
”      &lt;th&gt;subject_type&lt;/th&gt;n”,
”      &lt;th&gt;cond&lt;/th&gt;n”,
”      &lt;th&gt;value_type&lt;/th&gt;n”,
”      &lt;th&gt;value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”      &lt;td&gt;11&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;A&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”      &lt;td&gt;12&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;gd&lt;/td&gt;n”,
”      &lt;td&gt;13&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;mild&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;moderate&lt;/td&gt;n”,
”      &lt;td&gt;B&lt;/td&gt;n”,
”      &lt;td&gt;fd&lt;/td&gt;n”,
”      &lt;td&gt;14&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 184</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“In the code above, we pass in the new names of the columns to <cite>names_to`(‘cond’, ‘value_type’), and pass the groups to be extracted as a regular expression to `names_pattern</cite>. “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Here’s another example where [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) abstracts the process and makes reshaping easy.n”,
“n”,
“n”,
“In the dataframe below, we would like to unpivot the data and separate the column names into individual columns(<cite>vault</cite> should be in an <cite>event</cite> column, <cite>2012</cite> should be in a <cite>year</cite> column and <cite>f</cite> should be in a <cite>gender</cite> column). [Source Data](<a class="reference external" href="https://dcl-wrangle.stanford.edu/pivot-advanced.html">https://dcl-wrangle.stanford.edu/pivot-advanced.html</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 185,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame(n”,
”            {n”,
”                &quot;country&quot;: [&quot;United States&quot;, &quot;Russia&quot;, &quot;China&quot;],n”,
”                &quot;vault_2012_f&quot;: [n”,
”                    48.132,n”,
”                    46.366,n”,
”                    44.266,n”,
”                ],n”,
”                &quot;vault_2012_m&quot;: [46.632, 46.866, 48.316],n”,
”                &quot;vault_2016_f&quot;: [n”,
”                    46.866,n”,
”                    45.733,n”,
”                    44.332,n”,
”                ],n”,
”                &quot;vault_2016_m&quot;: [45.865, 46.033, 45.0],n”,
”                &quot;floor_2012_f&quot;: [45.366, 41.599, 40.833],n”,
”                &quot;floor_2012_m&quot;: [45.266, 45.308, 45.133],n”,
”                &quot;floor_2016_f&quot;: [45.999, 42.032, 42.066],n”,
”                &quot;floor_2016_m&quot;: [43.757, 44.766, 43.799],n”,
”            }n”,
”        )n”,
“dfn”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”         country  vault_2012_f  vault_2012_m  vault_2016_f  vault_2016_m  \n”,
“0  United States        48.132        46.632        46.866        45.865   n”,
“1         Russia        46.366        46.866        45.733        46.033   n”,
“2          China        44.266        48.316        44.332        45.000   n”,
“n”,
”   floor_2012_f  floor_2012_m  floor_2016_f  floor_2016_m  n”,
“0        45.366        45.266        45.999        43.757  n”,
“1        41.599        45.308        42.032        44.766  n”,
“2        40.833        45.133        42.066        43.799  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;country&lt;/th&gt;n”,
”      &lt;th&gt;vault_2012_f&lt;/th&gt;n”,
”      &lt;th&gt;vault_2012_m&lt;/th&gt;n”,
”      &lt;th&gt;vault_2016_f&lt;/th&gt;n”,
”      &lt;th&gt;vault_2016_m&lt;/th&gt;n”,
”      &lt;th&gt;floor_2012_f&lt;/th&gt;n”,
”      &lt;th&gt;floor_2012_m&lt;/th&gt;n”,
”      &lt;th&gt;floor_2016_f&lt;/th&gt;n”,
”      &lt;th&gt;floor_2016_m&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;48.132&lt;/td&gt;n”,
”      &lt;td&gt;46.632&lt;/td&gt;n”,
”      &lt;td&gt;46.866&lt;/td&gt;n”,
”      &lt;td&gt;45.865&lt;/td&gt;n”,
”      &lt;td&gt;45.366&lt;/td&gt;n”,
”      &lt;td&gt;45.266&lt;/td&gt;n”,
”      &lt;td&gt;45.999&lt;/td&gt;n”,
”      &lt;td&gt;43.757&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;46.366&lt;/td&gt;n”,
”      &lt;td&gt;46.866&lt;/td&gt;n”,
”      &lt;td&gt;45.733&lt;/td&gt;n”,
”      &lt;td&gt;46.033&lt;/td&gt;n”,
”      &lt;td&gt;41.599&lt;/td&gt;n”,
”      &lt;td&gt;45.308&lt;/td&gt;n”,
”      &lt;td&gt;42.032&lt;/td&gt;n”,
”      &lt;td&gt;44.766&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;44.266&lt;/td&gt;n”,
”      &lt;td&gt;48.316&lt;/td&gt;n”,
”      &lt;td&gt;44.332&lt;/td&gt;n”,
”      &lt;td&gt;45.000&lt;/td&gt;n”,
”      &lt;td&gt;40.833&lt;/td&gt;n”,
”      &lt;td&gt;45.133&lt;/td&gt;n”,
”      &lt;td&gt;42.066&lt;/td&gt;n”,
”      &lt;td&gt;43.799&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 185</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We could achieve this with a combination of [pd.melt](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.melt.html</a>) and pandas string methods (or janitor’s [deconcatenate_columns](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.deconcatenate_column.html#janitor.deconcatenate_column">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.deconcatenate_column.html#janitor.deconcatenate_column</a>) method); or we could, again, pass the buck to [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>): “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 186,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = &quot;country&quot;,n”,
”    names_to = [&quot;event&quot;, &quot;year&quot;, &quot;gender&quot;],n”,
”    names_sep = &quot;_&quot;,n”,
”    values_to = &quot;score&quot;,n”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”          country  event  year gender   scoren”,
“0   United States  vault  2012      f  48.132n”,
“1          Russia  vault  2012      f  46.366n”,
“2           China  vault  2012      f  44.266n”,
“3   United States  vault  2012      m  46.632n”,
“4          Russia  vault  2012      m  46.866n”,
“5           China  vault  2012      m  48.316n”,
“6   United States  vault  2016      f  46.866n”,
“7          Russia  vault  2016      f  45.733n”,
“8           China  vault  2016      f  44.332n”,
“9   United States  vault  2016      m  45.865n”,
“10         Russia  vault  2016      m  46.033n”,
“11          China  vault  2016      m  45.000n”,
“12  United States  floor  2012      f  45.366n”,
“13         Russia  floor  2012      f  41.599n”,
“14          China  floor  2012      f  40.833n”,
“15  United States  floor  2012      m  45.266n”,
“16         Russia  floor  2012      m  45.308n”,
“17          China  floor  2012      m  45.133n”,
“18  United States  floor  2016      f  45.999n”,
“19         Russia  floor  2016      f  42.032n”,
“20          China  floor  2016      f  42.066n”,
“21  United States  floor  2016      m  43.757n”,
“22         Russia  floor  2016      m  44.766n”,
“23          China  floor  2016      m  43.799”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;country&lt;/th&gt;n”,
”      &lt;th&gt;event&lt;/th&gt;n”,
”      &lt;th&gt;year&lt;/th&gt;n”,
”      &lt;th&gt;gender&lt;/th&gt;n”,
”      &lt;th&gt;score&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;48.132&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;46.366&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;44.266&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;46.632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;46.866&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;48.316&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;46.866&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;45.733&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;44.332&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.865&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;46.033&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;12&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;45.366&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;13&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;41.599&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;14&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;40.833&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;15&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.266&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;16&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.308&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;17&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.133&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;18&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;45.999&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;19&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;42.032&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;20&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;42.066&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;21&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;43.757&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;22&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;44.766&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;23&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;43.799&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 186</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Again, if you want the data returned in order of appearance, you can turn on the <cite>sort_by_appearance</cite> parameter:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 187,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = &quot;country&quot;,n”,
”    names_to = [&quot;event&quot;, &quot;year&quot;, &quot;gender&quot;],n”,
”    names_sep = &quot;_&quot;,n”,
”    values_to = &quot;score&quot;,n”,
”    sort_by_appearance = Truen”,
“)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”          country  event  year gender   scoren”,
“0   United States  vault  2012      f  48.132n”,
“1   United States  vault  2012      m  46.632n”,
“2   United States  vault  2016      f  46.866n”,
“3   United States  vault  2016      m  45.865n”,
“4   United States  floor  2012      f  45.366n”,
“5   United States  floor  2012      m  45.266n”,
“6   United States  floor  2016      f  45.999n”,
“7   United States  floor  2016      m  43.757n”,
“8          Russia  vault  2012      f  46.366n”,
“9          Russia  vault  2012      m  46.866n”,
“10         Russia  vault  2016      f  45.733n”,
“11         Russia  vault  2016      m  46.033n”,
“12         Russia  floor  2012      f  41.599n”,
“13         Russia  floor  2012      m  45.308n”,
“14         Russia  floor  2016      f  42.032n”,
“15         Russia  floor  2016      m  44.766n”,
“16          China  vault  2012      f  44.266n”,
“17          China  vault  2012      m  48.316n”,
“18          China  vault  2016      f  44.332n”,
“19          China  vault  2016      m  45.000n”,
“20          China  floor  2012      f  40.833n”,
“21          China  floor  2012      m  45.133n”,
“22          China  floor  2016      f  42.066n”,
“23          China  floor  2016      m  43.799”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;country&lt;/th&gt;n”,
”      &lt;th&gt;event&lt;/th&gt;n”,
”      &lt;th&gt;year&lt;/th&gt;n”,
”      &lt;th&gt;gender&lt;/th&gt;n”,
”      &lt;th&gt;score&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;48.132&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;46.632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;46.866&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.865&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;45.366&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.266&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;45.999&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;United States&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;43.757&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;46.366&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;46.866&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;45.733&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;46.033&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;12&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;41.599&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;13&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.308&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;14&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;42.032&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;15&lt;/th&gt;n”,
”      &lt;td&gt;Russia&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;44.766&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;16&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;44.266&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;17&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;48.316&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;18&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;44.332&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;19&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;vault&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;20&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;40.833&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;21&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2012&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;45.133&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;22&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;f&lt;/td&gt;n”,
”      &lt;td&gt;42.066&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;23&lt;/th&gt;n”,
”      &lt;td&gt;China&lt;/td&gt;n”,
”      &lt;td&gt;floor&lt;/td&gt;n”,
”      &lt;td&gt;2016&lt;/td&gt;n”,
”      &lt;td&gt;m&lt;/td&gt;n”,
”      &lt;td&gt;43.799&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 187</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“One more feature that [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) offers is to pass a list of regular expressions to <cite>names_pattern</cite>. This comes in handy when one single regex cannot encapsulate similar columns for reshaping to long form. This idea is inspired by the [melt](<a class="reference external" href="https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html">https://rdatatable.gitlab.io/data.table/reference/melt.data.table.html</a>) function in R’s [data.table](<a class="reference external" href="https://rdatatable.gitlab.io/data.table/">https://rdatatable.gitlab.io/data.table/</a>). A couple of examples should make this clear.n”,
“n”,
“[Source Data](<a class="reference external" href="https://stackoverflow.com/questions/61138600/tidy-dataset-with-pivot-longer-multiple-columns-into-two-columns">https://stackoverflow.com/questions/61138600/tidy-dataset-with-pivot-longer-multiple-columns-into-two-columns</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 188,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame(n”,
”    [{‘title’: ‘Avatar’,n”,
”  ‘actor_1’: ‘CCH_Pound…’,n”,
”  ‘actor_2’: ‘Joel_Davi…’,n”,
”  ‘actor_3’: ‘Wes_Studi’,n”,
”  ‘actor_1_FB_likes’: 1000,n”,
”  ‘actor_2_FB_likes’: 936,n”,
”  ‘actor_3_FB_likes’: 855},n”,
” {‘title’: ‘Pirates_of_the_Car…’,n”,
”  ‘actor_1’: ‘Johnny_De…’,n”,
”  ‘actor_2’: ‘Orlando_B…’,n”,
”  ‘actor_3’: ‘Jack_Daven…’,n”,
”  ‘actor_1_FB_likes’: 40000,n”,
”  ‘actor_2_FB_likes’: 5000,n”,
”  ‘actor_3_FB_likes’: 1000},n”,
” {‘title’: ‘The_Dark_Knight_Ri…’,n”,
”  ‘actor_1’: ‘Tom_Hardy’,n”,
”  ‘actor_2’: ‘Christian…’,n”,
”  ‘actor_3’: ‘Joseph_Gor…’,n”,
”  ‘actor_1_FB_likes’: 27000,n”,
”  ‘actor_2_FB_likes’: 23000,n”,
”  ‘actor_3_FB_likes’: 23000},n”,
” {‘title’: ‘John_Carter’,n”,
”  ‘actor_1’: ‘Daryl_Sab…’,n”,
”  ‘actor_2’: ‘<a href="#id13"><span class="problematic" id="id14">Samantha_</span></a>…’,n”,
”  ‘actor_3’: ‘Polly_Walk…’,n”,
”  ‘actor_1_FB_likes’: 640,n”,
”  ‘actor_2_FB_likes’: 632,n”,
”  ‘actor_3_FB_likes’: 530},n”,
” {‘title’: ‘Spider-Man_3’,n”,
”  ‘actor_1’: ‘J.K._Simm…’,n”,
”  ‘actor_2’: ‘James_Fra…’,n”,
”  ‘actor_3’: ‘Kirsten_Du…’,n”,
”  ‘actor_1_FB_likes’: 24000,n”,
”  ‘actor_2_FB_likes’: 11000,n”,
”  ‘actor_3_FB_likes’: 4000},n”,
” {‘title’: ‘Tangled’,n”,
”  ‘actor_1’: ‘Brad_Garr…’,n”,
”  ‘actor_2’: ‘Donna_Mur…’,n”,
”  ‘actor_3’: ‘M.C._Gainey’,n”,
”  ‘actor_1_FB_likes’: 799,n”,
”  ‘actor_2_FB_likes’: 553,n”,
”  ‘actor_3_FB_likes’: 284}]n”,
“)n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”                 title     actor_1     actor_2      actor_3  actor_1_FB_likes  \n”,
“0               Avatar  CCH_Pound…  Joel_Davi…    Wes_Studi              1000   n”,
“1  Pirates_of_the_Car…  Johnny_De…  Orlando_B…  Jack_Daven…             40000   n”,
“2  The_Dark_Knight_Ri…   Tom_Hardy  Christian…  Joseph_Gor…             27000   n”,
“3          John_Carter  Daryl_Sab…  <a href="#id15"><span class="problematic" id="id16">Samantha_</span></a>…  Polly_Walk…               640   n”,
“4         Spider-Man_3  J.K._Simm…  James_Fra…  Kirsten_Du…             24000   n”,
“5              Tangled  Brad_Garr…  Donna_Mur…  M.C._Gainey               799   n”,
“n”,
”   actor_2_FB_likes  actor_3_FB_likes  n”,
“0               936               855  n”,
“1              5000              1000  n”,
“2             23000             23000  n”,
“3               632               530  n”,
“4             11000              4000  n”,
“5               553               284  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;title&lt;/th&gt;n”,
”      &lt;th&gt;actor_1&lt;/th&gt;n”,
”      &lt;th&gt;actor_2&lt;/th&gt;n”,
”      &lt;th&gt;actor_3&lt;/th&gt;n”,
”      &lt;th&gt;actor_1_FB_likes&lt;/th&gt;n”,
”      &lt;th&gt;actor_2_FB_likes&lt;/th&gt;n”,
”      &lt;th&gt;actor_3_FB_likes&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;CCH_Pound…&lt;/td&gt;n”,
”      &lt;td&gt;Joel_Davi…&lt;/td&gt;n”,
”      &lt;td&gt;Wes_Studi&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”      &lt;td&gt;936&lt;/td&gt;n”,
”      &lt;td&gt;855&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;Johnny_De…&lt;/td&gt;n”,
”      &lt;td&gt;Orlando_B…&lt;/td&gt;n”,
”      &lt;td&gt;Jack_Daven…&lt;/td&gt;n”,
”      &lt;td&gt;40000&lt;/td&gt;n”,
”      &lt;td&gt;5000&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;Tom_Hardy&lt;/td&gt;n”,
”      &lt;td&gt;Christian…&lt;/td&gt;n”,
”      &lt;td&gt;Joseph_Gor…&lt;/td&gt;n”,
”      &lt;td&gt;27000&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;Daryl_Sab…&lt;/td&gt;n”,
”      &lt;td&gt;Samantha_…&lt;/td&gt;n”,
”      &lt;td&gt;Polly_Walk…&lt;/td&gt;n”,
”      &lt;td&gt;640&lt;/td&gt;n”,
”      &lt;td&gt;632&lt;/td&gt;n”,
”      &lt;td&gt;530&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;J.K._Simm…&lt;/td&gt;n”,
”      &lt;td&gt;James_Fra…&lt;/td&gt;n”,
”      &lt;td&gt;Kirsten_Du…&lt;/td&gt;n”,
”      &lt;td&gt;24000&lt;/td&gt;n”,
”      &lt;td&gt;11000&lt;/td&gt;n”,
”      &lt;td&gt;4000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;Brad_Garr…&lt;/td&gt;n”,
”      &lt;td&gt;Donna_Mur…&lt;/td&gt;n”,
”      &lt;td&gt;M.C._Gainey&lt;/td&gt;n”,
”      &lt;td&gt;799&lt;/td&gt;n”,
”      &lt;td&gt;553&lt;/td&gt;n”,
”      &lt;td&gt;284&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 188</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Above, we have a dataframe of movie titles, actors, and their facebook likes. It would be great if we could transform this into a long form, with just the title, the actor names, and the number of likes. Let’s look at a possible solution : n”,
“n”,
“First, we reshape the columns, so that the numbers appear at the end.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 189,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.copy()n”,
“pat = r&quot;(?P&lt;actor&gt;.+)_(?P&lt;num&gt;\d)_(?P&lt;likes&gt;.+)&quot;n”,
“repl = lambda m: f&quot;&quot;&quot;{m.group(‘actor’)}_{m.group(‘likes’)}_{m.group(‘num’)}&quot;&quot;&quot;n”,
“df1.columns = df1.columns.str.replace(pat, repl, regex=True)n”,
“df1”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”                 title     actor_1     actor_2      actor_3  actor_FB_likes_1  \n”,
“0               Avatar  CCH_Pound…  Joel_Davi…    Wes_Studi              1000   n”,
“1  Pirates_of_the_Car…  Johnny_De…  Orlando_B…  Jack_Daven…             40000   n”,
“2  The_Dark_Knight_Ri…   Tom_Hardy  Christian…  Joseph_Gor…             27000   n”,
“3          John_Carter  Daryl_Sab…  <a href="#id17"><span class="problematic" id="id18">Samantha_</span></a>…  Polly_Walk…               640   n”,
“4         Spider-Man_3  J.K._Simm…  James_Fra…  Kirsten_Du…             24000   n”,
“5              Tangled  Brad_Garr…  Donna_Mur…  M.C._Gainey               799   n”,
“n”,
”   actor_FB_likes_2  actor_FB_likes_3  n”,
“0               936               855  n”,
“1              5000              1000  n”,
“2             23000             23000  n”,
“3               632               530  n”,
“4             11000              4000  n”,
“5               553               284  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;title&lt;/th&gt;n”,
”      &lt;th&gt;actor_1&lt;/th&gt;n”,
”      &lt;th&gt;actor_2&lt;/th&gt;n”,
”      &lt;th&gt;actor_3&lt;/th&gt;n”,
”      &lt;th&gt;actor_FB_likes_1&lt;/th&gt;n”,
”      &lt;th&gt;actor_FB_likes_2&lt;/th&gt;n”,
”      &lt;th&gt;actor_FB_likes_3&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;CCH_Pound…&lt;/td&gt;n”,
”      &lt;td&gt;Joel_Davi…&lt;/td&gt;n”,
”      &lt;td&gt;Wes_Studi&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”      &lt;td&gt;936&lt;/td&gt;n”,
”      &lt;td&gt;855&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;Johnny_De…&lt;/td&gt;n”,
”      &lt;td&gt;Orlando_B…&lt;/td&gt;n”,
”      &lt;td&gt;Jack_Daven…&lt;/td&gt;n”,
”      &lt;td&gt;40000&lt;/td&gt;n”,
”      &lt;td&gt;5000&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;Tom_Hardy&lt;/td&gt;n”,
”      &lt;td&gt;Christian…&lt;/td&gt;n”,
”      &lt;td&gt;Joseph_Gor…&lt;/td&gt;n”,
”      &lt;td&gt;27000&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;Daryl_Sab…&lt;/td&gt;n”,
”      &lt;td&gt;Samantha_…&lt;/td&gt;n”,
”      &lt;td&gt;Polly_Walk…&lt;/td&gt;n”,
”      &lt;td&gt;640&lt;/td&gt;n”,
”      &lt;td&gt;632&lt;/td&gt;n”,
”      &lt;td&gt;530&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;J.K._Simm…&lt;/td&gt;n”,
”      &lt;td&gt;James_Fra…&lt;/td&gt;n”,
”      &lt;td&gt;Kirsten_Du…&lt;/td&gt;n”,
”      &lt;td&gt;24000&lt;/td&gt;n”,
”      &lt;td&gt;11000&lt;/td&gt;n”,
”      &lt;td&gt;4000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;Brad_Garr…&lt;/td&gt;n”,
”      &lt;td&gt;Donna_Mur…&lt;/td&gt;n”,
”      &lt;td&gt;M.C._Gainey&lt;/td&gt;n”,
”      &lt;td&gt;799&lt;/td&gt;n”,
”      &lt;td&gt;553&lt;/td&gt;n”,
”      &lt;td&gt;284&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 189</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Now, we can reshape, using [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) :”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 190,
“source”: [</p>
<blockquote>
<div><p>“pd.wide_to_long(df1, n”,
”               stubnames = [‘actor’, ‘actor_FB_likes’], n”,
”               i = ‘title’, n”,
”               j = ‘group’, n”,
”               sep = ‘_’)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”                                 actor  actor_FB_likesn”,
“title               group                             n”,
“Avatar              1       CCH_Pound…            1000n”,
“Pirates_of_the_Car… 1       Johnny_De…           40000n”,
“The_Dark_Knight_Ri… 1        Tom_Hardy           27000n”,
“John_Carter         1       Daryl_Sab…             640n”,
“Spider-Man_3        1       J.K._Simm…           24000n”,
“Tangled             1       Brad_Garr…             799n”,
“Avatar              2       Joel_Davi…             936n”,
“Pirates_of_the_Car… 2       Orlando_B…            5000n”,
“The_Dark_Knight_Ri… 2       Christian…           23000n”,
“John_Carter         2       <a href="#id19"><span class="problematic" id="id20">Samantha_</span></a>…             632n”,
“Spider-Man_3        2       James_Fra…           11000n”,
“Tangled             2       Donna_Mur…             553n”,
“Avatar              3        Wes_Studi             855n”,
“Pirates_of_the_Car… 3      Jack_Daven…            1000n”,
“The_Dark_Knight_Ri… 3      Joseph_Gor…           23000n”,
“John_Carter         3      Polly_Walk…             530n”,
“Spider-Man_3        3      Kirsten_Du…            4000n”,
“Tangled             3      M.C._Gainey             284”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;actor&lt;/th&gt;n”,
”      &lt;th&gt;actor_FB_likes&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;title&lt;/th&gt;n”,
”      &lt;th&gt;group&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Avatar&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;CCH_Pound…&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Pirates_of_the_Car…&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Johnny_De…&lt;/td&gt;n”,
”      &lt;td&gt;40000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;The_Dark_Knight_Ri…&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Tom_Hardy&lt;/td&gt;n”,
”      &lt;td&gt;27000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;John_Carter&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Daryl_Sab…&lt;/td&gt;n”,
”      &lt;td&gt;640&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Spider-Man_3&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;J.K._Simm…&lt;/td&gt;n”,
”      &lt;td&gt;24000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Tangled&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Brad_Garr…&lt;/td&gt;n”,
”      &lt;td&gt;799&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Avatar&lt;/th&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Joel_Davi…&lt;/td&gt;n”,
”      &lt;td&gt;936&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Pirates_of_the_Car…&lt;/th&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Orlando_B…&lt;/td&gt;n”,
”      &lt;td&gt;5000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;The_Dark_Knight_Ri…&lt;/th&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Christian…&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;John_Carter&lt;/th&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Samantha_…&lt;/td&gt;n”,
”      &lt;td&gt;632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Spider-Man_3&lt;/th&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;James_Fra…&lt;/td&gt;n”,
”      &lt;td&gt;11000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Tangled&lt;/th&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Donna_Mur…&lt;/td&gt;n”,
”      &lt;td&gt;553&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Avatar&lt;/th&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Wes_Studi&lt;/td&gt;n”,
”      &lt;td&gt;855&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Pirates_of_the_Car…&lt;/th&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Jack_Daven…&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;The_Dark_Knight_Ri…&lt;/th&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Joseph_Gor…&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;John_Carter&lt;/th&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Polly_Walk…&lt;/td&gt;n”,
”      &lt;td&gt;530&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Spider-Man_3&lt;/th&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Kirsten_Du…&lt;/td&gt;n”,
”      &lt;td&gt;4000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;Tangled&lt;/th&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;M.C._Gainey&lt;/td&gt;n”,
”      &lt;td&gt;284&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 190</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We could attempt to solve it with [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>), using the <cite>.value</cite> symbol : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 191,
“source”: [</p>
<blockquote>
<div><p>“df1.pivot_longer(n”,
”    index = ‘title’, n”,
”    names_to = (&quot;.value&quot;, &quot;group&quot;), n”,
”    names_pattern = &quot;(.+)_(\d)$&quot;n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”                  title group        actor  actor_FB_likesn”,
“0                Avatar     1   CCH_Pound…            1000n”,
“1   Pirates_of_the_Car…     1   Johnny_De…           40000n”,
“2   The_Dark_Knight_Ri…     1    Tom_Hardy           27000n”,
“3           John_Carter     1   Daryl_Sab…             640n”,
“4          Spider-Man_3     1   J.K._Simm…           24000n”,
“5               Tangled     1   Brad_Garr…             799n”,
“6                Avatar     2   Joel_Davi…             936n”,
“7   Pirates_of_the_Car…     2   Orlando_B…            5000n”,
“8   The_Dark_Knight_Ri…     2   Christian…           23000n”,
“9           John_Carter     2   <a href="#id21"><span class="problematic" id="id22">Samantha_</span></a>…             632n”,
“10         Spider-Man_3     2   James_Fra…           11000n”,
“11              Tangled     2   Donna_Mur…             553n”,
“12               Avatar     3    Wes_Studi             855n”,
“13  Pirates_of_the_Car…     3  Jack_Daven…            1000n”,
“14  The_Dark_Knight_Ri…     3  Joseph_Gor…           23000n”,
“15          John_Carter     3  Polly_Walk…             530n”,
“16         Spider-Man_3     3  Kirsten_Du…            4000n”,
“17              Tangled     3  M.C._Gainey             284”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;title&lt;/th&gt;n”,
”      &lt;th&gt;group&lt;/th&gt;n”,
”      &lt;th&gt;actor&lt;/th&gt;n”,
”      &lt;th&gt;actor_FB_likes&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;CCH_Pound…&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;Johnny_De…&lt;/td&gt;n”,
”      &lt;td&gt;40000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;Tom_Hardy&lt;/td&gt;n”,
”      &lt;td&gt;27000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;Daryl_Sab…&lt;/td&gt;n”,
”      &lt;td&gt;640&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;J.K._Simm…&lt;/td&gt;n”,
”      &lt;td&gt;24000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;Brad_Garr…&lt;/td&gt;n”,
”      &lt;td&gt;799&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;Joel_Davi…&lt;/td&gt;n”,
”      &lt;td&gt;936&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;Orlando_B…&lt;/td&gt;n”,
”      &lt;td&gt;5000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;Christian…&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;Samantha_…&lt;/td&gt;n”,
”      &lt;td&gt;632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;James_Fra…&lt;/td&gt;n”,
”      &lt;td&gt;11000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;Donna_Mur…&lt;/td&gt;n”,
”      &lt;td&gt;553&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;12&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;Wes_Studi&lt;/td&gt;n”,
”      &lt;td&gt;855&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;13&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;Jack_Daven…&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;14&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;Joseph_Gor…&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;15&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;Polly_Walk…&lt;/td&gt;n”,
”      &lt;td&gt;530&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;16&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;Kirsten_Du…&lt;/td&gt;n”,
”      &lt;td&gt;4000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;17&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;M.C._Gainey&lt;/td&gt;n”,
”      &lt;td&gt;284&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 191</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“What if we could just get our data in long form without the massaging? We know our data has a pattern to it –&gt; it either ends in a number or <em>likes</em>.  Can’t we take advantage of that? Yes, we can (I know, I know; it sounds like a campaign slogan 🤪)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 192,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = ‘title’,n”,
”    names_to = (&quot;actor&quot;, &quot;num_likes&quot;),n”,
”    names_pattern = (’\d$’, ‘likes$’),n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”                  title        actor  num_likesn”,
“0                Avatar   CCH_Pound…       1000n”,
“1   Pirates_of_the_Car…   Johnny_De…      40000n”,
“2   The_Dark_Knight_Ri…    Tom_Hardy      27000n”,
“3           John_Carter   Daryl_Sab…        640n”,
“4          Spider-Man_3   J.K._Simm…      24000n”,
“5               Tangled   Brad_Garr…        799n”,
“6                Avatar   Joel_Davi…        936n”,
“7   Pirates_of_the_Car…   Orlando_B…       5000n”,
“8   The_Dark_Knight_Ri…   Christian…      23000n”,
“9           John_Carter   <a href="#id23"><span class="problematic" id="id24">Samantha_</span></a>…        632n”,
“10         Spider-Man_3   James_Fra…      11000n”,
“11              Tangled   Donna_Mur…        553n”,
“12               Avatar    Wes_Studi        855n”,
“13  Pirates_of_the_Car…  Jack_Daven…       1000n”,
“14  The_Dark_Knight_Ri…  Joseph_Gor…      23000n”,
“15          John_Carter  Polly_Walk…        530n”,
“16         Spider-Man_3  Kirsten_Du…       4000n”,
“17              Tangled  M.C._Gainey        284”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;title&lt;/th&gt;n”,
”      &lt;th&gt;actor&lt;/th&gt;n”,
”      &lt;th&gt;num_likes&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;CCH_Pound…&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;Johnny_De…&lt;/td&gt;n”,
”      &lt;td&gt;40000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;Tom_Hardy&lt;/td&gt;n”,
”      &lt;td&gt;27000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;Daryl_Sab…&lt;/td&gt;n”,
”      &lt;td&gt;640&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;J.K._Simm…&lt;/td&gt;n”,
”      &lt;td&gt;24000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;Brad_Garr…&lt;/td&gt;n”,
”      &lt;td&gt;799&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;Joel_Davi…&lt;/td&gt;n”,
”      &lt;td&gt;936&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;Orlando_B…&lt;/td&gt;n”,
”      &lt;td&gt;5000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;8&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;Christian…&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;9&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;Samantha_…&lt;/td&gt;n”,
”      &lt;td&gt;632&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;10&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;James_Fra…&lt;/td&gt;n”,
”      &lt;td&gt;11000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;11&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;Donna_Mur…&lt;/td&gt;n”,
”      &lt;td&gt;553&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;12&lt;/th&gt;n”,
”      &lt;td&gt;Avatar&lt;/td&gt;n”,
”      &lt;td&gt;Wes_Studi&lt;/td&gt;n”,
”      &lt;td&gt;855&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;13&lt;/th&gt;n”,
”      &lt;td&gt;Pirates_of_the_Car…&lt;/td&gt;n”,
”      &lt;td&gt;Jack_Daven…&lt;/td&gt;n”,
”      &lt;td&gt;1000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;14&lt;/th&gt;n”,
”      &lt;td&gt;The_Dark_Knight_Ri…&lt;/td&gt;n”,
”      &lt;td&gt;Joseph_Gor…&lt;/td&gt;n”,
”      &lt;td&gt;23000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;15&lt;/th&gt;n”,
”      &lt;td&gt;John_Carter&lt;/td&gt;n”,
”      &lt;td&gt;Polly_Walk…&lt;/td&gt;n”,
”      &lt;td&gt;530&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;16&lt;/th&gt;n”,
”      &lt;td&gt;Spider-Man_3&lt;/td&gt;n”,
”      &lt;td&gt;Kirsten_Du…&lt;/td&gt;n”,
”      &lt;td&gt;4000&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;17&lt;/th&gt;n”,
”      &lt;td&gt;Tangled&lt;/td&gt;n”,
”      &lt;td&gt;M.C._Gainey&lt;/td&gt;n”,
”      &lt;td&gt;284&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 192</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“A pairing of <cite>names_to</cite> and <cite>names_pattern</cite> results in:n”,
“n”,
”    {&quot;actor&quot;: ‘\d$’, &quot;num_likes&quot;: ‘likes$’}n”,
”                                   n”,
“The first regex looks for columns that end with a number, while the other looks for columns that end with <em>likes</em>. [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) will then look for columns that end with a number and lump all the values in those columns under the <cite>actor</cite> column, and also look for columns that end with <em>like</em> and combine all the values in those columns into a new column -&gt; <cite>num_likes</cite>. Underneath the hood, [numpy select](<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.select.html">https://numpy.org/doc/stable/reference/generated/numpy.select.html</a>) and [pd.Series.str.contains](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.contains.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.str.contains.html</a>) are used to pull apart the columns into the new columns. n”,
“n”,
“Again, it is about the goal; we are not interested in the numbers (1,2,3), we only need the names of the actors, and their facebook likes. [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) aims to give as much flexibility as possible, in addition to ease of use, to allow the end user focus on the task. n”,
“n”,
“Let’s take a look at another example. [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/60439749/pair-wise-melt-in-pandas-dataframe">https://stackoverflow.com/questions/60439749/pair-wise-melt-in-pandas-dataframe</a>) :”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 193,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘id’: [0, 1],n”,
” ‘Name’: [‘ABC’, ‘XYZ’],n”,
” ‘code’: [1, 2],n”,
” ‘code1’: [4, np.nan],n”,
” ‘code2’: [‘8’, 5],n”,
” ‘type’: [‘S’, ‘R’],n”,
” ‘type1’: [‘E’, np.nan],n”,
” ‘type2’: [‘T’, ‘U’]})n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id Name  code  code1 code2 type type1 type2n”,
“0   0  ABC     1    4.0     8    S     E     Tn”,
“1   1  XYZ     2    NaN     5    R   NaN     U”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;Name&lt;/th&gt;n”,
”      &lt;th&gt;code&lt;/th&gt;n”,
”      &lt;th&gt;code1&lt;/th&gt;n”,
”      &lt;th&gt;code2&lt;/th&gt;n”,
”      &lt;th&gt;type&lt;/th&gt;n”,
”      &lt;th&gt;type1&lt;/th&gt;n”,
”      &lt;th&gt;type2&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;4.0&lt;/td&gt;n”,
”      &lt;td&gt;8&lt;/td&gt;n”,
”      &lt;td&gt;S&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”      &lt;td&gt;T&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;XYZ&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;R&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;U&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 193</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“We cannot directly use [pd.wide_to_long](<a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html">https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.wide_to_long.html</a>) here without some massaging, as there is no definite suffix(the first <cite>code</cite> does not have a suffix), neither can we use <cite>.value</cite> here, again because there is no suffix. However, we can see a pattern where some columns start with <cite>code</cite>, and others start with <cite>type</cite>. Let’s see how [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) solves this, using a sequence of regular expressions in the <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code> argument : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 194,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = [&quot;id&quot;, &quot;Name&quot;],n”,
”    names_to = (&quot;code_all&quot;, &quot;type_all&quot;), n”,
”    names_pattern = (&quot;^code&quot;, &quot;^type&quot;)n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   id Name code_all type_alln”,
“0   0  ABC        1        Sn”,
“1   1  XYZ        2        Rn”,
“2   0  ABC      4.0        En”,
“3   1  XYZ      NaN      NaNn”,
“4   0  ABC        8        Tn”,
“5   1  XYZ        5        U”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;id&lt;/th&gt;n”,
”      &lt;th&gt;Name&lt;/th&gt;n”,
”      &lt;th&gt;code_all&lt;/th&gt;n”,
”      &lt;th&gt;type_all&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;S&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;XYZ&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;R&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;4.0&lt;/td&gt;n”,
”      &lt;td&gt;E&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;XYZ&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;0&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;8&lt;/td&gt;n”,
”      &lt;td&gt;T&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;XYZ&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;U&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 194</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The key here is passing the right regular expression, and ensuring the names in <cite>names_to</cite> is paired with the right regex in <cite>names_pattern</cite>; as such, every column that starts with <cite>code</cite> will be included in the new <cite>code_all</cite> column; the same happens to the <cite>type_all</cite> column. Easy and flexible, right? n”,
“n”,
“Let’s explore another example, from [Stack Overflow](<a class="reference external" href="https://stackoverflow.com/questions/12466493/reshaping-multiple-sets-of-measurement-columns-wide-format-into-single-columns">https://stackoverflow.com/questions/12466493/reshaping-multiple-sets-of-measurement-columns-wide-format-into-single-columns</a>) :”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 195,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame(n”,
”            [n”,
”                {n”,
”                    &quot;ID&quot;: 1,n”,
”                    &quot;DateRange1Start&quot;: &quot;1/1/90&quot;,n”,
”                    &quot;DateRange1End&quot;: &quot;3/1/90&quot;,n”,
”                    &quot;Value1&quot;: 4.4,n”,
”                    &quot;DateRange2Start&quot;: &quot;4/5/91&quot;,n”,
”                    &quot;DateRange2End&quot;: &quot;6/7/91&quot;,n”,
”                    &quot;Value2&quot;: 6.2,n”,
”                    &quot;DateRange3Start&quot;: &quot;5/5/95&quot;,n”,
”                    &quot;DateRange3End&quot;: &quot;6/6/96&quot;,n”,
”                    &quot;Value3&quot;: 3.3,n”,
”                }n”,
”            ])n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   ID DateRange1Start DateRange1End  Value1 DateRange2Start DateRange2End  \n”,
“0   1          1/1/90        3/1/90     4.4          4/5/91        6/7/91   n”,
“n”,
”   Value2 DateRange3Start DateRange3End  Value3  n”,
“0     6.2          5/5/95        6/6/96     3.3  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;ID&lt;/th&gt;n”,
”      &lt;th&gt;DateRange1Start&lt;/th&gt;n”,
”      &lt;th&gt;DateRange1End&lt;/th&gt;n”,
”      &lt;th&gt;Value1&lt;/th&gt;n”,
”      &lt;th&gt;DateRange2Start&lt;/th&gt;n”,
”      &lt;th&gt;DateRange2End&lt;/th&gt;n”,
”      &lt;th&gt;Value2&lt;/th&gt;n”,
”      &lt;th&gt;DateRange3Start&lt;/th&gt;n”,
”      &lt;th&gt;DateRange3End&lt;/th&gt;n”,
”      &lt;th&gt;Value3&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1/1/90&lt;/td&gt;n”,
”      &lt;td&gt;3/1/90&lt;/td&gt;n”,
”      &lt;td&gt;4.4&lt;/td&gt;n”,
”      &lt;td&gt;4/5/91&lt;/td&gt;n”,
”      &lt;td&gt;6/7/91&lt;/td&gt;n”,
”      &lt;td&gt;6.2&lt;/td&gt;n”,
”      &lt;td&gt;5/5/95&lt;/td&gt;n”,
”      &lt;td&gt;6/6/96&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 195</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“In the dataframe above, we need to reshape the data to have a start date, end date and value. For the <cite>DateRange</cite> columns, the numbers are embedded within the string, while for <cite>value</cite> it is appended at the end. One possible solution is to reshape the columns so that the numbers are at the end :”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 196,
“source”: [</p>
<blockquote>
<div><p>“df1 = df.copy()n”,
“pat = r&quot;(?P&lt;head&gt;.+)(?P&lt;num&gt;\d)(?P&lt;tail&gt;.+)&quot;n”,
“repl = lambda m: f&quot;&quot;&quot;{m.group(‘head’)}{m.group(‘tail’)}{m.group(‘num’)}&quot;&quot;&quot;n”,
“df1.columns = df1.columns.str.replace(pat, repl, regex=True)n”,
“df1”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   ID DateRangeStart1 DateRangeEnd1  Value1 DateRangeStart2 DateRangeEnd2  \n”,
“0   1          1/1/90        3/1/90     4.4          4/5/91        6/7/91   n”,
“n”,
”   Value2 DateRangeStart3 DateRangeEnd3  Value3  n”,
“0     6.2          5/5/95        6/6/96     3.3  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;ID&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeStart1&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeEnd1&lt;/th&gt;n”,
”      &lt;th&gt;Value1&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeStart2&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeEnd2&lt;/th&gt;n”,
”      &lt;th&gt;Value2&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeStart3&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeEnd3&lt;/th&gt;n”,
”      &lt;th&gt;Value3&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1/1/90&lt;/td&gt;n”,
”      &lt;td&gt;3/1/90&lt;/td&gt;n”,
”      &lt;td&gt;4.4&lt;/td&gt;n”,
”      &lt;td&gt;4/5/91&lt;/td&gt;n”,
”      &lt;td&gt;6/7/91&lt;/td&gt;n”,
”      &lt;td&gt;6.2&lt;/td&gt;n”,
”      &lt;td&gt;5/5/95&lt;/td&gt;n”,
”      &lt;td&gt;6/6/96&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 196</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Now, we can unpivot:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 197,
“source”: [</p>
<blockquote>
<div><p>“pd.wide_to_long(df1, n”,
”                stubnames = [‘DateRangeStart’, n”,
”                             ‘DateRangeEnd’, n”,
”                             ‘Value’],n”,
”                i = ‘ID’, n”,
”                j = ‘num’)”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”       DateRangeStart DateRangeEnd  Valuen”,
“ID num                                   n”,
“1  1           1/1/90       3/1/90    4.4n”,
”   2           4/5/91       6/7/91    6.2n”,
”   3           5/5/95       6/6/96    3.3”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeStart&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeEnd&lt;/th&gt;n”,
”      &lt;th&gt;Value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;ID&lt;/th&gt;n”,
”      &lt;th&gt;num&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th rowspan=&quot;3&quot; valign=&quot;top&quot;&gt;1&lt;/th&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1/1/90&lt;/td&gt;n”,
”      &lt;td&gt;3/1/90&lt;/td&gt;n”,
”      &lt;td&gt;4.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;4/5/91&lt;/td&gt;n”,
”      &lt;td&gt;6/7/91&lt;/td&gt;n”,
”      &lt;td&gt;6.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;5/5/95&lt;/td&gt;n”,
”      &lt;td&gt;6/6/96&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 197</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Using the <cite>.value</cite> symbol in pivot_longer:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 198,
“source”: [</p>
<blockquote>
<div><p>“df1.pivot_longer(n”,
”    index = ‘ID’, n”,
”    names_to = [&quot;.value&quot;,’num’], n”,
”    names_pattern = &quot;(.+)(\d)$&quot;n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   ID num DateRangeStart DateRangeEnd  Valuen”,
“0   1   1         1/1/90       3/1/90    4.4n”,
“1   1   2         4/5/91       6/7/91    6.2n”,
“2   1   3         5/5/95       6/6/96    3.3”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;ID&lt;/th&gt;n”,
”      &lt;th&gt;num&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeStart&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeEnd&lt;/th&gt;n”,
”      &lt;th&gt;Value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1/1/90&lt;/td&gt;n”,
”      &lt;td&gt;3/1/90&lt;/td&gt;n”,
”      &lt;td&gt;4.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;4/5/91&lt;/td&gt;n”,
”      &lt;td&gt;6/7/91&lt;/td&gt;n”,
”      &lt;td&gt;6.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;3&lt;/td&gt;n”,
”      &lt;td&gt;5/5/95&lt;/td&gt;n”,
”      &lt;td&gt;6/6/96&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 198</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Or, we could allow pivot_longer worry about the massaging; simply pass to <cite>names_pattern</cite> a list of regular expressions that match what we are after : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 199,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = ‘ID’, n”,
”    names_to = (&quot;DateRangeStart&quot;, &quot;DateRangeEnd&quot;, &quot;Value&quot;), n”,
”    names_pattern = (&quot;Start$&quot;, &quot;End$&quot;, &quot;^Value&quot;)n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”   ID DateRangeStart DateRangeEnd  Valuen”,
“0   1         1/1/90       3/1/90    4.4n”,
“1   1         4/5/91       6/7/91    6.2n”,
“2   1         5/5/95       6/6/96    3.3”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;ID&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeStart&lt;/th&gt;n”,
”      &lt;th&gt;DateRangeEnd&lt;/th&gt;n”,
”      &lt;th&gt;Value&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;1/1/90&lt;/td&gt;n”,
”      &lt;td&gt;3/1/90&lt;/td&gt;n”,
”      &lt;td&gt;4.4&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;4/5/91&lt;/td&gt;n”,
”      &lt;td&gt;6/7/91&lt;/td&gt;n”,
”      &lt;td&gt;6.2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;5/5/95&lt;/td&gt;n”,
”      &lt;td&gt;6/6/96&lt;/td&gt;n”,
”      &lt;td&gt;3.3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 199</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The code above looks for columns that end with <a href="#id7"><span class="problematic" id="id8">*</span></a>Start*(<cite>Start$</cite>), aggregates all the values in those columns into <cite>DateRangeStart</cite> column, looks for columns that end with <a href="#id9"><span class="problematic" id="id10">*</span></a>End*(<cite>End$</cite>), aggregates all the values within those columns into <cite>DateRangeEnd</cite> column, and finally looks for columns that start with <a href="#id11"><span class="problematic" id="id12">*</span></a>Value*(<cite>^Value</cite>), and aggregates the values in those columns into the <cite>Value</cite> column. Just know the patterns, and pair them accordingly. Again, the goal is a focus on the task, to make it simple for the end user.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Let’s look at another example [Source Data](<a class="reference external" href="https://stackoverflow.com/questions/64316129/how-to-efficiently-melt-multiple-columns-using-the-module-melt-in-pandas/64316306#64316306">https://stackoverflow.com/questions/64316129/how-to-efficiently-melt-multiple-columns-using-the-module-melt-in-pandas/64316306#64316306</a>) :”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 200,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘Activity’: [‘P1’, ‘P2’],n”,
” ‘General’: [‘AA’, ‘BB’],n”,
” ‘m1’: [‘A1’, ‘B1’],n”,
” ‘t1’: [‘TA1’, ‘TB1’],n”,
” ‘m2’: [‘A2’, ‘B2’],n”,
” ‘t2’: [‘TA2’, ‘TB2’],n”,
” ‘m3’: [‘A3’, ‘B3’],n”,
” ‘t3’: [‘TA3’, ‘TB3’]})n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Activity General  m1   t1  m2   t2  m3   t3n”,
“0       P1      AA  A1  TA1  A2  TA2  A3  TA3n”,
“1       P2      BB  B1  TB1  B2  TB2  B3  TB3”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Activity&lt;/th&gt;n”,
”      &lt;th&gt;General&lt;/th&gt;n”,
”      &lt;th&gt;m1&lt;/th&gt;n”,
”      &lt;th&gt;t1&lt;/th&gt;n”,
”      &lt;th&gt;m2&lt;/th&gt;n”,
”      &lt;th&gt;t2&lt;/th&gt;n”,
”      &lt;th&gt;m3&lt;/th&gt;n”,
”      &lt;th&gt;t3&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;A1&lt;/td&gt;n”,
”      &lt;td&gt;TA1&lt;/td&gt;n”,
”      &lt;td&gt;A2&lt;/td&gt;n”,
”      &lt;td&gt;TA2&lt;/td&gt;n”,
”      &lt;td&gt;A3&lt;/td&gt;n”,
”      &lt;td&gt;TA3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;B1&lt;/td&gt;n”,
”      &lt;td&gt;TB1&lt;/td&gt;n”,
”      &lt;td&gt;B2&lt;/td&gt;n”,
”      &lt;td&gt;TB2&lt;/td&gt;n”,
”      &lt;td&gt;B3&lt;/td&gt;n”,
”      &lt;td&gt;TB3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 200</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“This is a [solution](<a class="reference external" href="https://stackoverflow.com/a/64316306/7175713">https://stackoverflow.com/a/64316306/7175713</a>) provided by yours truly : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 201,
“source”: [</p>
<blockquote>
<div><p>” (pd.wide_to_long(df, n”,
”                  i = [&quot;Activity&quot;, &quot;General&quot;], n”,
”                  stubnames = [&quot;t&quot;, &quot;m&quot;], n”,
”                  j = &quot;number&quot;)n”,
”    .set_axis([&quot;Task&quot;, &quot;M&quot;], n”,
”              axis = &quot;columns&quot;)n”,
”    .droplevel(-1)n”,
”    .reset_index()n”,
”     )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Activity General Task   Mn”,
“0       P1      AA  TA1  A1n”,
“1       P1      AA  TA2  A2n”,
“2       P1      AA  TA3  A3n”,
“3       P2      BB  TB1  B1n”,
“4       P2      BB  TB2  B2n”,
“5       P2      BB  TB3  B3”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Activity&lt;/th&gt;n”,
”      &lt;th&gt;General&lt;/th&gt;n”,
”      &lt;th&gt;Task&lt;/th&gt;n”,
”      &lt;th&gt;M&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;TA1&lt;/td&gt;n”,
”      &lt;td&gt;A1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;TA2&lt;/td&gt;n”,
”      &lt;td&gt;A2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;TA3&lt;/td&gt;n”,
”      &lt;td&gt;A3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;TB1&lt;/td&gt;n”,
”      &lt;td&gt;B1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;TB2&lt;/td&gt;n”,
”      &lt;td&gt;B2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;TB3&lt;/td&gt;n”,
”      &lt;td&gt;B3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 201</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Or, we could use [pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>), abstract the details, and focus on the task : “</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 202,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = [‘Activity’,’General’], n”,
”    names_pattern = [‘^m’,’^t’],n”,
”    names_to = [‘M’,’Task’]n”,
”    )”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Activity General   M Taskn”,
“0       P1      AA  A1  TA1n”,
“1       P2      BB  B1  TB1n”,
“2       P1      AA  A2  TA2n”,
“3       P2      BB  B2  TB2n”,
“4       P1      AA  A3  TA3n”,
“5       P2      BB  B3  TB3”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Activity&lt;/th&gt;n”,
”      &lt;th&gt;General&lt;/th&gt;n”,
”      &lt;th&gt;M&lt;/th&gt;n”,
”      &lt;th&gt;Task&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;A1&lt;/td&gt;n”,
”      &lt;td&gt;TA1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;B1&lt;/td&gt;n”,
”      &lt;td&gt;TB1&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;A2&lt;/td&gt;n”,
”      &lt;td&gt;TA2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;B2&lt;/td&gt;n”,
”      &lt;td&gt;TB2&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;P1&lt;/td&gt;n”,
”      &lt;td&gt;AA&lt;/td&gt;n”,
”      &lt;td&gt;A3&lt;/td&gt;n”,
”      &lt;td&gt;TA3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;P2&lt;/td&gt;n”,
”      &lt;td&gt;BB&lt;/td&gt;n”,
”      &lt;td&gt;B3&lt;/td&gt;n”,
”      &lt;td&gt;TB3&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 202</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Alright, one last example : n”,
“n”,
“n”,
“[Source Data](<a class="reference external" href="https://stackoverflow.com/questions/64159054/how-do-you-pivot-longer-columns-in-groups">https://stackoverflow.com/questions/64159054/how-do-you-pivot-longer-columns-in-groups</a>)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 203,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘Name’: [‘John’, ‘Chris’, ‘Alex’],n”,
” ‘activity1’: [‘Birthday’, ‘Sleep Over’, ‘Track Race’],n”,
” ‘number_activity_1’: [1, 2, 4],n”,
” ‘attendees1’: [14, 18, 100],n”,
” ‘activity2’: [‘Sleep Over’, ‘Painting’, ‘Birthday’],n”,
” ‘number_activity_2’: [4, 5, 1],n”,
” ‘attendees2’: [10, 8, 5]})n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    Name   activity1  number_activity_1  attendees1   activity2  \n”,
“0   John    Birthday                  1          14  Sleep Over   n”,
“1  Chris  Sleep Over                  2          18    Painting   n”,
“2   Alex  Track Race                  4         100    Birthday   n”,
“n”,
”   number_activity_2  attendees2  n”,
“0                  4          10  n”,
“1                  5           8  n”,
“2                  1           5  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Name&lt;/th&gt;n”,
”      &lt;th&gt;activity1&lt;/th&gt;n”,
”      &lt;th&gt;number_activity_1&lt;/th&gt;n”,
”      &lt;th&gt;attendees1&lt;/th&gt;n”,
”      &lt;th&gt;activity2&lt;/th&gt;n”,
”      &lt;th&gt;number_activity_2&lt;/th&gt;n”,
”      &lt;th&gt;attendees2&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Birthday&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;14&lt;/td&gt;n”,
”      &lt;td&gt;Sleep Over&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Chris&lt;/td&gt;n”,
”      &lt;td&gt;Sleep Over&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;18&lt;/td&gt;n”,
”      &lt;td&gt;Painting&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Alex&lt;/td&gt;n”,
”      &lt;td&gt;Track Race&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;100&lt;/td&gt;n”,
”      &lt;td&gt;Birthday&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 203</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“The task here is to unpivot the data, and group the data under three new columns (&quot;activity&quot;, &quot;number_activity&quot;, and &quot;attendees&quot;). n”,
“n”,
“We can see that there is a pattern to the data; let’s create a list of regular expressions that match the patterns and pass to <code class="docutils literal notranslate"><span class="pre">names_pattern</span></code>:”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 204,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(n”,
”    index = ‘Name’,n”,
”    names_to = (‘activity’,’number_activity’,’attendees’), n”,
”    names_pattern = (&quot;^activity&quot;,&quot;^number_activity&quot;,&quot;^attendees&quot;)n”,
”    )n”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”    Name    activity  number_activity  attendeesn”,
“0   John    Birthday                1         14n”,
“1  Chris  Sleep Over                2         18n”,
“2   Alex  Track Race                4        100n”,
“3   John  Sleep Over                4         10n”,
“4  Chris    Painting                5          8n”,
“5   Alex    Birthday                1          5”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Name&lt;/th&gt;n”,
”      &lt;th&gt;activity&lt;/th&gt;n”,
”      &lt;th&gt;number_activity&lt;/th&gt;n”,
”      &lt;th&gt;attendees&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Birthday&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;14&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Chris&lt;/td&gt;n”,
”      &lt;td&gt;Sleep Over&lt;/td&gt;n”,
”      &lt;td&gt;2&lt;/td&gt;n”,
”      &lt;td&gt;18&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Alex&lt;/td&gt;n”,
”      &lt;td&gt;Track Race&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;100&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;John&lt;/td&gt;n”,
”      &lt;td&gt;Sleep Over&lt;/td&gt;n”,
”      &lt;td&gt;4&lt;/td&gt;n”,
”      &lt;td&gt;10&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Chris&lt;/td&gt;n”,
”      &lt;td&gt;Painting&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”      &lt;td&gt;8&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Alex&lt;/td&gt;n”,
”      &lt;td&gt;Birthday&lt;/td&gt;n”,
”      &lt;td&gt;1&lt;/td&gt;n”,
”      &lt;td&gt;5&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 204</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“Alright, let’s look at one final example:n”,
“n”,
“n”,
“[Source Data](https://stackoverflow.com/questions/60387077/reshaping-and-melting-dataframe-whilst-picking-up-certain-regex)”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 205,
“source”: [</p>
<blockquote>
<div><p>“df = pd.DataFrame({‘Location’: [‘Madrid’, ‘Madrid’, ‘Rome’, ‘Rome’],n”,
” ‘Account’: [‘ABC’, ‘XYX’, ‘ABC’, ‘XYX’],n”,
” ‘Y2019:MTD:January:Expense’: [4354, 769867, 434654, 632556456],n”,
” ‘Y2019:MTD:January:Income’: [56456, 32556456, 5214, 46724423],n”,
” ‘Y2019:MTD:February:Expense’: [235423, 6785423, 235423, 46588]})n”,
“n”,
“df”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Location Account  Y2019:MTD:January:Expense  Y2019:MTD:January:Income  \n”,
“0   Madrid     ABC                       4354                     56456   n”,
“1   Madrid     XYX                     769867                  32556456   n”,
“2     Rome     ABC                     434654                      5214   n”,
“3     Rome     XYX                  632556456                  46724423   n”,
“n”,
”   Y2019:MTD:February:Expense  n”,
“0                      235423  n”,
“1                     6785423  n”,
“2                      235423  n”,
“3                       46588  “</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Location&lt;/th&gt;n”,
”      &lt;th&gt;Account&lt;/th&gt;n”,
”      &lt;th&gt;Y2019:MTD:January:Expense&lt;/th&gt;n”,
”      &lt;th&gt;Y2019:MTD:January:Income&lt;/th&gt;n”,
”      &lt;th&gt;Y2019:MTD:February:Expense&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Madrid&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;4354&lt;/td&gt;n”,
”      &lt;td&gt;56456&lt;/td&gt;n”,
”      &lt;td&gt;235423&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Madrid&lt;/td&gt;n”,
”      &lt;td&gt;XYX&lt;/td&gt;n”,
”      &lt;td&gt;769867&lt;/td&gt;n”,
”      &lt;td&gt;32556456&lt;/td&gt;n”,
”      &lt;td&gt;6785423&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Rome&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;434654&lt;/td&gt;n”,
”      &lt;td&gt;5214&lt;/td&gt;n”,
”      &lt;td&gt;235423&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Rome&lt;/td&gt;n”,
”      &lt;td&gt;XYX&lt;/td&gt;n”,
”      &lt;td&gt;632556456&lt;/td&gt;n”,
”      &lt;td&gt;46724423&lt;/td&gt;n”,
”      &lt;td&gt;46588&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 205</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “code”,
“execution_count”: 206,
“source”: [</p>
<blockquote>
<div><p>“df.pivot_longer(index = [‘Location’,’Account’],n”,
”                names_to=(&quot;year&quot;, &quot;month&quot;, &quot;.value&quot;),n”,
”                names_pattern=r&quot;Y(.+):MTD:(.{3}).+(Income|Expense)&quot;,n”,
”                sort_by_appearance=True)n”,
“n”</p>
</div></blockquote>
<p>],
“outputs”: [</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><p>“output_type”: “execute_result”,
“data”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“text/plain”: [</dt><dd><p>”  Location Account  year month    Expense      Incomen”,
“0   Madrid     ABC  2019   Jan       4354     56456.0n”,
“1   Madrid     ABC  2019   Feb     235423         NaNn”,
“2   Madrid     XYX  2019   Jan     769867  32556456.0n”,
“3   Madrid     XYX  2019   Feb    6785423         NaNn”,
“4     Rome     ABC  2019   Jan     434654      5214.0n”,
“5     Rome     ABC  2019   Feb     235423         NaNn”,
“6     Rome     XYX  2019   Jan  632556456  46724423.0n”,
“7     Rome     XYX  2019   Feb      46588         NaN”</p>
</dd>
</dl>
<p>],
“text/html”: [</p>
<blockquote>
<div><p>“&lt;div&gt;n”,
“&lt;style scoped&gt;n”,
”    .dataframe tbody tr th:only-of-type {n”,
”        vertical-align: middle;n”,
”    }n”,
“n”,
”    .dataframe tbody tr th {n”,
”        vertical-align: top;n”,
”    }n”,
“n”,
”    .dataframe thead th {n”,
”        text-align: right;n”,
”    }n”,
“&lt;/style&gt;n”,
“&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;n”,
”  &lt;thead&gt;n”,
”    &lt;tr style=&quot;text-align: right;&quot;&gt;n”,
”      &lt;th&gt;&lt;/th&gt;n”,
”      &lt;th&gt;Location&lt;/th&gt;n”,
”      &lt;th&gt;Account&lt;/th&gt;n”,
”      &lt;th&gt;year&lt;/th&gt;n”,
”      &lt;th&gt;month&lt;/th&gt;n”,
”      &lt;th&gt;Expense&lt;/th&gt;n”,
”      &lt;th&gt;Income&lt;/th&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/thead&gt;n”,
”  &lt;tbody&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;0&lt;/th&gt;n”,
”      &lt;td&gt;Madrid&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Jan&lt;/td&gt;n”,
”      &lt;td&gt;4354&lt;/td&gt;n”,
”      &lt;td&gt;56456.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;1&lt;/th&gt;n”,
”      &lt;td&gt;Madrid&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Feb&lt;/td&gt;n”,
”      &lt;td&gt;235423&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;2&lt;/th&gt;n”,
”      &lt;td&gt;Madrid&lt;/td&gt;n”,
”      &lt;td&gt;XYX&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Jan&lt;/td&gt;n”,
”      &lt;td&gt;769867&lt;/td&gt;n”,
”      &lt;td&gt;32556456.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;3&lt;/th&gt;n”,
”      &lt;td&gt;Madrid&lt;/td&gt;n”,
”      &lt;td&gt;XYX&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Feb&lt;/td&gt;n”,
”      &lt;td&gt;6785423&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;4&lt;/th&gt;n”,
”      &lt;td&gt;Rome&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Jan&lt;/td&gt;n”,
”      &lt;td&gt;434654&lt;/td&gt;n”,
”      &lt;td&gt;5214.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;5&lt;/th&gt;n”,
”      &lt;td&gt;Rome&lt;/td&gt;n”,
”      &lt;td&gt;ABC&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Feb&lt;/td&gt;n”,
”      &lt;td&gt;235423&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;6&lt;/th&gt;n”,
”      &lt;td&gt;Rome&lt;/td&gt;n”,
”      &lt;td&gt;XYX&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Jan&lt;/td&gt;n”,
”      &lt;td&gt;632556456&lt;/td&gt;n”,
”      &lt;td&gt;46724423.0&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”    &lt;tr&gt;n”,
”      &lt;th&gt;7&lt;/th&gt;n”,
”      &lt;td&gt;Rome&lt;/td&gt;n”,
”      &lt;td&gt;XYX&lt;/td&gt;n”,
”      &lt;td&gt;2019&lt;/td&gt;n”,
”      &lt;td&gt;Feb&lt;/td&gt;n”,
”      &lt;td&gt;46588&lt;/td&gt;n”,
”      &lt;td&gt;NaN&lt;/td&gt;n”,
”    &lt;/tr&gt;n”,
”  &lt;/tbody&gt;n”,
“&lt;/table&gt;n”,
“&lt;/div&gt;”</p>
</div></blockquote>
<p>]</p>
</div></blockquote>
<p>},
“metadata”: {},
“execution_count”: 206</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>},
{</p>
<blockquote>
<div><p>“cell_type”: “markdown”,
“source”: [</p>
<blockquote>
<div><p>“[pivot_longer](<a class="reference external" href="https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html">https://pyjanitor-devs.github.io/pyjanitor/reference/janitor.functions/janitor.pivot_longer.html</a>) does not solve all problems; no function does. Its aim is to make it easy to unpivot dataframes from wide to long form, while offering a lot of flexibility and power.”</p>
</div></blockquote>
<p>],
“metadata”: {}</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>],
“metadata”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“kernelspec”: {</dt><dd><p>“name”: “python3”,
“display_name”: “Python 3.8.10 64-bit (‘base’: conda)”</p>
</dd>
</dl>
<p>},
“language_info”: {</p>
<blockquote>
<div><dl class="simple">
<dt>“codemirror_mode”: {</dt><dd><p>“name”: “ipython”,
“version”: 3</p>
</dd>
</dl>
<p>},
“file_extension”: “.py”,
“mimetype”: “text/x-python”,
“name”: “python”,
“nbconvert_exporter”: “python”,
“pygments_lexer”: “ipython3”,
“version”: “3.8.10”</p>
</div></blockquote>
<p>},
“interpreter”: {</p>
<blockquote>
<div><p>“hash”: “98b0a9b7b4eaaa670588a142fd0a9b87eaafe866f1db4228be72b4211d12040f”</p>
</div></blockquote>
<p>}</p>
</div></blockquote>
<p>},
“nbformat”: 4,
“nbformat_minor”: 2</p>
</dd>
</dl>
<p>}</p>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo_title.svg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../notebooks.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../notebooks.html">Examples</a><ul>
      <li>Previous: <a href="pyjanitor_intro.html" title="previous chapter">&lt;no title&gt;</a></li>
      <li>Next: <a href="README.html" title="next chapter">Examples</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, PyJanitor devs.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/notebooks/Pivoting Data from Wide to Long.ipynb.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>