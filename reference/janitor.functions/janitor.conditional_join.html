
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>janitor.conditional_join &#8212; pyjanitor  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="General PySpark Functions" href="../pyspark.html" />
    <link rel="prev" title="janitor.pivot_wider" href="janitor.pivot_wider.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="janitor-conditional-join">
<h1>janitor.conditional_join<a class="headerlink" href="#janitor-conditional-join" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="janitor.conditional_join">
<span class="sig-prename descclassname"><span class="pre">janitor.</span></span><span class="sig-name descname"><span class="pre">conditional_join</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.3.3)"><span class="pre">pandas.core.frame.DataFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">right</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.3.3)"><span class="pre">pandas.core.frame.DataFrame</span></a><span class="p"><span class="pre">,</span> </span><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html#pandas.Series" title="(in pandas v1.3.3)"><span class="pre">pandas.core.series.Series</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">conditions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><span class="pre">str</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'inner'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sort_by_appearance</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><span class="pre">bool</span></a></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffixes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">('_x',</span> <span class="pre">'_y')</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v1.3.3)"><span class="pre">pandas.core.frame.DataFrame</span></a></span></span><a class="reference internal" href="../../_modules/janitor/functions.html#conditional_join"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#janitor.conditional_join" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a convenience function that operates similarly to <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code>,
but allows joins on inequality operators, or a combination of equi
and non-equi joins.</p>
<p>If the join is solely on equality, <cite>pd.merge</cite> function
is more efficient and should be used instead. Infact,
for multiple conditions where equality is involved,
a <cite>pd.merge</cite>, followed by filter(via <cite>query</cite> or <cite>loc</cite>)
is more efficient. This is even more evident when joining
on strings.
If you are interested in nearest joins, or rolling joins,
<cite>pd.merge_asof</cite> covers that. There is also the IntervalIndex,
which can be more efficient for range joins, especially if
the intervals do not overlap.</p>
<p>This function returns rows, if any, where values from <cite>df</cite> meet the
condition(s) for values from <cite>right</cite>. The conditions are passed in
as a variable argument of tuples, where the tuple is of
the form <code class="docutils literal notranslate"><span class="pre">(left_on,</span> <span class="pre">right_on,</span> <span class="pre">op)</span></code>; <cite>left_on</cite> is the column
label from <cite>df</cite>, <cite>right_on</cite> is the column label from <cite>right</cite>,
while <cite>op</cite> is the operator.</p>
<p>The operator can be any of <cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite>.</p>
<p>A binary search is used to get the relevant rows; this avoids
a cartesian join, and makes the process less memory intensive.</p>
<p>The join is done only on the columns.
MultiIndex columns are not supported.</p>
<p>Only numeric, date and string columns are supported.</p>
<p>If joining on strings, only the <cite>==</cite> operator is supported.</p>
<p>Only <cite>inner</cite>, <cite>left</cite>, and <cite>right</cite> joins are supported.</p>
<p>Example :</p>
<p>df1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="nb">id</span>  <span class="n">value_1</span>
<span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>
<span class="mi">1</span>   <span class="mi">1</span>        <span class="mi">5</span>
<span class="mi">2</span>   <span class="mi">1</span>        <span class="mi">7</span>
<span class="mi">3</span>   <span class="mi">2</span>        <span class="mi">1</span>
<span class="mi">4</span>   <span class="mi">2</span>        <span class="mi">3</span>
<span class="mi">5</span>   <span class="mi">3</span>        <span class="mi">4</span>
</pre></div>
</div>
<p>df2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="nb">id</span>  <span class="n">value_2A</span>  <span class="n">value_2B</span>
<span class="mi">0</span>   <span class="mi">1</span>         <span class="mi">0</span>         <span class="mi">1</span>
<span class="mi">1</span>   <span class="mi">1</span>         <span class="mi">3</span>         <span class="mi">5</span>
<span class="mi">2</span>   <span class="mi">1</span>         <span class="mi">7</span>         <span class="mi">9</span>
<span class="mi">3</span>   <span class="mi">1</span>        <span class="mi">12</span>        <span class="mi">15</span>
<span class="mi">4</span>   <span class="mi">2</span>         <span class="mi">0</span>         <span class="mi">1</span>
<span class="mi">5</span>   <span class="mi">2</span>         <span class="mi">2</span>         <span class="mi">4</span>
<span class="mi">6</span>   <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
<span class="mi">7</span>   <span class="mi">3</span>         <span class="mi">1</span>         <span class="mi">3</span>
</pre></div>
</div>
<p>Join on equi and non-equi operators is possible:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2A&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">),</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">id_x</span>  <span class="n">value_1</span>  <span class="n">id_y</span>  <span class="n">value_2A</span>  <span class="n">value_2B</span>
<span class="mi">0</span>     <span class="mi">1</span>        <span class="mi">5</span>     <span class="mi">1</span>         <span class="mi">3</span>         <span class="mi">5</span>
<span class="mi">1</span>     <span class="mi">1</span>        <span class="mi">7</span>     <span class="mi">1</span>         <span class="mi">7</span>         <span class="mi">9</span>
<span class="mi">2</span>     <span class="mi">2</span>        <span class="mi">1</span>     <span class="mi">2</span>         <span class="mi">0</span>         <span class="mi">1</span>
<span class="mi">3</span>     <span class="mi">2</span>        <span class="mi">3</span>     <span class="mi">2</span>         <span class="mi">2</span>         <span class="mi">4</span>
<span class="mi">4</span>     <span class="mi">2</span>        <span class="mi">3</span>     <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
</pre></div>
</div>
<p>The default join is <cite>inner</cite>. left and right joins are supported as well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2A&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">),</span>
        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">id_x</span>  <span class="n">value_1</span>  <span class="n">id_y</span>  <span class="n">value_2A</span>  <span class="n">value_2B</span>
<span class="mi">0</span>     <span class="mi">1</span>        <span class="mi">2</span>   <span class="n">NaN</span>       <span class="n">NaN</span>       <span class="n">NaN</span>
<span class="mi">1</span>     <span class="mi">1</span>        <span class="mi">5</span>   <span class="mf">1.0</span>       <span class="mf">3.0</span>       <span class="mf">5.0</span>
<span class="mi">2</span>     <span class="mi">1</span>        <span class="mi">7</span>   <span class="mf">1.0</span>       <span class="mf">7.0</span>       <span class="mf">9.0</span>
<span class="mi">3</span>     <span class="mi">2</span>        <span class="mi">1</span>   <span class="mf">2.0</span>       <span class="mf">0.0</span>       <span class="mf">1.0</span>
<span class="mi">4</span>     <span class="mi">2</span>        <span class="mi">3</span>   <span class="mf">2.0</span>       <span class="mf">2.0</span>       <span class="mf">4.0</span>
<span class="mi">5</span>     <span class="mi">2</span>        <span class="mi">3</span>   <span class="mf">2.0</span>       <span class="mf">3.0</span>       <span class="mf">6.0</span>
<span class="mi">6</span>     <span class="mi">3</span>        <span class="mi">4</span>   <span class="n">NaN</span>       <span class="n">NaN</span>       <span class="n">NaN</span>


<span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;id&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2A&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;=&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;=&#39;</span><span class="p">),</span>
        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">id_x</span>  <span class="n">value_1</span>  <span class="n">id_y</span>  <span class="n">value_2A</span>  <span class="n">value_2B</span>
<span class="mi">0</span>   <span class="n">NaN</span>      <span class="n">NaN</span>     <span class="mi">1</span>         <span class="mi">0</span>         <span class="mi">1</span>
<span class="mi">1</span>   <span class="mf">1.0</span>      <span class="mf">5.0</span>     <span class="mi">1</span>         <span class="mi">3</span>         <span class="mi">5</span>
<span class="mi">2</span>   <span class="mf">1.0</span>      <span class="mf">7.0</span>     <span class="mi">1</span>         <span class="mi">7</span>         <span class="mi">9</span>
<span class="mi">3</span>   <span class="n">NaN</span>      <span class="n">NaN</span>     <span class="mi">1</span>        <span class="mi">12</span>        <span class="mi">15</span>
<span class="mi">4</span>   <span class="mf">2.0</span>      <span class="mf">1.0</span>     <span class="mi">2</span>         <span class="mi">0</span>         <span class="mi">1</span>
<span class="mi">5</span>   <span class="mf">2.0</span>      <span class="mf">3.0</span>     <span class="mi">2</span>         <span class="mi">2</span>         <span class="mi">4</span>
<span class="mi">6</span>   <span class="mf">2.0</span>      <span class="mf">3.0</span>     <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
<span class="mi">7</span>   <span class="n">NaN</span>      <span class="n">NaN</span>     <span class="mi">3</span>         <span class="mi">1</span>         <span class="mi">3</span>
</pre></div>
</div>
<p>Join on just the non-equi joins is also possible:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2A&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>
        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

    <span class="n">id_x</span>  <span class="n">value_1</span>  <span class="n">id_y</span>  <span class="n">value_2A</span>  <span class="n">value_2B</span>
<span class="mi">0</span>     <span class="mi">1</span>        <span class="mi">2</span>     <span class="mi">3</span>         <span class="mi">1</span>         <span class="mi">3</span>
<span class="mi">1</span>     <span class="mi">1</span>        <span class="mi">5</span>     <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
<span class="mi">2</span>     <span class="mi">2</span>        <span class="mi">3</span>     <span class="mi">2</span>         <span class="mi">2</span>         <span class="mi">4</span>
<span class="mi">3</span>     <span class="mi">3</span>        <span class="mi">4</span>     <span class="mi">1</span>         <span class="mi">3</span>         <span class="mi">5</span>
<span class="mi">4</span>     <span class="mi">3</span>        <span class="mi">4</span>     <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
</pre></div>
</div>
<p>The default for the <cite>suffixes</cite> parameter is <code class="docutils literal notranslate"><span class="pre">(_x,</span> <span class="pre">_y)</span></code>,
One of the suffixes can be set as <code class="docutils literal notranslate"><span class="pre">None</span></code>;
this avoids a suffix on the columns from the
relevant dataframe:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2A&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;value_1&#39;</span><span class="p">,</span> <span class="s1">&#39;value_2B&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;&#39;</span><span class="p">),</span>
        <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">suffixes</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="s1">&#39;_y&#39;</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="nb">id</span>  <span class="n">value_1</span>  <span class="n">id_y</span>  <span class="n">value_2A</span>  <span class="n">value_2B</span>
<span class="mi">0</span>   <span class="mi">1</span>        <span class="mi">2</span>     <span class="mi">3</span>         <span class="mi">1</span>         <span class="mi">3</span>
<span class="mi">1</span>   <span class="mi">1</span>        <span class="mi">5</span>     <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
<span class="mi">2</span>   <span class="mi">2</span>        <span class="mi">3</span>     <span class="mi">2</span>         <span class="mi">2</span>         <span class="mi">4</span>
<span class="mi">3</span>   <span class="mi">3</span>        <span class="mi">4</span>     <span class="mi">1</span>         <span class="mi">3</span>         <span class="mi">5</span>
<span class="mi">4</span>   <span class="mi">3</span>        <span class="mi">4</span>     <span class="mi">2</span>         <span class="mi">3</span>         <span class="mi">6</span>
</pre></div>
</div>
<p>Join on just equality is also possible, but should be avoided -
Pandas merge/join is more efficient:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;==&#39;</span><span class="p">),</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

     <span class="n">col_a_x</span> <span class="n">col_b</span>  <span class="n">col_a_y</span> <span class="n">col_c</span>
<span class="mi">0</span>        <span class="mi">2</span>     <span class="n">B</span>        <span class="mi">2</span>     <span class="n">X</span>
<span class="mi">1</span>        <span class="mi">3</span>     <span class="n">C</span>        <span class="mi">3</span>     <span class="n">Y</span>
</pre></div>
</div>
<p>Join on not equal -&gt; <code class="docutils literal notranslate"><span class="pre">!=</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;!=&#39;</span><span class="p">),</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span>

     <span class="n">col_a_x</span> <span class="n">col_b</span>  <span class="n">col_a_y</span> <span class="n">col_c</span>
<span class="mi">0</span>        <span class="mi">1</span>     <span class="n">A</span>        <span class="mi">0</span>     <span class="n">Z</span>
<span class="mi">1</span>        <span class="mi">1</span>     <span class="n">A</span>        <span class="mi">2</span>     <span class="n">X</span>
<span class="mi">2</span>        <span class="mi">1</span>     <span class="n">A</span>        <span class="mi">3</span>     <span class="n">Y</span>
<span class="mi">3</span>        <span class="mi">2</span>     <span class="n">B</span>        <span class="mi">0</span>     <span class="n">Z</span>
<span class="mi">4</span>        <span class="mi">2</span>     <span class="n">B</span>        <span class="mi">3</span>     <span class="n">Y</span>
<span class="mi">5</span>        <span class="mi">3</span>     <span class="n">C</span>        <span class="mi">0</span>     <span class="n">Z</span>
<span class="mi">6</span>        <span class="mi">3</span>     <span class="n">C</span>        <span class="mi">2</span>     <span class="n">X</span>
</pre></div>
</div>
<p>If the order from <cite>right</cite> is not important,
<cite>sort_by_appearance</cite> can be set to  <code class="docutils literal notranslate"><span class="pre">False</span></code>
(this is the default):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df2</span><span class="p">,</span>
        <span class="p">(</span><span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;col_a&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">),</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span>

     <span class="n">col_a_x</span> <span class="n">col_b</span>  <span class="n">col_a_y</span> <span class="n">col_c</span>
<span class="mi">0</span>        <span class="mi">1</span>     <span class="n">A</span>        <span class="mi">0</span>     <span class="n">Z</span>
<span class="mi">1</span>        <span class="mi">2</span>     <span class="n">B</span>        <span class="mi">0</span>     <span class="n">Z</span>
<span class="mi">2</span>        <span class="mi">3</span>     <span class="n">C</span>        <span class="mi">0</span>     <span class="n">Z</span>
<span class="mi">3</span>        <span class="mi">3</span>     <span class="n">C</span>        <span class="mi">2</span>     <span class="n">X</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <cite>df</cite> or <cite>right</cite> has labeled indices,
it will be lost after the merge,
and replaced with an integer index.
If you wish to preserve the labeled indices,
you can convert them to columns
before running the conditional join.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the columns from <cite>df</cite> and <cite>right</cite>
are returned in the final output.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For multiple condtions, If there are nulls
in the join columns, they will not be
preserved for <cite>!=</cite> operator. Nulls are only
preserved for <cite>!=</cite> operator for single condition.</p>
</div>
<p>Functional usage syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">janitor</span> <span class="k">as</span> <span class="nn">jn</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">right</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">jn</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">df</span><span class="p">,</span>
        <span class="n">right</span><span class="p">,</span>
        <span class="o">*</span><span class="n">conditions</span><span class="p">,</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">suffixes</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<p>Method chaining syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">conditional_join</span><span class="p">(</span>
        <span class="n">right</span><span class="p">,</span>
        <span class="o">*</span><span class="n">conditions</span><span class="p">,</span>
        <span class="n">sort_by_appearance</span> <span class="o">=</span> <span class="kc">True</span><span class="o">/</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">suffixes</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;_x&quot;</span><span class="p">,</span> <span class="s2">&quot;_y&quot;</span><span class="p">),</span>
        <span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – A Pandas dataframe.</p></li>
<li><p><strong>right</strong> – Named Series or DataFrame to join to.</p></li>
<li><p><strong>conditions</strong> – Variable argument of tuple(s) of the form
<code class="docutils literal notranslate"><span class="pre">(left_on,</span> <span class="pre">right_on,</span> <span class="pre">op)</span></code>, where <cite>left_on</cite> is the column
label from <cite>df</cite>, <cite>right_on</cite> is the column label from <cite>right</cite>,
while <cite>op</cite> is the operator. The operator can be any of
<cite>==</cite>, <cite>!=</cite>, <cite>&lt;=</cite>, <cite>&lt;</cite>, <cite>&gt;=</cite>, <cite>&gt;</cite>.</p></li>
<li><p><strong>how</strong> – Indicates the type of join to be performed.
It can be one of <cite>inner</cite>, <cite>left</cite>, <cite>right</cite>.
Full join is not supported. Defaults to <cite>inner</cite>.</p></li>
<li><p><strong>sort_by_appearance</strong> – Default is <cite>False</cite>. If True,
values from <cite>right</cite> that meet the join condition will be returned
in the final dataframe in the same order that they were before the
join.</p></li>
<li><p><strong>suffixes</strong> – tuple, default is <code class="docutils literal notranslate"><span class="pre">(_x,</span> <span class="pre">_y)</span></code>.
A sequence of length 2, where each element is optionally a string,
indicating the suffix to add to the overlapping column names
in <cite>df</cite> and <cite>right</cite>. Pass a value of <code class="docutils literal notranslate"><span class="pre">None</span></code>
instead of a string to indicate that the  column name
from <cite>df</cite> or <cite>right</cite> should be left as-is, with no suffix.
At least one of the values must not be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pandas DataFrame of the two merged Pandas objects.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – if columns from <cite>df</cite> or <cite>right</cite> is a MultiIndex.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – if condition in <a href="#id1"><span class="problematic" id="id2">*</span></a>conditions is not a tuple.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/logo_title.svg" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks.html">Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../biology.html">Biology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../chemistry.html">Chemistry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../engineering.html">Engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../finance.html">Finance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ml.html">Machine Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timeseries.html">Time Series</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../general_functions.html">General Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#modify-columns">Modify columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#modify-values">Modify values</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#filtering">Filtering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general_functions.html#preprocessing">Preprocessing</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../general_functions.html#other">Other</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="janitor.then.html">janitor.then</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.also.html">janitor.also</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.shuffle.html">janitor.shuffle</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.count_cumulative_unique.html">janitor.count_cumulative_unique</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.sort_naturally.html">janitor.sort_naturally</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.expand_grid.html">janitor.expand_grid</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.flag_nulls.html">janitor.flag_nulls</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.move.html">janitor.move</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.toset.html">janitor.toset</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.unionize_dataframe_categories.html">janitor.unionize_dataframe_categories</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.groupby_topk.html">janitor.groupby_topk</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.complete.html">janitor.complete</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.pivot_longer.html">janitor.pivot_longer</a></li>
<li class="toctree-l4"><a class="reference internal" href="janitor.pivot_wider.html">janitor.pivot_wider</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">janitor.conditional_join</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../pyspark.html">General PySpark Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../xarray.html">General XArray Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../authors.html">Contributors</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">API Documentation</a><ul>
  <li><a href="../general_functions.html">General Functions</a><ul>
      <li>Previous: <a href="janitor.pivot_wider.html" title="previous chapter">janitor.pivot_wider</a></li>
      <li>Next: <a href="../pyspark.html" title="next chapter">General PySpark Functions</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, PyJanitor devs.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../../_sources/reference/janitor.functions/janitor.conditional_join.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>